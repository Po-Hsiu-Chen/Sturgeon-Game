System.register("chunks:///_virtual/Api.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t,r;return{setters:[function(e){n=e.asyncToGenerator,t=e.regeneratorRuntime},function(e){r=e.cclegacy}],execute:function(){function i(){return(i=n(t().mark((function e(n){var r;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/auth/line",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idToken:n})});case 2:if((r=e.sent).ok){e.next=5;break}throw new Error("auth/line failed");case 5:return e.abrupt("return",r.json());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e("authWithLine",(function(e){return i.apply(this,arguments)})),r._RF.push({},"60365l6LiVPNJDhC4p/FcIV","Api",void 0),r._RF.pop()}}}));

System.register("chunks:///_virtual/ButtomPanelToggle.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,o,i,s,l,a,c,r,h,u,p;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,a=t.Node,c=t.Button,r=t.input,h=t.Input,u=t.UITransform,p=t.Component}],execute:function(){var f,g,T,d,P,B,v;s._RF.push({},"4460aScEjdLF4HmtSnoEJ+w","ButtomPanelToggle",void 0);var y=l.ccclass,C=l.property;t("ButtomPanelToggle",(f=y("ButtomPanelToggle"),g=C(a),T=C(a),f((B=n((P=function(t){function n(){for(var n,e=arguments.length,s=new Array(e),l=0;l<e;l++)s[l]=arguments[l];return n=t.call.apply(t,[this].concat(s))||this,o(n,"panel",B,i(n)),o(n,"closeBtn",v,i(n)),n._isOpen=!1,n}e(n,t);var s=n.prototype;return s.onLoad=function(){this.node.on(c.EventType.CLICK,this.togglePanel,this),this.closeBtn&&this.closeBtn.on(c.EventType.CLICK,this.closePanel,this),r.on(h.EventType.TOUCH_START,this.onBackgroundTouch,this),this.panel&&(this.panel.active=!1)},s.onDestroy=function(){this.node.off(c.EventType.CLICK,this.togglePanel,this),this.closeBtn&&this.closeBtn.off(c.EventType.CLICK,this.closePanel,this),r.off(h.EventType.TOUCH_START,this.onBackgroundTouch,this)},s.togglePanel=function(){this._isOpen?this.closePanel():this.openPanel()},s.openPanel=function(){this.panel&&(this.panel.active=!0,this._isOpen=!0)},s.closePanel=function(){this.panel&&(this.panel.active=!1,this._isOpen=!1)},s.onBackgroundTouch=function(t){if(this._isOpen){var n=t.getUILocation();this.isPointInNode(this.panel,n)||this.isPointInNode(this.node,n)||this.closeBtn&&this.isPointInNode(this.closeBtn,n)||this.closePanel()}},s.isPointInNode=function(t,n){var e=t.getComponent(u);return!!e&&e.getBoundingBoxToWorld().contains(n)},n}(p)).prototype,"panel",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=n(P.prototype,"closeBtn",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=P))||d));s._RF.pop()}}}));

System.register("chunks:///_virtual/CategoryTab.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,n,r,o,a,c,l;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,c=t.Label,l=t.Component}],execute:function(){var s,u,p,y,b;o._RF.push({},"b4c90DrNntKa5RLkK5ZESyg","CategoryTab",void 0);var f=a.ccclass,h=a.property;t("CategoryTab",(s=f("CategoryTab"),u=h(c),s((b=e((y=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,n(e,"title",b,r(e)),e._tabName="全部",e._onPick=function(){},e}i(e,t);var o=e.prototype;return o.init=function(t,e){this._tabName=t,this._onPick=e,this.title&&(this.title.string=t)},o.onClick=function(){this._onPick(this._tabName)},e}(l)).prototype,"title",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),p=y))||p));o._RF.pop()}}}));

System.register("chunks:///_virtual/CircleBg.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,r,n,o,l,c,a,s,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,r=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){o=e.cclegacy,l=e._decorator,c=e.Color,a=e.Graphics,s=e.UITransform,p=e.Component}],execute:function(){var u,h,f,g,C;o._RF.push({},"4af90s9VNpFNY9qUGtVGWne","CircleBg",void 0);var d=l.ccclass,y=l.property;e("CircleBg",(u=d("CircleBg"),h=y(c),u((C=t((g=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return t=e.call.apply(e,[this].concat(o))||this,r(t,"fill",C,n(t)),t}return i(t,e),t.prototype.onEnable=function(){var e,t=null!=(e=this.getComponent(a))?e:this.addComponent(a),i=this.getComponent(s),r=Math.min(i.width,i.height)/2;t.clear(),t.fillColor=this.fill,t.circle(i.width/2,i.height/2,r),t.fill()},t}(p)).prototype,"fill",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c(255,255,255,255)}}),f=g))||f));o._RF.pop()}}}));

System.register("chunks:///_virtual/DataManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./QuizData.ts"],(function(e){var r,t,n,a,s,u;return{setters:[function(e){r=e.createForOfIteratorHelperLoose,t=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){a=e.cclegacy,s=e._decorator},function(e){u=e.quizQuestions}],execute:function(){a._RF.push({},"5f04d33bXZHvp95rX07ICDM","DataManager",void 0);s.ccclass,s.property;var i=e("DataManager",function(){function e(){}return e.onChange=function(e){var r=this;return this._listeners.add(e),function(){return r._listeners.delete(e)}},e._emit=function(e){for(var t,n=r(this._listeners);!(t=n()).done;){(0,t.value)(e)}},e.ensureInitialized=function(){var e=t(n().mark((function e(r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setCurrentUser(r),e.next=3,this.getPlayerData(r);case 3:e.sent||console.error("[DataManager] 後端沒有這個玩家，請重新登入 LINE");case 5:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.setCurrentUser=function(e){this.currentUserId=e},e.init=function(){var e=t(n().mark((function e(r){var t,a=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ready||(this.ready=new Promise((function(e){return a.readyResolve=e}))),this.initializing=!0,this.setCurrentUser(r),e.next=5,this.ensureInitialized(r);case 5:this.initializing=!1,null==(t=this.readyResolve)||t.call(this);case 7:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.getPlayerData=function(){var e=t(n().mark((function e(r){var t,a,s,u,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.ready||this.initializing){e.next=8;break}return e.prev=1,e.next=4,this.ready;case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:if(s="undefined"!=typeof window?localStorage.getItem("currentUserId"):null,u=(null!=(t=null!=(a=null!=r?r:this.currentUserId)?a:s)?t:"").trim()){e.next=13;break}return console.warn("[getPlayerData] 沒有 userId（參數 / currentUserId / localStorage 都拿不到），回 null"),e.abrupt("return",null);case 13:return e.prev=13,e.next=16,fetch(this.apiBase+"/player/"+encodeURIComponent(u));case 16:if((i=e.sent).ok){e.next=28;break}if(404!==i.status){e.next=20;break}return e.abrupt("return",null);case 20:return e.t1=console,e.t2="取得玩家資料失敗: "+i.status+" ",e.next=24,i.text();case 24:return e.t3=e.sent,e.t4=e.t2+e.t3,e.t1.error.call(e.t1,e.t4),e.abrupt("return",null);case 28:return e.next=30,i.json();case 30:return e.abrupt("return",e.sent);case 33:return e.prev=33,e.t5=e.catch(13),console.error("[getPlayerData] fetch 失敗：",e.t5),e.abrupt("return",null);case 37:case"end":return e.stop()}}),e,this,[[1,6],[13,33]])})));return function(r){return e.apply(this,arguments)}}(),e.savePlayerData=function(){var e=t(n().mark((function e(r){var t,a,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.useLocalStorage){e.next=3;break}return localStorage.setItem("playerData",JSON.stringify(r)),e.abrupt("return",r);case 3:return e.next=5,fetch(this.apiBase+"/player/"+encodeURIComponent(r.userId),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 5:if((t=e.sent).ok){e.next=11;break}return e.next=9,t.text().catch((function(){return""}));case 9:throw a=e.sent,new Error("savePlayerData failed: "+t.status+" "+a);case 11:return e.next=13,t.json();case 13:return s=e.sent,this.setCurrentUser(s.userId),e.abrupt("return",s);case 16:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.getQuizQuestions=function(){var e=t(n().mark((function e(){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.useLocalStorage){e.next=4;break}return e.abrupt("return",u);case 4:return e.next=6,fetch(this.apiBase+"/quiz");case 6:return r=e.sent,e.next=9,r.json();case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.clearPlayerData=function(){this.useLocalStorage&&(localStorage.removeItem("playerData"),console.log("玩家資料已清除"))},e.getPlayerDataCached=function(){var e=t(n().mark((function e(r){var a,s,u,i,o,c=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=null!=(a=null==r?void 0:r.maxAgeMs)?a:3e3,i=Date.now(),o=null!=(s=null==r?void 0:r.userId)?s:this.currentUserId,!(this._snapshot&&i-this._snapshotTime<u)||null!=r&&r.refresh){e.next=5;break}return e.abrupt("return",this._snapshot);case 5:if(!this._inFlight){e.next=7;break}return e.abrupt("return",this._inFlight);case 7:return this._inFlight=t(n().mark((function e(){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.getPlayerData(o);case 2:return r=e.sent,c._inFlight=null,r&&(c._snapshot=r,c._snapshotTime=Date.now(),c._emit(r)),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))(),e.abrupt("return",this._inFlight);case 9:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.refreshPlayerData=function(){var e=t(n().mark((function e(r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPlayerDataCached({refresh:!0,userId:r}));case 1:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.savePlayerDataWithCache=function(){var e=t(n().mark((function e(r){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.savePlayerData(r);case 2:return t=e.sent,this._snapshot=t,this._snapshotTime=Date.now(),this._emit(t),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.getFriends=function(){var e=t(n().mark((function e(){var r,t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.currentUserId){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,fetch(this.apiBase+"/friends/"+encodeURIComponent(r));case 5:if((t=e.sent).ok){e.next=8;break}return e.abrupt("return",[]);case 8:return e.next=10,t.json();case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.sendFriendRequest=function(){var e=t(n().mark((function e(r){var t,a,s,u;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.currentUserId){e.next=3;break}throw new Error("no current user");case 3:return e.next=5,fetch(this.apiBase+"/friend-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fromUserId:t,toUserId:r})});case 5:if((a=e.sent).ok){e.next=13;break}return e.next=9,a.json().catch((function(){return{}}));case 9:throw s=e.sent,(u=new Error((null==s?void 0:s.error)||"sendFriendRequest failed")).code=null==s?void 0:s.error,u;case 13:return e.next=15,a.json();case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.getFriendRequests=function(){var e=t(n().mark((function e(){var r,t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.currentUserId){e.next=3;break}throw new Error("no current user");case 3:return e.next=5,fetch(this.apiBase+"/friend-requests?userId="+encodeURIComponent(r));case 5:if((t=e.sent).ok){e.next=8;break}throw new Error("getFriendRequests failed: "+t.status);case 8:return e.next=10,t.json();case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.getInbox=function(){var e=t(n().mark((function e(){var r,t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.currentUserId){e.next=3;break}throw new Error("no current user");case 3:return e.next=5,fetch(this.apiBase+"/mail/inbox?userId="+encodeURIComponent(r));case 5:if((t=e.sent).ok){e.next=8;break}throw new Error("getInbox failed: "+t.status);case 8:return e.next=10,t.json();case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.markMailRead=function(){var e=t(n().mark((function e(r){var t,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.currentUserId){e.next=3;break}throw new Error("no current user");case 3:return e.next=5,fetch(this.apiBase+"/mail/mark-read",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t,mailId:r})});case 5:if((a=e.sent).ok){e.next=8;break}throw new Error("markMailRead failed");case 8:return e.next=10,a.json();case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.respondFriendRequest=function(){var e=t(n().mark((function e(r,t){var a,s,u,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.currentUserId){e.next=3;break}throw new Error("no current user");case 3:return e.next=5,fetch(this.apiBase+"/friend-requests/respond",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a,requestId:r,action:t})});case 5:if((s=e.sent).ok){e.next=13;break}return e.next=9,s.json().catch((function(){return{}}));case 9:throw u=e.sent,(i=new Error((null==u?void 0:u.error)||"respondFriendRequest failed")).code=null==u?void 0:u.error,i;case 13:return e.next=15,s.json();case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e,this)})));return function(r,t){return e.apply(this,arguments)}}(),e.lookupUserById=function(){var e=t(n().mark((function e(r){var t,a,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(r||"").trim()){e.next=3;break}return e.abrupt("return",null);case 3:return e.prev=3,e.next=6,fetch(this.apiBase+"/public/player/"+encodeURIComponent(t));case 6:if(404!==(a=e.sent).status){e.next=9;break}return e.abrupt("return",null);case 9:if(a.ok){e.next=11;break}throw new Error("lookupUserById failed: "+a.status);case 11:return e.next=13,a.json();case 13:return s=e.sent,e.abrupt("return",{userId:s.userId,displayName:s.displayName,picture:s.picture});case 17:throw e.prev=17,e.t0=e.catch(3),console.warn("[lookupUserById] failed:",e.t0),e.t0;case 21:case"end":return e.stop()}}),e,this,[[3,17]])})));return function(r){return e.apply(this,arguments)}}(),e.getPublicPlayerData=function(){var e=t(n().mark((function e(r){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.apiBase+"/public/player/"+encodeURIComponent(r));case 2:if((t=e.sent).ok){e.next=9;break}return e.t0=Error,e.next=7,t.text();case 7:throw e.t1=e.sent,new e.t0(e.t1);case 9:return e.next=11,t.json();case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.getRecommendedUsers=function(){var e=t(n().mark((function e(r){var t,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r=5),e.prev=1,t=this.currentUserId,e.next=5,fetch(this.apiBase+"/recommend-users?count="+r+"&excludeUserId="+encodeURIComponent(t||""));case 5:if((a=e.sent).ok){e.next=9;break}return console.warn("[DataManager] getRecommendedUsers failed:",a.status),e.abrupt("return",[]);case 9:return e.next=11,a.json();case 11:return e.abrupt("return",e.sent);case 14:return e.prev=14,e.t0=e.catch(1),console.warn("[DataManager] getRecommendedUsers error:",e.t0),e.abrupt("return",[]);case 18:case"end":return e.stop()}}),e,this,[[1,14]])})));return function(r){return e.apply(this,arguments)}}(),e.purchaseViaApi=function(){var e=t(n().mark((function e(r,t){var a,s,u,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=1),a=this.currentUserId){e.next=4;break}throw new Error("no current user");case 4:return e.next=6,fetch(this.apiBase+"/purchase",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a,sku:r,qty:t})});case 6:if((s=e.sent).ok){e.next=12;break}return e.next=10,s.text().catch((function(){return""}));case 10:throw u=e.sent,new Error("purchase failed: "+s.status+" "+u);case 12:return e.next=14,s.json();case 14:return i=e.sent,this._snapshot=i,this._snapshotTime=Date.now(),this._emit(i),e.abrupt("return",i);case 19:case"end":return e.stop()}}),e,this)})));return function(r,t){return e.apply(this,arguments)}}(),e.purchaseFallback=function(){var e=t(n().mark((function e(r,t,a){var s,u,i,o,c,p,h,f;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPlayerDataCached({refresh:!0});case 2:if(i=e.sent){e.next=5;break}throw new Error("no player data");case 5:if(o=a*t,!((null!=(s=i.dragonBones)?s:0)<o)){e.next=10;break}throw(c=new Error("NOT_ENOUGH")).code="NOT_ENOUGH",c;case 10:return i.dragonBones=(null!=(u=i.dragonBones)?u:0)-o,p=function(e,r){var t,n=e.split("."),a=n[0],s=n[1];i.inventory[a][s]=(null!=(t=i.inventory[a][s])?t:0)+r},(h={med_trans:function(e){return p("items.genderPotion",e)},med_change:function(e){return p("items.changePotion",e)},med_cold:function(e){return p("items.coldMedicine",e)},med_lvup:function(e){return p("items.upgradePotion",e)},med_revive:function(e){return p("items.revivePotion",e)},feed_normal:function(e){return p("feeds.normal",e)},feed_high:function(e){return p("feeds.premium",e)},env_brush:function(e){return p("items.brush",e)},env_fan:function(e){return p("items.fan",e)},heater:function(e){return p("items.heater",e)}})[r]?h[r](t):i.fashion.owned.includes(r)||i.fashion.owned.push(r),e.next=16,this.savePlayerDataWithCache(i);case 16:return f=e.sent,e.abrupt("return",f);case 18:case"end":return e.stop()}}),e,this)})));return function(r,t,n){return e.apply(this,arguments)}}(),e.purchase=function(){var e=t(n().mark((function e(r,t,a){var s,u;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=1),e.prev=1,e.next=4,this.purchaseViaApi(r,t);case 4:return s=e.sent,e.abrupt("return",{ok:!0,player:s});case 8:if(e.prev=8,e.t0=e.catch(1),null!=a){e.next=12;break}return e.abrupt("return",{ok:!1,error:(null==e.t0?void 0:e.t0.message)||"PURCHASE_FAILED"});case 12:return e.prev=12,e.next=15,this.purchaseFallback(r,t,a);case 15:return u=e.sent,e.abrupt("return",{ok:!0,player:u});case 19:return e.prev=19,e.t1=e.catch(12),e.abrupt("return",{ok:!1,error:(null==e.t1?void 0:e.t1.code)||(null==e.t1?void 0:e.t1.message)||"PURCHASE_FAILED"});case 22:case"end":return e.stop()}}),e,this,[[1,8],[12,19]])})));return function(r,t,n){return e.apply(this,arguments)}}(),e}());i.useLocalStorage=!1,i.apiBase="",i.currentUserId=null,i.ready=null,i.readyResolve=null,i.initializing=!1,i._snapshot=null,i._snapshotTime=0,i._inFlight=null,i._listeners=new Set,a._RF.pop()}}}));

System.register("chunks:///_virtual/DevTest.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts","./GameManager.ts"],(function(e){var t,n,r,a,u,i,c,o,s,l,p,f,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,a=e.assertThisInitialized,u=e.asyncToGenerator,i=e.regeneratorRuntime},function(e){c=e.cclegacy,o=e._decorator,s=e.EditBox,l=e.Component,p=e.find},function(e){f=e.DataManager},function(e){h=e.GameManager}],execute:function(){var d,y,g,v,x,D,m;c._RF.push({},"fe63dMrY9ZGCr/R8Zz3KSud","DevTest",void 0);var b=o.ccclass,w=o.property;e("DevTest",(d=b("DevTest"),y=w(s),g=w(s),d((D=t((x=function(e){function t(){for(var t,n=arguments.length,u=new Array(n),i=0;i<n;i++)u[i]=arguments[i];return t=e.call.apply(e,[this].concat(u))||this,r(t,"fishIdInput",D,a(t)),r(t,"tempInput",m,a(t)),t}n(t,e);var c=t.prototype;return c.onClearData=function(){f.clearPlayerData()},c.onHungerDeath=function(){var e=u(i().mark((function e(){var t,n,r,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=parseInt(this.fishIdInput.string),!isNaN(n)){e.next=4;break}return console.warn("請輸入正確的魚 ID"),e.abrupt("return");case 4:return e.next=6,null==(t=f.ready)?void 0:t.catch((function(){}));case 6:return e.next=8,f.getPlayerDataCached();case 8:if(r=e.sent){e.next=11;break}return e.abrupt("return");case 11:if(a=r.fishList.find((function(e){return e.id===n}))){e.next=15;break}return console.warn("找不到魚 ID: "+n),e.abrupt("return");case 15:return a.hunger=100,e.next=18,f.savePlayerDataWithCache(r);case 18:console.log("魚 "+a.name+" 飢餓設為 100，將於下次啟動自動死亡");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.onPrintSummary=function(){var e=u(i().mark((function e(){var t,n,r,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(t=f.ready)?void 0:t.catch((function(){}));case 2:return e.next=4,f.getPlayerDataCached();case 4:if(n=e.sent){e.next=8;break}return console.warn("尚未建立任何玩家資料"),e.abrupt("return");case 8:r=n.fishList.length,a=n.fishList.filter((function(e){return e.isDead})).length,console.log("玩家ID: "+n.userId),console.log("魚數量: "+r),console.log("死魚: "+a);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c.toHalfWidth=function(e){return e.replace(/[\uFF01-\uFF5E]/g,(function(e){return String.fromCharCode(e.charCodeAt(0)-65248)})).replace(/\u3000/g," ")},c.onSetTemperature=function(){var e=u(i().mark((function e(){var t,n,r,a,u,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.tempInput){e.next=3;break}return console.warn("tempInput 沒有在編輯器綁定到 DevTest！"),e.abrupt("return");case 3:if(r=null!=(t=this.tempInput.string)?t:"",a=this.toHalfWidth(r).trim(),u=parseFloat(a),isFinite(u)){e.next=9;break}return console.warn('請輸入數字水溫（目前輸入: "'+r+'" -> "'+a+'"）'),e.abrupt("return");case 9:return e.next=11,null==(n=f.ready)?void 0:n.catch((function(){}));case 11:return e.next=13,f.getPlayerDataCached();case 13:if(c=e.sent){e.next=16;break}return e.abrupt("return");case 16:return c.tankEnvironment.temperature=u,e.next=19,f.savePlayerDataWithCache(c);case 19:console.log("水溫已設為 "+u+"°C");case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.onSetWaterClean=function(){var e=u(i().mark((function e(){var t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(t=f.ready)?void 0:t.catch((function(){}));case 2:return e.next=4,f.getPlayerDataCached();case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return");case 7:return n.tankEnvironment.waterQualityStatus="clean",e.next=10,f.savePlayerDataWithCache(n);case 10:console.log("水質已設為乾淨");case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c.onSetWaterDirty=function(){var e=u(i().mark((function e(){var t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(t=f.ready)?void 0:t.catch((function(){}));case 2:return e.next=4,f.getPlayerDataCached();case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return");case 7:return n.tankEnvironment.waterQualityStatus="dirty",e.next=10,f.savePlayerDataWithCache(n);case 10:console.log("水質已設為髒");case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c.onSimulateDirtyAndSickToday=function(){var e=u(i().mark((function e(){var t,n,r,a,u,c,o,s,l,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(t=f.ready)?void 0:t.catch((function(){}));case 2:return e.next=4,f.getPlayerDataCached();case 4:if(a=e.sent){e.next=7;break}return e.abrupt("return");case 7:return(u=a.tankEnvironment).waterQualityStatus="dirty",u.loginDaysSinceClean=Math.max(1,null!=(n=u.loginDaysSinceClean)?n:0),u.badEnvLoginDays=1,c=new Date,o=new Date(c.getTime()-864e5),a.lastLoginDate=o.toISOString().split("T")[0],a.lastLoginTime=o.toISOString(),s=JSON.stringify(a,null,2),e.next=18,f.savePlayerDataWithCache(a);case 18:return l=e.sent,console.log("送出的 data:",s),console.log("伺服器回傳 fresh:",JSON.stringify(l,null,2)),d=null==(r=p("/GameManager"))?void 0:r.getComponent(h),e.next=24,null==d?void 0:d.processDailyUpdate();case 24:console.log("今日水質為髒，且依緩衝機制讓一隻魚感冒。");case 25:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t}(l)).prototype,"fishIdInput",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=t(x.prototype,"tempInput",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=x))||v));c._RF.pop()}}}));

System.register("chunks:///_virtual/ExpandMenu.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,e,i,o,a,s,l,p,c,r,u,h,g,f;return{setters:[function(n){t=n.applyDecoratedDescriptor,e=n.inheritsLoose,i=n.initializerDefineProperty,o=n.assertThisInitialized},function(n){a=n.cclegacy,s=n._decorator,l=n.Node,p=n.input,c=n.Input,r=n.UIOpacity,u=n.Vec3,h=n.tween,g=n.UITransform,f=n.Component}],execute:function(){var T,_,d,v,y,w,m,B,C;a._RF.push({},"487a7VYpdpMYrEVpwVZ65C0","ExpandMenu",void 0);var E=s.ccclass,b=s.property;n("ExpandMenu",(T=E("ExpandMenu"),_=b(l),d=b(l),v=b(l),T((m=t((w=function(n){function t(){for(var t,e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];return t=n.call.apply(n,[this].concat(a))||this,i(t,"panel",m,o(t)),i(t,"content",B,o(t)),i(t,"toggleBtn",C,o(t)),t._isOpen=!1,t._isAnimating=!1,t._openTween=void 0,t._closeTween=void 0,t}e(t,n);var a=t.prototype;return a.onLoad=function(){this.initPanelState(!1),this.toggleBtn.on(l.EventType.TOUCH_END,this.onToggle,this),p.on(c.EventType.TOUCH_START,this.onBackgroundTouch,this)},a.onDestroy=function(){var n,t;this.toggleBtn.off(l.EventType.TOUCH_END,this.onToggle,this),p.off(c.EventType.TOUCH_START,this.onBackgroundTouch,this),null==(n=this._openTween)||n.stop(),null==(t=this._closeTween)||t.stop()},a.initPanelState=function(n){var t,e=null!=(t=this.panel.getComponent(r))?t:this.panel.addComponent(r);n?(this.panel.active=!0,this.panel.scale=new u(1,1,1),e.opacity=255):(this.panel.active=!1,this.panel.scale=new u(.8,.8,.8),e.opacity=0)},a.onToggle=function(){this._isAnimating||(this._isOpen?this.close():this.open())},a.open=function(){var n,t=this,e=this.panel.getComponent(r);this.panel.active=!0,this.panel.scale=new u(.8,.8,.8),e.opacity=0,null==(n=this._closeTween)||n.stop(),this._isAnimating=!0,this._openTween=h(this.panel).parallel(h(this.panel).to(.15,{scale:new u(1.02,1.02,1.02)}),h(e).to(.15,{opacity:255})).to(.08,{scale:new u(1,1,1)}).call((function(){t._isAnimating=!1,t._isOpen=!0})).start()},a.close=function(){var n,t=this,e=this.panel.getComponent(r);null==(n=this._openTween)||n.stop(),this._isAnimating=!0,this._closeTween=h(this.panel).to(.12,{scale:new u(.92,.92,.92)}).parallel(h(this.panel).to(.12,{scale:new u(.8,.8,.8)}),h(e).to(.12,{opacity:0})).call((function(){t.panel.active=!1,t._isAnimating=!1,t._isOpen=!1})).start()},a.onBackgroundTouch=function(n){if(this._isOpen&&!this._isAnimating){var t=n.getUILocation();this.isPointInNode(this.panel,t)||this.isPointInNode(this.toggleBtn,t)||this.close()}},a.isPointInNode=function(n,t){var e=n.getComponent(g);return!!e&&e.getBoundingBoxToWorld().contains(t)},t}(f)).prototype,"panel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(w.prototype,"content",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=t(w.prototype,"toggleBtn",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=w))||y));a._RF.pop()}}}));

System.register("chunks:///_virtual/FishAnimate.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var i,t,n,r,o,s,a,l,u,c;return{setters:[function(e){i=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,s=e._decorator,a=e.Node,l=e.tween,u=e.Vec3,c=e.Component}],execute:function(){var g,f,p,h,w,y,b,d,m;o._RF.push({},"cfec2qXdB1LZKH61R24EaR1","FishAnimate",void 0);var A=s.ccclass,v=s.property;e("FishPartsRotateSwing",(g=A("FishAnimate"),f=v({type:a}),p=v({type:a}),g((y=i((w=function(e){function i(){for(var i,t=arguments.length,o=new Array(t),s=0;s<t;s++)o[s]=arguments[s];return i=e.call.apply(e,[this].concat(o))||this,n(i,"fishHand",y,r(i)),n(i,"fishTail",b,r(i)),n(i,"swingAngle",d,r(i)),n(i,"swingTime",m,r(i)),i}t(i,e);var o=i.prototype;return o.start=function(){this.swingNodeRotate(this.fishHand,this.swingAngle,this.swingTime),this.swingNodeRotate(this.fishTail,this.swingAngle,this.swingTime)},o.swingNodeRotate=function(e,i,t){if(e){var n=e.eulerAngles.clone();!function r(){l(e).to(t/2,{eulerAngles:new u(n.x,n.y,n.z+i)}).to(t,{eulerAngles:new u(n.x,n.y,n.z-i)}).to(t/2,{eulerAngles:n}).call(r).start()}()}},i}(c)).prototype,"fishHand",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=i(w.prototype,"fishTail",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=i(w.prototype,"swingAngle",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),m=i(w.prototype,"swingTime",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),h=w))||h));o._RF.pop()}}}));

System.register("chunks:///_virtual/FishDetailManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SwimmingFish.ts","./FishLogic.ts","./GameManager.ts","./DataManager.ts","./UIUtils.ts"],(function(e){var t,n,i,r,a,o,l,u,s,c,h,f,p,b,g,d,m,y,C,w,P,v,T,D;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,a=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){l=e.cclegacy,u=e._decorator,s=e.Node,c=e.Label,h=e.Sprite,f=e.SpriteFrame,p=e.EditBox,b=e.Button,g=e.UIOpacity,d=e.UITransform,m=e.Vec3,y=e.tween,C=e.Component},function(e){w=e.SwimmingFish},function(e){P=e.FishLogic},function(e){v=e.GameManager},function(e){T=e.DataManager},function(e){D=e.playOpenPanelAnim}],execute:function(){var B,x,S,L,E,F,z,N,U,k,O,I,M,_,H,R,G,W,A,Y,K,V,j,q,J,Q,X,Z,$,ee,te,ne,ie,re,ae,oe,le,ue,se,ce,he,fe,pe,be,ge,de,me,ye,Ce,we,Pe,ve,Te,De,Be,xe,Se,Le,Ee,Fe,ze,Ne,Ue,ke,Oe,Ie,Me,_e,He,Re,Ge,We,Ae,Ye,Ke,Ve,je,qe,Je,Qe,Xe,Ze,$e,et,tt,nt,it,rt,at;l._RF.push({},"87e56rnJ5NE5Yy1vwwEWYcu","FishDetailManager",void 0);var ot=u.ccclass,lt=u.property;e("FishDetailManager",(B=ot("FishDetailManager"),x=lt(s),S=lt(c),L=lt(c),E=lt(s),F=lt(c),z=lt(c),N=lt(c),U=lt(h),k=lt(c),O=lt(s),I=lt(s),M=lt(s),_=lt(s),H=lt(s),R=lt(c),G=lt(s),W=lt(c),A=lt(s),Y=lt(c),K=lt(s),V=lt(c),j=lt(s),q=lt(s),J=lt(s),Q=lt(s),X=lt(c),Z=lt(c),$=lt(s),ee=lt(f),te=lt(f),ne=lt(f),ie=lt(f),re=lt(f),ae=lt(f),oe=lt(f),le=lt(s),ue=lt(p),se=lt(s),ce=lt(s),he=lt(s),fe=lt(c),pe=lt(s),be=lt(s),B((me=t((de=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,i(t,"fishDetailPanel",me,r(t)),i(t,"fishNameLabel",ye,r(t)),i(t,"stageLabel",Ce,r(t)),i(t,"renameButton",we,r(t)),i(t,"genderLabel",Pe,r(t)),i(t,"daysLabel",ve,r(t)),i(t,"hungerLabel",Te,r(t)),i(t,"fishStatusImage",De,r(t)),i(t,"floatingText",Be,r(t)),i(t,"fashionSection",xe,r(t)),i(t,"fashionTabButton",Se,r(t)),i(t,"healSection",Le,r(t)),i(t,"healTabButton",Ee,r(t)),i(t,"genderPotionBtn",Fe,r(t)),i(t,"genderPotionCountLabel",ze,r(t)),i(t,"upgradePotionBtn",Ne,r(t)),i(t,"upgradePotionCountLabel",Ue,r(t)),i(t,"coldMedicineBtn",ke,r(t)),i(t,"coldMedicineCountLabel",Oe,r(t)),i(t,"changePotionBtn",Ie,r(t)),i(t,"changePotionCountLabel",Me,r(t)),i(t,"feedSection",_e,r(t)),i(t,"feedTabButton",He,r(t)),i(t,"feedBtnNormal",Re,r(t)),i(t,"feedBtnPremium",Ge,r(t)),i(t,"feedNormalCountLabel",We,r(t)),i(t,"feedPremiumCountLabel",Ae,r(t)),i(t,"closeButton",Ye,r(t)),i(t,"happySprite",Ke,r(t)),i(t,"sadSprite",Ve,r(t)),i(t,"angrySprite",je,r(t)),i(t,"hungrySprite",qe,r(t)),i(t,"coldSprite",Je,r(t)),i(t,"hotSprite",Qe,r(t)),i(t,"sickSprite",Xe,r(t)),i(t,"RenamePanel",Ze,r(t)),i(t,"renameInput",$e,r(t)),i(t,"renameConfirmButton",et,r(t)),i(t,"renameCancelButton",tt,r(t)),i(t,"confirmDialogPanel",nt,r(t)),i(t,"confirmDialogText",it,r(t)),i(t,"confirmDialogYesButton",rt,r(t)),i(t,"confirmDialogNoButton",at,r(t)),t.currentFishId=-1,t.confirmCallback=null,t.isReadOnly=!1,t}n(t,e);var l=t.prototype;return l.start=function(){var e=this;w.setEmotionFrames({happy:this.happySprite,sad:this.sadSprite,angry:this.angrySprite,hungry:this.hungrySprite,cold:this.coldSprite,hot:this.hotSprite,sick:this.sickSprite}),this.closeButton.on(s.EventType.TOUCH_END,this.closeFishDetail,this),this.renameButton.on(s.EventType.TOUCH_END,this.showRenamePanel,this),this.renameConfirmButton.on(s.EventType.TOUCH_END,this.renameFish,this),this.renameCancelButton.on(s.EventType.TOUCH_END,this.hideRenamePanel,this),this.fashionTabButton.on(s.EventType.TOUCH_END,(function(){return e.switchTab("fashion")}),this),this.healTabButton.on(s.EventType.TOUCH_END,(function(){return e.switchTab("heal")}),this),this.feedTabButton.on(s.EventType.TOUCH_END,(function(){return e.switchTab("feed")}),this),this.genderPotionBtn.on(s.EventType.TOUCH_END,this.onUseGenderPotion,this),this.upgradePotionBtn.on(s.EventType.TOUCH_END,this.onUseUpgradePotion,this),this.coldMedicineBtn.on(s.EventType.TOUCH_END,this.onUseColdMedicine,this),this.confirmDialogYesButton.on(s.EventType.TOUCH_END,(function(){e.confirmCallback&&(e.confirmCallback(),e.confirmCallback=null),e.confirmDialogPanel.active=!1}),this),this.confirmDialogNoButton.on(s.EventType.TOUCH_END,(function(){e.confirmCallback=null,e.confirmDialogPanel.active=!1}),this)},l.showFishDetail=function(){var e=a(o().mark((function e(t,n,i){var r,a,l,u,c,h,f,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D(this.fishDetailPanel),this.currentFishId=t.id,this.switchTab("feed"),this.fishNameLabel.string=t.name,this.genderLabel.string="性別："+("male"===t.gender?"公":"母"),this.daysLabel.string="已成長天數："+t.growthDaysPassed,this.stageLabel.string="LV "+t.stage,this.hungerLabel.string="飢餓值："+Math.floor(t.hunger)+" / 100",!(r=!(null==i||!i.readOnly))){e.next=18;break}this.feedNormalCountLabel.string="-",this.feedPremiumCountLabel.string="-",this.genderPotionCountLabel.string="-",this.upgradePotionCountLabel.string="-",this.changePotionCountLabel.string="-",this.coldMedicineCountLabel.string="-",e.next=27;break;case 18:return e.next=20,T.getPlayerDataCached();case 20:a=e.sent,this.feedNormalCountLabel.string=a.inventory.feeds.normal.toString(),this.feedPremiumCountLabel.string=a.inventory.feeds.premium.toString(),this.genderPotionCountLabel.string=a.inventory.items.genderPotion.toString(),this.upgradePotionCountLabel.string=a.inventory.items.upgradePotion.toString(),this.changePotionCountLabel.string=a.inventory.items.changePotion.toString(),this.coldMedicineCountLabel.string=a.inventory.items.coldMedicine.toString();case 27:if(this.feedBtnNormal.off(s.EventType.TOUCH_END),this.feedBtnPremium.off(s.EventType.TOUCH_END),this.genderPotionBtn.off(s.EventType.TOUCH_END),this.upgradePotionBtn.off(s.EventType.TOUCH_END),this.coldMedicineBtn.off(s.EventType.TOUCH_END),r||(this.feedBtnNormal.on(s.EventType.TOUCH_END,this.feedNormal,this),this.feedBtnPremium.on(s.EventType.TOUCH_END,this.feedPremium,this),this.genderPotionBtn.on(s.EventType.TOUCH_END,this.onUseGenderPotion,this),this.upgradePotionBtn.on(s.EventType.TOUCH_END,this.onUseUpgradePotion,this),this.coldMedicineBtn.on(s.EventType.TOUCH_END,this.onUseColdMedicine,this)),this.feedBtnNormal.getComponent(b).interactable=!r,this.feedBtnPremium.getComponent(b).interactable=!r,this.genderPotionBtn.getComponent(b).interactable=!r,this.upgradePotionBtn.getComponent(b).interactable=!r,this.coldMedicineBtn.getComponent(b).interactable=!r,this.renameButton.getComponent(b).interactable=!r,this.fashionTabButton.getComponent(b).interactable=!r,this.healTabButton.getComponent(b).interactable=!r,!n){e.next=45;break}this.fishStatusImage.spriteFrame=n,e.next=50;break;case 45:return e.next=47,T.getPlayerDataCached();case 47:l=e.sent,(u=t.emotion)?(c=w.getEmotionSpriteByKey(u),this.fishStatusImage.spriteFrame=c):(h=l.tankEnvironment,f=w.computeEmotion(t,h),p=w.getEmotionSpriteByKey(f),this.fishStatusImage.spriteFrame=p);case 50:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),l.feedNormal=function(){this.feedFish(3,"normal")},l.feedPremium=function(){this.feedFish(20,"premium")},l.feedFish=function(){var e=a(o().mark((function e(t,n){var i,r,a,l=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.getPlayerDataCached();case 2:if(i=e.sent,r=i.fishList.find((function(e){return e.id===l.currentFishId}))){e.next=6;break}return e.abrupt("return");case 6:if(!(r.hunger<=0)){e.next=9;break}return this.showFloatingTextRightOf(this.hungerLabel.node,"已飽，無需餵食"),e.abrupt("return");case 9:return a=P.feed(r,i.inventory,t,n),console.log(a),e.next=13,T.savePlayerDataWithCache(i);case 13:this.showFishDetail(r),this.showFloatingTextRightOf(this.hungerLabel.node,"餵食 -"+t);case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),l.renameFish=function(){var e=a(o().mark((function e(){var t,n,i,r=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.renameInput.string.trim()){e.next=4;break}return console.warn("名字不能為空！"),e.abrupt("return");case 4:return e.next=6,T.getPlayerDataCached();case 6:if(n=e.sent,i=n.fishList.find((function(e){return e.id===r.currentFishId}))){e.next=10;break}return e.abrupt("return");case 10:if(P.renameFish(i,t)){e.next=14;break}return console.warn("名字無效"),e.abrupt("return");case 14:return e.next=16,T.savePlayerDataWithCache(n);case 16:this.hideRenamePanel(),this.showFishDetail(i);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.switchTab=function(e){switch(this.fashionSection.setSiblingIndex(0),this.healSection.setSiblingIndex(0),this.feedSection.setSiblingIndex(0),e){case"fashion":this.fashionSection.setSiblingIndex(99);break;case"heal":this.healSection.setSiblingIndex(99);break;case"feed":this.feedSection.setSiblingIndex(99)}},l.onUseGenderPotion=function(){var e=this;this.showConfirmDialog("確定要使用變性藥嗎？",(function(){return e.useGenderPotion()}))},l.useGenderPotion=function(){var e=a(o().mark((function e(){var t,n,i,r,a=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.getPlayerDataCached();case 2:if(t=e.sent,n=t.fishList.find((function(e){return e.id===a.currentFishId}))){e.next=6;break}return e.abrupt("return");case 6:return i=P.useGenderPotion(n,t.inventory.items),e.next=9,T.savePlayerDataWithCache(t);case 9:console.log(i),this.showFishDetail(n),this.showFloatingTextRightOf(this.genderLabel.node,"變性完成！"),(r=this.node.scene.getComponentInChildren(v))&&r.replaceFishNode(n);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.onUseUpgradePotion=function(){var e=this;this.showConfirmDialog("確定要使用升級藥嗎？",(function(){return e.useUpgradePotion()}))},l.useUpgradePotion=function(){var e=a(o().mark((function e(){var t,n,i,r,a,l,u=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.getPlayerDataCached();case 2:if(t=e.sent,n=t.fishList.find((function(e){return e.id===u.currentFishId}))){e.next=6;break}return e.abrupt("return");case 6:return i=P.useUpgradePotion(n,t.inventory.items),r=i.message,a=i.upgraded,e.next=9,T.savePlayerDataWithCache(t);case 9:return console.log(r),e.next=12,this.showFishDetail(n);case 12:this.showFloatingTextRightOf(this.daysLabel.node,"成長天數 +5"),a&&(l=this.node.scene.getComponentInChildren(v))&&l.replaceFishNode(n);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.onUseColdMedicine=function(){var e=this;this.showConfirmDialog("確定要使用感冒藥嗎？",(function(){return e.useColdMedicine()}))},l.useColdMedicine=function(){var e=a(o().mark((function e(){var t,n,i,r,a,l,u=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.getPlayerDataCached();case 2:if(t=e.sent,n=t.fishList.find((function(e){return e.id===u.currentFishId}))){e.next=6;break}return e.abrupt("return");case 6:return i=P.useColdMedicine(n,t.inventory.items),r=i.message,a=i.cured,e.next=9,T.savePlayerDataWithCache(t);case 9:if(console.log(r),!a){e.next=16;break}return(l=this.node.scene.getComponentInChildren(v))&&l.replaceFishNode(n),this.showFloatingTextRightOf(this.fishStatusImage.node,"已治癒！"),e.next=16,this.showFishDetail(n);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.setButtonEnabled=function(e,t){var n;(null==(n=e.getComponent(b))?void 0:n.node)&&(e.getComponent(b).interactable=t);var i=e.getComponent(g);i||(i=e.addComponent(g)),i.opacity=t?255:120},l.showFloatingTextRightOf=function(e,t){var n=this.floatingText.node,i=n.getComponent(g);if(i){this.floatingText.string=t,n.active=!0,i.opacity=0;var r=e.getComponent(d).getBoundingBoxToWorld(),a=new m(r.xMax+10,(r.yMin+r.yMax)/2,0),o=n.parent.getComponent(d).convertToNodeSpaceAR(a);n.setPosition(o);var l=o.clone().add(new m(0,30,0));y(i).to(.1,{opacity:255}).delay(.4).to(.2,{opacity:0}).call((function(){return n.active=!1})).start(),y(n).to(.6,{position:l},{easing:"quadOut"}).start()}else console.warn("FloatingText node is missing UIOpacity component!")},l.hideAllSubPanels=function(){this.RenamePanel.active=!1},l.closeFishDetail=function(){this.fishDetailPanel.active=!1,this.hideAllSubPanels(),w.clearSelection()},l.showRenamePanel=function(){var e=a(o().mark((function e(){var t,n,i=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.getPlayerDataCached();case 2:if(t=e.sent,n=t.fishList.find((function(e){return e.id===i.currentFishId}))){e.next=6;break}return e.abrupt("return");case 6:this.renameInput.string=n.name,this.RenamePanel.active=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.hideRenamePanel=function(){this.RenamePanel.active=!1},l.showConfirmDialog=function(e,t){this.confirmDialogText.string=e,this.confirmDialogPanel.active=!0,this.confirmCallback=t},t}(C)).prototype,"fishDetailPanel",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ye=t(de.prototype,"fishNameLabel",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ce=t(de.prototype,"stageLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),we=t(de.prototype,"renameButton",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pe=t(de.prototype,"genderLabel",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ve=t(de.prototype,"daysLabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Te=t(de.prototype,"hungerLabel",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),De=t(de.prototype,"fishStatusImage",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Be=t(de.prototype,"floatingText",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xe=t(de.prototype,"fashionSection",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Se=t(de.prototype,"fashionTabButton",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Le=t(de.prototype,"healSection",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ee=t(de.prototype,"healTabButton",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Fe=t(de.prototype,"genderPotionBtn",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ze=t(de.prototype,"genderPotionCountLabel",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ne=t(de.prototype,"upgradePotionBtn",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ue=t(de.prototype,"upgradePotionCountLabel",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ke=t(de.prototype,"coldMedicineBtn",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Oe=t(de.prototype,"coldMedicineCountLabel",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ie=t(de.prototype,"changePotionBtn",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Me=t(de.prototype,"changePotionCountLabel",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_e=t(de.prototype,"feedSection",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),He=t(de.prototype,"feedTabButton",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Re=t(de.prototype,"feedBtnNormal",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ge=t(de.prototype,"feedBtnPremium",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),We=t(de.prototype,"feedNormalCountLabel",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ae=t(de.prototype,"feedPremiumCountLabel",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ye=t(de.prototype,"closeButton",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ke=t(de.prototype,"happySprite",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ve=t(de.prototype,"sadSprite",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),je=t(de.prototype,"angrySprite",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),qe=t(de.prototype,"hungrySprite",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Je=t(de.prototype,"coldSprite",[re],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qe=t(de.prototype,"hotSprite",[ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xe=t(de.prototype,"sickSprite",[oe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ze=t(de.prototype,"RenamePanel",[le],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$e=t(de.prototype,"renameInput",[ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),et=t(de.prototype,"renameConfirmButton",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tt=t(de.prototype,"renameCancelButton",[ce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),nt=t(de.prototype,"confirmDialogPanel",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),it=t(de.prototype,"confirmDialogText",[fe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rt=t(de.prototype,"confirmDialogYesButton",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),at=t(de.prototype,"confirmDialogNoButton",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ge=de))||ge));l._RF.pop()}}}));

System.register("chunks:///_virtual/FishLogic.ts",["cc"],(function(e){var n;return{setters:[function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"3c40aGigUFOeZwflbv+5hJh","FishLogic",void 0);e("FishLogic",function(){function e(){}return e.feed=function(e,n,t,a){return n.feeds[a]<=0?"沒有 "+("normal"===a?"普通":"高級")+"飼料了":(n.feeds[a]--,e.hunger=Math.max(0,e.hunger-t),e.lastFedDate=(new Date).toISOString(),"已餵食 "+e.name+"，飢餓值 -"+t)},e.renameFish=function(e,n){return!(!n||n.length>12)&&(e.name=n,!0)},e.getEmotionKey=function(e){return"happy"===e.emotion?"happy":"sad"===e.emotion?"sad":null},e.useUpgradePotion=function(e,n){if(n.upgradePotion<=0)return{message:"沒有升級藥了",upgraded:!1};if(e.isDead)return{message:"魚已死亡，不能使用升級藥",upgraded:!1};if(e.stage>=6)return{message:"這隻魚已達最高階段",upgraded:!1};n.upgradePotion--,e.growthDaysPassed+=5;var t=this.tryStageUpgradeByGrowthDays(e);return{message:t?e.name+" 升級為第 "+e.stage+" 階！（吃藥長大）":e.name+" 成長天數 +5",upgraded:t}},e.useGenderPotion=function(e,n){return n.genderPotion<=0?"沒有變性藥了":e.isDead?"魚已死亡，不能變性":(n.genderPotion--,e.gender="male"===e.gender?"female":"male",e.name+" 的性別已變更為 "+("male"===e.gender?"公":"母"))},e.useColdMedicine=function(e,n){return n.coldMedicine<=0?{message:"沒有感冒藥了",cured:!1}:e.isDead?{message:"魚已死亡，不能使用感冒藥",cured:!1}:(e.status||(e.status={sick:!1}),e.status.sick?(n.coldMedicine-=1,e.status.sick=!1,e.emotion="happy",{message:e.name+" 已治癒",cured:!0}):{message:e.name+" 並沒有生病",cured:!1})},e.tryStageUpgradeByGrowthDays=function(e){for(var n={1:0,2:5,3:15,4:35,5:60,6:90},t=!1;e.stage<6&&e.growthDaysPassed>=n[e.stage+1];)e.stage++,t=!0;return t},e}());n._RF.pop()}}}));

System.register("chunks:///_virtual/FriendPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts","./GameManager.ts","./UIUtils.ts"],(function(e){var t,n,r,i,a,o,s,l,u,c,d,p,f,h,b,v,m,g,C,x,y,w,T,I;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.asyncToGenerator,i=e.regeneratorRuntime,a=e.initializerDefineProperty,o=e.assertThisInitialized,s=e.createForOfIteratorHelperLoose},function(e){l=e.cclegacy,u=e._decorator,c=e.Node,d=e.SpriteFrame,p=e.Prefab,f=e.Button,h=e.EditBox,b=e.Color,v=e.Sprite,m=e.Label,g=e.instantiate,C=e.Component,x=e.ImageAsset,y=e.Texture2D},function(e){w=e.DataManager},function(e){T=e.GameManager},function(e){I=e.showFloatingTextCenter}],execute:function(){var k,B,L,F,E,S,A,N,P,z,U,R,D,K,M,q,V,G,_,O,H,Y,j,X,Z,J,Q,W,$;l._RF.push({},"41c4dY/ZOFPd41kmFX8GyU6","FriendPanel",void 0);var ee=u.ccclass,te=u.property,ne=function(e){return e.Friends="friends",e.Explore="explore",e}(ne||{});e("FriendPanel",(k=ee("FriendPanel"),B=te(c),L=te(d),F=te(p),E=te(f),S=te(f),A=te(c),N=te(c),P=te(p),z=te(c),U=te(c),R=te(h),D=te(f),K=te(p),k((V=t((q=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=e.call.apply(e,[this].concat(r))||this,a(t,"floatingNode",V,o(t)),a(t,"defaultAvatar",G,o(t)),a(t,"emptyStatePrefab",_,o(t)),a(t,"friendsTabBtn",O,o(t)),a(t,"exploreTabBtn",H,o(t)),a(t,"friendsSection",Y,o(t)),a(t,"friendsListContent",j,o(t)),a(t,"friendRowPrefab",X,o(t)),a(t,"exploreSection",Z,o(t)),a(t,"exploreListContent",J,o(t)),a(t,"friendIdInput",Q,o(t)),a(t,"searchBtn",W,o(t)),a(t,"searchRowPrefab",$,o(t)),t.currentTab=ne.Friends,t}n(t,e);var l=t.prototype;return l.onEnable=function(){this.bindEvents(),this.switchTab(this.currentTab)},l.onDisable=function(){this.unbindEvents()},l.start=function(){},l.bindEvents=function(){var e,t,n;null==(e=this.exploreTabBtn)||e.node.on(f.EventType.CLICK,this.onClickExploreTab,this),null==(t=this.friendsTabBtn)||t.node.on(f.EventType.CLICK,this.onClickFriendsTab,this),null==(n=this.searchBtn)||n.node.on(f.EventType.CLICK,this.onClickSearch,this)},l.unbindEvents=function(){var e,t,n;null==(e=this.exploreTabBtn)||e.node.off(f.EventType.CLICK,this.onClickExploreTab,this),null==(t=this.friendsTabBtn)||t.node.off(f.EventType.CLICK,this.onClickFriendsTab,this),null==(n=this.searchBtn)||n.node.off(f.EventType.CLICK,this.onClickSearch,this)},l.onClickFriendsTab=function(){this.switchTab(ne.Friends)},l.onClickExploreTab=function(){this.switchTab(ne.Explore)},l.switchTab=function(){var e=r(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentTab=t,this.updateTabVisual(),this.friendsSection&&(this.friendsSection.active=t===ne.Friends),this.exploreSection&&(this.exploreSection.active=t===ne.Explore),null==(n=this.getActiveList())||n.removeAllChildren(),t!==ne.Friends){e.next=10;break}return e.next=8,this.refreshFriendsList();case 8:e.next=12;break;case 10:return e.next=12,this.refreshExploreList();case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),l.updateTabVisual=function(){var e,t,n=this.currentTab===ne.Friends,r=new b(80,180,255,255),i=new b(180,180,180,255),a=null==(e=this.friendsTabBtn)?void 0:e.getComponent(v),o=null==(t=this.exploreTabBtn)?void 0:t.getComponent(v);a&&(a.color=n?r:i),o&&(o.color=n?i:r)},l.refreshExploreList=function(){var e=r(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.exploreListContent).removeAllChildren(),this.addEmptyStateToList(t,"-----推薦好友-----",!0),e.next=5,this.recommendFriends(!0);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.refreshFriendsList=function(){var e=r(i().mark((function e(){var t,n,r,a,o,l=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.friendsListContent).removeAllChildren(),e.prev=2,e.next=5,w.getFriends().catch((function(){return[]}));case 5:if((n=e.sent)&&0!==n.length){e.next=9;break}return this.addEmptyStateToList(t,"還沒有好友，快去探索結交新朋友吧！"),e.abrupt("return");case 9:r=i().mark((function e(){var n,r,a,s,u,c,d,p,h,b,C;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=o.value,c=g(l.friendRowPrefab),(d=null==(n=c.getChildByName("NameLabel"))?void 0:n.getComponent(m))&&(d.string=u.displayName||"(未設定暱稱)"),(p=null==(r=c.getChildByName("IdLabel"))?void 0:r.getComponent(m))&&(p.string=u.userId),h=c.getChildByName("UserAvatarMask"),!(b=null==h||null==(a=h.getChildByName("UserAvatar"))?void 0:a.getComponent(v))){e.next=15;break}if(!u.picture){e.next=14;break}return e.next=12,l.loadAvatar(u.picture,b);case 12:e.next=15;break;case 14:b.spriteFrame=l.defaultAvatar;case 15:null==(C=null==(s=c.getChildByName("ViewBtn"))?void 0:s.getComponent(f))||C.node.on(f.EventType.CLICK,(function(){return l.onViewFriendTank(u.userId)}),l),c.parent=t;case 18:case"end":return e.stop()}}),e)})),a=s(n);case 11:if((o=a()).done){e.next=15;break}return e.delegateYield(r(),"t0",13);case 13:e.next=11;break;case 15:e.next=22;break;case 17:e.prev=17,e.t1=e.catch(2),console.warn("[FriendPanel] load friends failed:",e.t1),t.removeAllChildren(),this.addEmptyStateToList(t,"載入好友失敗，請稍後再試");case 22:case"end":return e.stop()}}),e,this,[[2,17]])})));return function(){return e.apply(this,arguments)}}(),l.recommendFriends=function(){var e=r(i().mark((function e(t){var n,r,a,o,l,u,c,d,p,h,b,C,x,y,T,I,k,B;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!1),n=this.exploreListContent,t||(n.removeAllChildren(),this.addEmptyStateToList(n,"推薦中…")),e.prev=3,e.next=6,w.getRecommendedUsers(5).catch((function(){return[]}));case 6:if((r=e.sent)&&0!==r.length){e.next=10;break}return t||this.addEmptyStateToList(n,"目前沒有推薦的玩家"),e.abrupt("return");case 10:return e.next=12,Promise.all([w.getFriends().catch((function(){return[]})),w.getFriendRequests().catch((function(){return{incoming:[],outgoing:[]}}))]);case 12:a=e.sent,o=a[0],l=a[1],u=s(r);case 16:if((c=u()).done){e.next=37;break}if(C=c.value,x=g(this.searchRowPrefab),(y=null==(d=x.getChildByName("NameLabel"))?void 0:d.getComponent(m))&&(y.string=C.displayName||"(未設定暱稱)"),(T=null==(p=x.getChildByName("IdLabel"))?void 0:p.getComponent(m))&&(T.string=C.userId),I=x.getChildByName("UserAvatarMask"),!(k=null==I||null==(h=I.getChildByName("UserAvatar"))?void 0:h.getComponent(v))){e.next=32;break}if(!C.picture){e.next=31;break}return e.next=29,this.loadAvatar(C.picture,k);case 29:e.next=32;break;case 31:k.spriteFrame=this.defaultAvatar;case 32:(B=null==(b=x.getChildByName("InviteBtn"))?void 0:b.getComponent(f))&&this.setupInviteButton(B,C.userId,o,l),x.parent=n;case 35:e.next=16;break;case 37:e.next=43;break;case 39:e.prev=39,e.t0=e.catch(3),console.warn("[FriendPanel] recommend friends failed:",e.t0),t||(n.removeAllChildren(),this.addEmptyStateToList(n,"推薦好友失敗，請稍後再試"));case 43:case"end":return e.stop()}}),e,this,[[3,39]])})));return function(t){return e.apply(this,arguments)}}(),l.onClickSearch=function(){var e=r(i().mark((function e(){var t,n,r,a,o,s,l,u,c,d,p,h,b,C,x,y,T;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentTab===ne.Explore){e.next=3;break}return e.next=3,this.switchTab(ne.Explore);case 3:if(t=this.exploreListContent,n=(this.friendIdInput.string||"").trim()){e.next=9;break}return t.removeAllChildren(),this.addEmptyStateToList(t,"請輸入好友 ID"),e.abrupt("return");case 9:return e.prev=9,t.removeAllChildren(),l=this.addEmptyStateToList(t,"搜尋中…"),e.next=14,w.lookupUserById(n);case 14:if(u=e.sent,l&&l.isValid&&l.destroy(),u){e.next=23;break}return t.removeAllChildren(),this.addEmptyStateToList(t,"海裡翻遍了，也沒找到這位玩家"),this.addEmptyStateToList(t,"-----推薦好友-----",!0),e.next=22,this.recommendFriends(!0);case 22:return e.abrupt("return");case 23:if(c=g(this.searchRowPrefab),(d=null==(r=c.getChildByName("NameLabel"))?void 0:r.getComponent(m))&&(d.string=u.displayName||"(未設定暱稱)"),(p=null==(a=c.getChildByName("IdLabel"))?void 0:a.getComponent(m))&&(p.string=u.userId),h=c.getChildByName("UserAvatarMask"),!(b=null==h||null==(o=h.getChildByName("UserAvatar"))?void 0:o.getComponent(v))){e.next=37;break}if(!u.picture){e.next=36;break}return e.next=34,this.loadAvatar(u.picture,b);case 34:e.next=37;break;case 36:b.spriteFrame=this.defaultAvatar;case 37:return C=null==(s=c.getChildByName("InviteBtn"))?void 0:s.getComponent(f),e.next=40,Promise.all([w.getFriends().catch((function(){return[]})),w.getFriendRequests().catch((function(){return{incoming:[],outgoing:[]}}))]);case 40:x=e.sent,y=x[0],T=x[1],C&&this.setupInviteButton(C,u.userId,y,T),c.parent=t,e.next=52;break;case 47:e.prev=47,e.t0=e.catch(9),console.warn("[FriendPanel] search failed:",e.t0),t.removeAllChildren(),this.addEmptyStateToList(t,"查詢失敗，請稍後再試");case 52:case"end":return e.stop()}}),e,this,[[9,47]])})));return function(){return e.apply(this,arguments)}}(),l.getActiveList=function(){return this.currentTab===ne.Friends?this.friendsListContent:this.exploreListContent},l.loadAvatar=function(){var e=r(i().mark((function e(t,n){var r,a,o,s,l,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{mode:"cors"});case 3:return r=e.sent,e.next=6,r.blob();case 6:return a=e.sent,e.next=9,createImageBitmap(a);case 9:o=e.sent,s=new x(o),(l=new y).image=s,(u=new d).texture=l,n.spriteFrame=u,e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),console.warn("載入好友頭貼失敗:",e.t0),n.spriteFrame=this.defaultAvatar;case 22:case"end":return e.stop()}}),e,this,[[0,18]])})));return function(t,n){return e.apply(this,arguments)}}(),l.onViewFriendTank=function(){var e=r(i().mark((function e(t){var n,r,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.getPublicPlayerData(t);case 3:r=e.sent,null==(a=null==(n=this.node.scene.getChildByName("GameManager"))?void 0:n.getComponent(T))||a.showFriendTank(r),this.node.active=!1,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.warn("getPublicPlayerData failed:",e.t0),I(this.floatingNode,"載入好友資料失敗");case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),l.setInviteBtn=function(e,t,n){if(e){var r=e.node.getComponentInChildren(m);r&&(r.string=t),e.interactable=n}},l.addEmptyStateToList=function(e,t,n){if(void 0===n&&(n=!1),this.emptyStatePrefab){var r=g(this.emptyStatePrefab),i=r.getComponentInChildren(m);return i&&(i.string=t,n?(i.color=new b(0,0,0,255),i.fontSize=20):(i.color=new b(0,0,0,255),i.fontSize=24)),r.parent=e,r}},l.setupInviteButton=function(e,t,n,a){var o,s,l=this,u=null==n?void 0:n.some((function(e){return e.userId===t})),c=null==a||null==(o=a.outgoing)?void 0:o.some((function(e){return e.toUserId===t&&"pending"===e.status})),d=null==a||null==(s=a.incoming)?void 0:s.some((function(e){return e.fromUserId===t&&"pending"===e.status}));e.node.off(f.EventType.CLICK),u?this.setInviteBtn(e,"已是好友",!1):c?this.setInviteBtn(e,"已送出邀請",!1):d?this.setInviteBtn(e,"對方已邀請你",!1):(this.setInviteBtn(e,"送出邀請",!0),e.node.on(f.EventType.CLICK,r(i().mark((function n(){var r;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,l.setInviteBtn(e,"送出中…",!1),n.next=4,w.sendFriendRequest(t);case 4:r=n.sent,a.outgoing.push({requestId:r.request.requestId,fromUserId:w.currentUserId,toUserId:t,createdAt:(new Date).toISOString(),status:"pending"}),null!=r&&r.autoAccepted?(l.setInviteBtn(e,"已成為好友",!1),I(l.floatingNode,"已成為好友！")):(l.setInviteBtn(e,"已送出邀請",!1),I(l.floatingNode,"邀請已送出，等待對方確認")),l.node.emit("refresh-mail-badge"),n.next=15;break;case 10:n.prev=10,n.t0=n.catch(0),console.warn("sendFriendRequest failed:",n.t0),l.setInviteBtn(e,"送出邀請",!0),I(l.floatingNode,"邀請失敗，請稍後再試");case 15:case"end":return n.stop()}}),n,null,[[0,10]])}))),this))},t}(C)).prototype,"floatingNode",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(q.prototype,"defaultAvatar",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(q.prototype,"emptyStatePrefab",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(q.prototype,"friendsTabBtn",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(q.prototype,"exploreTabBtn",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(q.prototype,"friendsSection",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(q.prototype,"friendsListContent",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=t(q.prototype,"friendRowPrefab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(q.prototype,"exploreSection",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(q.prototype,"exploreListContent",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(q.prototype,"friendIdInput",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(q.prototype,"searchBtn",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=t(q.prototype,"searchRowPrefab",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=q))||M));l._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SwimmingFish.ts","./DataManager.ts","./FishLogic.ts","./TombManager.ts","./TankEnvironmentManager.ts","./UIUtils.ts","./LiffBridge.ts","./Api.ts"],(function(e){var t,n,r,a,i,o,s,u,l,c,h,f,p,b,m,d,y,g,v,k,w,D,T,C,x,L,B,N,E,F,P;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.createForOfIteratorHelperLoose,a=e.initializerDefineProperty,i=e.assertThisInitialized,o=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){u=e.cclegacy,l=e._decorator,c=e.Color,h=e.Node,f=e.SpriteFrame,p=e.Prefab,b=e.Button,m=e.Label,d=e.Sprite,y=e.instantiate,g=e.UITransform,v=e.Vec3,k=e.Component,w=e.ImageAsset,D=e.Texture2D},function(e){T=e.SwimmingFish},function(e){C=e.DataManager},function(e){x=e.FishLogic},function(e){L=e.TombManager},function(e){B=e.TankEnvironmentManager},function(e){N=e.showFloatingTextCenter},function(e){E=e.getIdentity,F=e.initLiff},function(e){P=e.authWithLine}],execute:function(){var M,I,z,S,O,A,U,H,_,V,Q,W,G,R,Y,j,J,X,Z,q,K,$,ee,te,ne,re,ae,ie,oe,se,ue,le,ce,he,fe,pe,be,me,de,ye,ge,ve,ke,we,De,Te,Ce,xe,Le,Be,Ne,Ee,Fe,Pe,Me,Ie,ze,Se,Oe,Ae,Ue,He,_e,Ve,Qe,We,Ge,Re,Ye,je,Je,Xe,Ze,qe,Ke,$e,et,tt,nt,rt,at;u._RF.push({},"d13bcYsAP9GrbI7DBywQwwD","GameManager",void 0);var it=l.ccclass,ot=l.property,st=new c(255,0,0,255),ut=new c(120,198,80,255),lt=new c(0,0,255,255),ct={backgrounds:new Map,decorations:new Map};e("GameManager",(M=it("GameManager"),I=ot(L),z=ot(h),S=ot(h),O=ot(f),A=ot([p]),U=ot([p]),H=ot([b]),_=ot(b),V=ot(h),Q=ot(h),W=ot(m),G=ot(m),R=ot(b),Y=ot(b),j=ot(b),J=ot(m),X=ot(m),Z=ot(m),q=ot(h),K=ot(h),$=ot(h),ee=ot(h),te=ot(m),ne=ot(h),re=ot(h),ae=ot(h),ie=ot(m),oe=ot(b),se=ot(h),ue=ot(b),le=ot(m),ce=ot(m),he=ot(d),fe=ot(f),pe=ot(h),be=ot(b),me=ot(m),de=ot(m),M((ve=t((ge=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,a(t,"tombManager",ve,i(t)),a(t,"activeTankViewport",ke,i(t)),a(t,"fishArea",we,i(t)),a(t,"defaultBackgroundSpriteFrame",De,i(t)),a(t,"maleFishPrefabsByStage",Te,i(t)),a(t,"femaleFishPrefabsByStage",Ce,i(t)),a(t,"tankButtons",xe,i(t)),a(t,"tombTankBtn",Le,i(t)),a(t,"tombTankNode",Be,i(t)),a(t,"signInPanel",Ne,i(t)),a(t,"temperatureLabel",Ee,i(t)),a(t,"waterQualityLabel",Fe,i(t)),a(t,"minComfortTemp",Pe,i(t)),a(t,"maxComfortTemp",Me,i(t)),a(t,"heaterBtn",Ie,i(t)),a(t,"fanBtn",ze,i(t)),a(t,"brushBtn",Se,i(t)),a(t,"heaterCountLabel",Oe,i(t)),a(t,"fanCountLabel",Ae,i(t)),a(t,"brushCountLabel",Ue,i(t)),a(t,"dirtyWaterOverlay",He,i(t)),a(t,"coldOverlay",_e,i(t)),a(t,"hotOverlay",Ve,i(t)),a(t,"confirmDialogPanel",Qe,i(t)),a(t,"confirmDialogText",We,i(t)),a(t,"confirmDialogYesButton",Ge,i(t)),a(t,"confirmDialogNoButton",Re,i(t)),a(t,"deathNoticePanel",Ye,i(t)),a(t,"deathNoticeLabel",je,i(t)),a(t,"deathNoticeCloseBtn",Je,i(t)),a(t,"tombHintPanel",Xe,i(t)),a(t,"tombHintCloseBtn",Ze,i(t)),a(t,"userNameLabel",qe,i(t)),a(t,"userIdLabel",Ke,i(t)),a(t,"userAvatar",$e,i(t)),a(t,"defaultAvatar",et,i(t)),a(t,"floatingNode",tt,i(t)),a(t,"backToMyTankBtn",nt,i(t)),a(t,"dragonboneLabel",rt,i(t)),a(t,"fishCountLabel",at,i(t)),t.confirmCallback=null,t.currentTankId=1,t.offDMChange=null,t.playerData=null,t.isViewingFriend=!1,t}n(t,e);var u=t.prototype;return u.start=function(){var e=o(s().mark((function e(){var t,n,r,a,i,o,u,l,c=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new URLSearchParams(window.location.search),r="1"===n.get("dev"),a=n.get("uid")||"DEV_LOCAL",e.prev=4,!r){e.next=16;break}return console.warn("[Game] 強制 DEV 模式"),C.useLocalStorage=!1,C.apiBase="http://localhost:3000",e.next=11,C.init(a);case 11:return e.next=13,C.getPlayerDataCached();case 13:this.playerData=e.sent,e.next=33;break;case 16:return e.next=18,F("2007937783-PJ4ZRBdY");case 18:return e.next=20,E();case 20:if(i=e.sent,o=i.idToken){e.next=24;break}throw new Error("取不到 idToken，請用 LINE App / LIFF URL 開啟");case 24:return e.next=26,P(o);case 26:return u=e.sent,l=u.lineUserId,e.next=30,C.init(l);case 30:return e.next=32,C.getPlayerDataCached();case 32:this.playerData=e.sent;case 33:e.next=39;break;case 35:return e.prev=35,e.t0=e.catch(4),console.error("[Game] 啟動失敗，錯誤：",e.t0),e.abrupt("return");case 39:if(this.playerData){e.next=42;break}return console.error("玩家資料讀取失敗"),e.abrupt("return");case 42:return e.next=44,this.processDailyUpdate();case 44:return this.initButtons(),this.initDialogs(),this.initPanels(),e.next=49,this.switchTank(1);case 49:return e.next=51,null==(t=this.tombManager)?void 0:t.init();case 51:return e.next=53,this.refreshEnvironmentUI();case 53:this.offDMChange=C.onChange((function(e){c.playerData=e,c.refreshEnvironmentUI()})),this.userNameLabel.string=this.playerData.displayName||"未命名",this.userIdLabel.string=this.playerData.userId||"",this.playerData.picture?this.loadAvatar(this.playerData.picture):this.userAvatar.spriteFrame=this.defaultAvatar;case 57:case"end":return e.stop()}}),e,this,[[4,35]])})));return function(){return e.apply(this,arguments)}}(),u.loadAvatar=function(){var e=o(s().mark((function e(t){var n,r,a,i,o,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{mode:"cors"});case 3:return n=e.sent,e.next=6,n.blob();case 6:return r=e.sent,e.next=9,createImageBitmap(r);case 9:a=e.sent,i=new w(a),(o=new D).image=i,(u=new f).texture=o,this.userAvatar.spriteFrame=u,e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),console.error("載入頭貼失敗",e.t0),this.userAvatar.spriteFrame=this.defaultAvatar;case 22:case"end":return e.stop()}}),e,this,[[0,18]])})));return function(t){return e.apply(this,arguments)}}(),u.initButtons=function(){var e,t,n,r,a=this;this.tankButtons.forEach((function(e,t){e.node.on(h.EventType.TOUCH_END,(function(){return a.switchTank(t+1)}))})),this.tombTankBtn.node.on(h.EventType.TOUCH_END,(function(){return a.switchToTombTank()})),null==(e=this.heaterBtn)||e.node.on(h.EventType.TOUCH_END,(function(){return a.onClickHeater()})),null==(t=this.fanBtn)||t.node.on(h.EventType.TOUCH_END,(function(){return a.onClickFan()})),null==(n=this.brushBtn)||n.node.on(h.EventType.TOUCH_END,(function(){return a.onClickBrush()})),null==(r=this.backToMyTankBtn)||r.node.on(h.EventType.TOUCH_END,(function(){return a.backToMyTank()}))},u.initDialogs=function(){var e,t,n=this;null==(e=this.confirmDialogYesButton)||e.on(h.EventType.TOUCH_END,(function(){if(n.confirmCallback){var e=n.confirmCallback;n.confirmCallback=null,n.confirmDialogPanel.active=!1,e()}else n.confirmDialogPanel.active=!1})),null==(t=this.confirmDialogNoButton)||t.on(h.EventType.TOUCH_END,(function(){n.confirmCallback=null,n.confirmDialogPanel.active=!1}))},u.initPanels=function(){var e=this;this.signInPanel&&(this.signInPanel.active=!0),this.deathNoticeCloseBtn.node.on(h.EventType.TOUCH_END,(function(){e.deathNoticePanel.active=!1,e.tombHintPanel.active=!0})),this.tombHintCloseBtn.node.on(h.EventType.TOUCH_END,(function(){e.tombHintPanel.active=!1})),this.backToMyTankBtn&&(this.backToMyTankBtn.node.active=!1)},u.getActiveViewport=function(){var e;return null!=(e=this.activeTankViewport)?e:this.node},u.renderTankView=function(e){var t=e.container,n=e.tank,a=e.fishList,i=e.malePrefabs,o=e.femalePrefabs,s=e.envForEmotion,u=e.readOnly,l=t.getChildByName("Background"),c=t.getChildByName("DecoLayer"),h=t.getChildByName("FishArea")||this.fishArea;if(l){var f=l.getComponent(d);if(f){var p=n.backgroundId&&ct.backgrounds.get(n.backgroundId)||this.defaultBackgroundSpriteFrame;p&&(f.spriteFrame=p)}}if(c){c.removeAllChildren();for(var b,m=r(null!=(v=n.decorations)?v:[]);!(b=m()).done;){var v,k,w,D,C,x,L=b.value,B=ct.decorations.get(L.id);if(B){var N=y(B);N.setPosition(null!=(k=L.x)?k:0,null!=(w=L.y)?w:0,0);var E=(L.flipX?-1:1)*(null!=(D=L.scale)?D:1),F=null!=(C=L.scale)?C:1;N.setScale(E,F,1),N.setRotationFromEuler(0,0,null!=(x=L.rotation)?x:0),"number"==typeof L.zIndex&&N.setSiblingIndex(L.zIndex),c.addChild(N)}}}h.removeAllChildren();var P=h.getComponent(g);if(P)for(var M,I=P.width,z=P.height,S=function(){var e=M.value,t=a.find((function(t){return t.id===e}));if(!t||t.isDead)return 0;var n=Math.max(0,(t.stage||1)-1),r="female"===t.gender?o[n]:i[n];if(!r)return 0;var l=y(r);l.name="Fish_"+t.id;var c=l.getComponent(T);null==c||c.setFishData(t,{readOnly:u,env:s});var f=Math.random()>.5?1:-1;l.setPosition(Math.random()*(I-100)-(I/2-50),Math.random()*(z-100)-(z/2-50),0),l.setScale(f,1,1),l.initialDirection=f,h.addChild(l)},O=r(null!=(A=n.fishIds)?A:[]);!(M=O()).done;){var A;S()}},u.switchTank=function(){var e=o(s().mark((function e(t){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isViewingFriend=!1,e.next=3,C.getPlayerDataCached();case 3:if(this.playerData=e.sent,r=null==(n=this.playerData)?void 0:n.tankList.find((function(e){return e.id===t}))){e.next=7;break}return e.abrupt("return");case 7:return this.activeTankViewport.active=!0,this.tombTankNode.active=!1,e.next=11,this.setHeaderUser(this.playerData.displayName,this.playerData.userId,this.playerData.picture);case 11:return this.backToMyTankBtn&&(this.backToMyTankBtn.node.active=!1),this.currentTankId=t,this.renderTankView({container:this.activeTankViewport,tank:r,fishList:this.playerData.fishList,malePrefabs:this.maleFishPrefabsByStage,femalePrefabs:this.femaleFishPrefabsByStage,envForEmotion:this.playerData.tankEnvironment,readOnly:!1}),e.next=16,this.refreshEnvironmentUI();case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),u.showFriendTank=function(e){var t;this.isViewingFriend=!0;var n=null==(t=e.tankList)?void 0:t[0];if(n){this.setHeaderUser(e.displayName||e.userId,e.userId,e.picture),this.backToMyTankBtn&&(this.backToMyTankBtn.node.active=!0);var r=this.getActiveViewport();this.renderTankView({container:r,tank:n,fishList:e.fishList,malePrefabs:this.maleFishPrefabsByStage,femalePrefabs:this.femaleFishPrefabsByStage,envForEmotion:e.tankEnvironment,readOnly:!0}),e.tankEnvironment&&(this.updateEnvironmentOverlays(e.tankEnvironment),this.temperatureLabel.string="水溫 : "+e.tankEnvironment.temperature.toFixed(1)+"°C",this.waterQualityLabel.string="水質 : "+("clean"===e.tankEnvironment.waterQualityStatus?"乾淨":"髒")),N(this.floatingNode,(e.displayName||e.userId)+" 的魚缸")}else N(this.floatingNode,"這位好友還沒有魚缸")},u.switchToTombTank=function(){var e=o(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.activeTankViewport.active=!1,this.tombTankNode.active=!0,e.next=4,null==(t=this.tombManager)?void 0:t.refreshTombs();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.backToMyTank=function(){var e=o(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.backToMyTankBtn&&(this.backToMyTankBtn.node.active=!1),e.next=3,this.switchTank(1);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.processDailyUpdate=function(){var e=o(s().mark((function e(){var t,n,a,i,o,u,l,c,h,f,p,b,m,d,y,g,v,k,w,D,T,L;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new Date,n=t.toISOString().split("T")[0],a=this.playerData.lastLoginDate||n,i=new Date(this.playerData.lastLoginTime||t),o=this.playerData.tankEnvironment,u=(t.getTime()-i.getTime())/36e5,l=Math.floor((Date.parse(n)-Date.parse(a))/864e5),c=100/72,h=2,f=[],null==o.badEnvLoginDays&&(o.badEnvLoginDays=0),p=r(this.playerData.fishList);case 12:if((b=p()).done){e.next=32;break}if(!(y=b.value).isDead){e.next=16;break}return e.abrupt("continue",30);case 16:if(g=null!=(m=y.hungerRateMultiplier)?m:1,v=null!=(d=y.status)&&d.sick?1.5:1,k=c*g*v,y.hunger+=u*k,y.hunger=Math.min(y.hunger,100),!(y.hunger>=100)){e.next=28;break}return y.isDead=!0,y.deathDate=n,y.emotion="dead",f.push(y.name),console.log(y.name+" 因飢餓過久而死亡"),e.abrupt("continue",30);case 28:l>0&&(y.growthDaysPassed+=l,x.tryStageUpgradeByGrowthDays(y)&&console.log(y.name+" 升級為第 "+y.stage+" 階！（自然長大）")),y.hunger>=80&&(y.emotion="hungry");case 30:e.next=12;break;case 32:return null==o.loginDaysSinceClean&&(o.loginDaysSinceClean=0),l>0&&(o.loginDaysSinceClean+=1),B.shouldUpdateTemperature(this.playerData)&&B.updateTemperature(this.playerData),B.checkWaterDirty(this.playerData),l>0&&(B.isEnvBad(this.playerData)?o.badEnvLoginDays+=1:o.badEnvLoginDays=0,o.badEnvLoginDays>=h&&(w=this.playerData.fishList.filter((function(e){return!e.isDead&&!e.status.sick}))).length>0&&(D=Math.floor(Math.random()*w.length),w[D].status.sick=!0,console.log("環境不良已持續 "+o.badEnvLoginDays+" 天，"+w[D].name+" 生病了"),o.badEnvLoginDays=0)),f.length>0&&(T=f.join("、"),L=T+"\n因為太餓，沒能撐下去...\n但牠的記憶還在某個地方等你",this.showDeathNotice(L)),this.playerData.lastLoginDate=n,this.playerData.lastLoginTime=t.toISOString(),e.next=42,C.savePlayerDataWithCache(this.playerData);case 42:return e.next=44,this.refreshEnvironmentUI();case 44:console.log("更新完成：經過 "+u.toFixed(2)+" 小時，飢餓與成長資料已更新");case 45:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.spawnFishInTank=function(){var e=o(s().mark((function e(t){var n,a,i,o,u,l,c,h=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.fishArea.removeAllChildren(),n=this.playerData.tankList.find((function(e){return e.id===t}))){e.next=5;break}return console.warn("找不到魚缸 "+t),e.abrupt("return");case 5:a=this.fishArea.getComponent(g),i=a.width,o=a.height,50,u=s().mark((function e(){var t,n,r,a,u,l,f,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.value,(n=h.playerData.fishList.find((function(e){return e.id===t})))&&!n.isDead){e.next=4;break}return e.abrupt("return",0);case 4:if(r="female"===n.gender?h.femaleFishPrefabsByStage[n.stage-1]:h.maleFishPrefabsByStage[n.stage-1]){e.next=7;break}return e.abrupt("return",0);case 7:(a=y(r)).name="Fish_"+n.id,u=Math.random()*(i-100)-(i/2-50),l=Math.random()*(o-100)-(o/2-50),f=Math.random()>.5?1:-1,a.setPosition(u,l,0),a.setScale(new v(f,1,1)),a.initialDirection=f,null==(p=a.getComponent(T))||p.setFishData(n),h.fishArea.addChild(a);case 18:case"end":return e.stop()}}),e)})),l=r(n.fishIds);case 11:if((c=l()).done){e.next=18;break}return e.delegateYield(u(),"t0",13);case 13:if(0!==e.t0){e.next=16;break}return e.abrupt("continue",16);case 16:e.next=11;break;case 18:this.currentTankId=t;case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),u.replaceFishNode=function(e){var t,n=this.fishArea.getChildByName("Fish_"+e.id);if(!n)return console.warn("找不到原魚節點 Fish_"+e.id),null;var r=n.getPosition(),a=null!=(t=n.initialDirection)?t:1;n.destroy();var i=e.stage-1,o="male"===e.gender?this.maleFishPrefabsByStage[i]:this.femaleFishPrefabsByStage[i];if(!o)return console.warn("找不到對應魚 prefab：stage="+e.stage+", gender="+e.gender),null;var s=y(o);s.name="Fish_"+e.id,s.setPosition(r),s.initialDirection=a,s.setScale(new v(a,1,1)),this.fishArea.addChild(s);var u=s.getComponent(T);return u&&(u.setFishData(e),null==u.onClickFish||u.onClickFish()),s},u.showDeathNotice=function(e){this.deathNoticeLabel.string=e,this.deathNoticePanel.active=!0},u.refreshEnvironmentUI=function(){var e=o(s().mark((function e(){var t,n,r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.playerData){e.next=2;break}return e.abrupt("return");case 2:t=this.playerData.tankEnvironment,n=this.playerData.inventory.items,this.temperatureLabel&&(this.temperatureLabel.string=t.temperature.toFixed(1)+"°C"),t.temperature<this.minComfortTemp?this.temperatureLabel.color=lt:t.temperature>this.maxComfortTemp?this.temperatureLabel.color=st:this.temperatureLabel.color=ut,this.waterQualityLabel&&(this.waterQualityLabel.string="clean"===t.waterQualityStatus?"Clean":"Dirty"),this.waterQualityLabel&&(this.waterQualityLabel.color="clean"===t.waterQualityStatus?ut:st),this.dirtyWaterOverlay&&(this.dirtyWaterOverlay.active="clean"!==t.waterQualityStatus),this.dragonboneLabel&&(this.dragonboneLabel.string=this.playerData.dragonBones.toString()),this.fishCountLabel&&(this.fishCountLabel.string=this.playerData.fishList.length.toString()),this.heaterCountLabel&&(this.heaterCountLabel.string=""+n.heater),this.fanCountLabel&&(this.fanCountLabel.string=""+n.fan),this.brushCountLabel&&(this.brushCountLabel.string=""+n.brush),r=t.temperature<this.minComfortTemp,a=t.temperature>this.maxComfortTemp,this.heaterBtn&&(this.heaterBtn.interactable=n.heater>0&&r),this.fanBtn&&(this.fanBtn.interactable=n.fan>0&&a),this.brushBtn&&(this.brushBtn.interactable=n.brush>0),this.updateEnvironmentOverlays(t);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.onDestroy=function(){var e=o(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.offDMChange)||t.call(this),this.offDMChange=null;case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.onClickHeater=function(){var e=o(s().mark((function e(){var t,n,r=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.playerData.inventory.items,n=this.playerData.tankEnvironment,!(t.heater<=0)){e.next=5;break}return N(this.floatingNode,"加熱器不足"),e.abrupt("return");case 5:if(!(n.temperature>=this.minComfortTemp&&n.temperature<=this.maxComfortTemp)){e.next=8;break}return N(this.floatingNode,"目前水溫正常，無需使用加熱器"),e.abrupt("return");case 8:if(!(n.temperature>this.maxComfortTemp)){e.next=11;break}return N(this.floatingNode,"目前為高溫狀態，請使用風扇"),e.abrupt("return");case 11:this.showConfirmDialog("確定要使用加熱器嗎？",(function(){return r.useHeater()}));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.useHeater=function(){var e=o(s().mark((function e(){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.playerData.inventory.items,n=this.playerData.tankEnvironment,!(t.heater<=0)){e.next=5;break}return N(this.floatingNode,"加熱器不足"),e.abrupt("return");case 5:if(!(n.temperature>=this.minComfortTemp)){e.next=8;break}return N(this.floatingNode,"目前水溫不低，不需使用加熱器"),e.abrupt("return");case 8:return t.heater-=1,B.adjustTemperature(this.playerData),e.next=12,C.savePlayerDataWithCache(this.playerData);case 12:return e.next=14,this.refreshEnvironmentUI();case 14:N(this.floatingNode,"已使用加熱器");case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.onClickFan=function(){var e=o(s().mark((function e(){var t,n,r=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.playerData.inventory.items,n=this.playerData.tankEnvironment,!(t.fan<=0)){e.next=5;break}return N(this.floatingNode,"風扇不足"),e.abrupt("return");case 5:if(!(n.temperature>=this.minComfortTemp&&n.temperature<=this.maxComfortTemp)){e.next=8;break}return N(this.floatingNode,"目前水溫正常，無需使用風扇"),e.abrupt("return");case 8:if(!(n.temperature<this.minComfortTemp)){e.next=11;break}return N(this.floatingNode,"目前為低溫狀態，請使用加熱器"),e.abrupt("return");case 11:this.showConfirmDialog("確定要使用風扇嗎？",(function(){return r.useFan()}));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.useFan=function(){var e=o(s().mark((function e(){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.playerData.inventory.items,n=this.playerData.tankEnvironment,!(t.fan<=0)){e.next=5;break}return N(this.floatingNode,"風扇不足"),e.abrupt("return");case 5:if(!(n.temperature<=this.maxComfortTemp)){e.next=8;break}return N(this.floatingNode,"目前水溫不高，不需使用風扇"),e.abrupt("return");case 8:return t.fan-=1,B.adjustTemperature(this.playerData),e.next=12,C.savePlayerDataWithCache(this.playerData);case 12:return e.next=14,this.refreshEnvironmentUI();case 14:N(this.floatingNode,"已使用風扇");case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.onClickBrush=function(){var e=o(s().mark((function e(){var t,n,r=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.playerData.inventory.items,n=this.playerData.tankEnvironment,!(t.brush<=0)){e.next=5;break}return N(this.floatingNode,"魚缸刷不足"),e.abrupt("return");case 5:if("clean"!==n.waterQualityStatus){e.next=8;break}return N(this.floatingNode,"目前魚缸很乾淨，無需使用魚缸刷"),e.abrupt("return");case 8:this.showConfirmDialog("確定要使用魚缸刷嗎？",(function(){return r.useBrush()}));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.useBrush=function(){var e=o(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=this.playerData.inventory.items).brush<=0)){e.next=4;break}return N(this.floatingNode,"魚缸刷不足"),e.abrupt("return");case 4:return t.brush-=1,B.cleanWater(this.playerData),e.next=8,C.savePlayerDataWithCache(this.playerData);case 8:return e.next=10,this.refreshEnvironmentUI();case 10:N(this.floatingNode,"已清潔魚缸");case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.updateEnvironmentOverlays=function(e){var t="clean"!==e.waterQualityStatus,n=e.temperature<this.minComfortTemp,r=e.temperature>this.maxComfortTemp;this.dirtyWaterOverlay&&(this.dirtyWaterOverlay.active=t),this.coldOverlay&&(this.coldOverlay.active=!t&&n),this.hotOverlay&&(this.hotOverlay.active=!t&&r)},u.showConfirmDialog=function(e,t){this.confirmDialogPanel&&this.confirmDialogText&&(this.confirmDialogText.string=e,this.confirmCallback=t,this.confirmDialogPanel.active=!0)},u.setHeaderUser=function(){var e=o(s().mark((function e(t,n,r){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.userNameLabel.string=t||"未命名",this.userIdLabel.string=n||"",!r){e.next=7;break}return e.next=5,this.loadAvatar(r);case 5:e.next=8;break;case 7:this.userAvatar.spriteFrame=this.defaultAvatar;case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t}(k)).prototype,"tombManager",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ke=t(ge.prototype,"activeTankViewport",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),we=t(ge.prototype,"fishArea",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),De=t(ge.prototype,"defaultBackgroundSpriteFrame",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Te=t(ge.prototype,"maleFishPrefabsByStage",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ce=t(ge.prototype,"femaleFishPrefabsByStage",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),xe=t(ge.prototype,"tankButtons",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Le=t(ge.prototype,"tombTankBtn",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Be=t(ge.prototype,"tombTankNode",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ne=t(ge.prototype,"signInPanel",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ee=t(ge.prototype,"temperatureLabel",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Fe=t(ge.prototype,"waterQualityLabel",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pe=t(ge.prototype,"minComfortTemp",[ot],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 18}}),Me=t(ge.prototype,"maxComfortTemp",[ot],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 23}}),Ie=t(ge.prototype,"heaterBtn",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ze=t(ge.prototype,"fanBtn",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Se=t(ge.prototype,"brushBtn",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Oe=t(ge.prototype,"heaterCountLabel",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ae=t(ge.prototype,"fanCountLabel",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ue=t(ge.prototype,"brushCountLabel",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),He=t(ge.prototype,"dirtyWaterOverlay",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_e=t(ge.prototype,"coldOverlay",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ve=t(ge.prototype,"hotOverlay",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qe=t(ge.prototype,"confirmDialogPanel",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),We=t(ge.prototype,"confirmDialogText",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ge=t(ge.prototype,"confirmDialogYesButton",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Re=t(ge.prototype,"confirmDialogNoButton",[re],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ye=t(ge.prototype,"deathNoticePanel",[ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),je=t(ge.prototype,"deathNoticeLabel",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Je=t(ge.prototype,"deathNoticeCloseBtn",[oe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xe=t(ge.prototype,"tombHintPanel",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ze=t(ge.prototype,"tombHintCloseBtn",[ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),qe=t(ge.prototype,"userNameLabel",[le],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ke=t(ge.prototype,"userIdLabel",[ce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$e=t(ge.prototype,"userAvatar",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),et=t(ge.prototype,"defaultAvatar",[fe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tt=t(ge.prototype,"floatingNode",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),nt=t(ge.prototype,"backToMyTankBtn",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rt=t(ge.prototype,"dragonboneLabel",[me],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),at=t(ge.prototype,"fishCountLabel",[de],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ye=ge))||ye));u._RF.pop()}}}));

System.register("chunks:///_virtual/ItemCard.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var i,n,t,r,o,a,l,u,c,s,p,b,y;return{setters:[function(e){i=e.applyDecoratedDescriptor,n=e.inheritsLoose,t=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,l=e.Sprite,u=e.Label,c=e.Button,s=e.Node,p=e.resources,b=e.SpriteFrame,y=e.Component}],execute:function(){var d,f,m,h,B,g,w,v,L,z,C,I,F;o._RF.push({},"964e4fd2+5E9YvHGIkCH3vw","ItemCard",void 0);var _=a.ccclass,k=a.property;e("ItemCard",(d=_("ItemCard"),f=k(l),m=k(u),h=k(u),B=k(c),g=k(s),d((L=i((v=function(e){function i(){for(var i,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return i=e.call.apply(e,[this].concat(o))||this,t(i,"icon",L,r(i)),t(i,"nameLabel",z,r(i)),t(i,"priceLabel",C,r(i)),t(i,"buyBtn",I,r(i)),t(i,"ownedBadge",F,r(i)),i.item=void 0,i.onBuy=function(){},i}n(i,e);var o=i.prototype;return o.init=function(e,i){var n,t,r=this;this.item=e,this.onBuy=i.onBuy,this.nameLabel&&(this.nameLabel.string=null!=(n=e.name)?n:""),this.priceLabel&&(this.priceLabel.string=null!=(t=i.priceText)?t:""),this.ownedBadge&&(this.ownedBadge.active=i.owned),this.buyBtn&&(this.buyBtn.interactable=!i.owned&&i.canBuy),e.iconKey&&this.icon&&p.load("icons/"+e.iconKey+"/spriteFrame",b,(function(e,i){!e&&i&&(r.icon.spriteFrame=i)}))},o.onClickBuy=function(){this.onBuy(this.item)},i}(y)).prototype,"icon",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=i(v.prototype,"nameLabel",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=i(v.prototype,"priceLabel",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=i(v.prototype,"buyBtn",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=i(v.prototype,"ownedBadge",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=v))||w));o._RF.pop()}}}));

System.register("chunks:///_virtual/LiffBridge.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,n,t,i;return{setters:[function(e){r=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){t=e.cclegacy,i=e.sys}],execute:function(){function f(){return(f=r(n().mark((function e(r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.isBrowser){e.next=2;break}return e.abrupt("return");case 2:if(void 0!==window.liff){e.next=4;break}throw new Error("LIFF SDK not loaded");case 4:return e.next=6,liff.init({liffId:r});case 6:liff.isLoggedIn()||liff.login();case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function o(){return(o=r(n().mark((function e(){var r,t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.isBrowser&&void 0!==window.liff){e.next=2;break}return e.abrupt("return",{idToken:null,profile:null});case 2:return e.next=4,liff.getProfile();case 4:return r=e.sent,t=liff.getIDToken(),e.abrupt("return",{idToken:t,profile:r});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e({getIdentity:function(){return o.apply(this,arguments)},initLiff:function(e){return f.apply(this,arguments)}}),t._RF.push({},"dcf75MsRwZLDZnYvsEwcanH","LiffBridge",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/MailboxPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts","./UIUtils.ts"],(function(e){var t,n,r,i,a,o,l,s,u,c,d,p,f,h,g,m,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.asyncToGenerator,i=e.regeneratorRuntime,a=e.initializerDefineProperty,o=e.assertThisInitialized,l=e.createForOfIteratorHelperLoose},function(e){s=e.cclegacy,u=e._decorator,c=e.Node,d=e.Prefab,p=e.instantiate,f=e.Label,h=e.Button,g=e.Component},function(e){m=e.DataManager},function(e){v=e.showFloatingTextCenter}],execute:function(){var b,y,C,w,R,x,N,P,k,F,L,I,B;s._RF.push({},"fed52Lhe5RFf4oUcYGkxMjL","MailboxPanel",void 0);var q=u.ccclass,M=u.property;e("MailboxPanel",(b=q("MailboxPanel"),y=M(c),C=M(d),w=M(d),R=M(c),x=M(c),b((k=t((P=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=e.call.apply(e,[this].concat(r))||this,a(t,"listContent",k,o(t)),a(t,"friendReqRowPrefab",F,o(t)),a(t,"genericRowPrefab",L,o(t)),a(t,"emptyStateNode",I,o(t)),a(t,"floatingNode",B,o(t)),t}n(t,e);var s=t.prototype;return s.onEnable=function(){this.refresh()},s.start=function(){this.refresh()},s.refresh=function(){var e=r(i().mark((function e(){var t,n,r,a,o,s,u,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.getInbox();case 3:if(t=e.sent,this.listContent.removeAllChildren(),n=t.filter((function(e){return"unread"===e.status})).length,this.node.emit("mailbox-refreshed",{unread:n}),(r=t.filter((function(e){return"unread"===e.status}))).length){e.next=13;break}return this.emptyStateNode&&(this.emptyStateNode.active=!0),e.abrupt("return");case 13:this.emptyStateNode&&(this.emptyStateNode.active=!1);case 14:for(a=l(r);!(o=a()).done;)"FRIEND_REQUEST"===(c=o.value).type&&null!=(s=c.payload)&&s.requestId&&null!=(u=c.payload)&&u.fromUserId?this.renderFriendRequestRow(c):this.renderGenericRow(c);e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),console.warn("[MailboxPanel] refresh failed:",e.t0),v(this.floatingNode,"載入信箱失敗");case 21:case"end":return e.stop()}}),e,this,[[0,17]])})));return function(){return e.apply(this,arguments)}}(),s.renderFriendRequestRow=function(e){var t,n,a,o,l=this,s=p(this.friendReqRowPrefab),u=null==(t=s.getChildByName("TitleLabel"))?void 0:t.getComponent(f),c=null==(n=s.getChildByName("DetailLabel"))?void 0:n.getComponent(f);if(u&&(u.string=e.title||"好友邀請"),c){var d,g,m=(null==(d=e.fromUser)?void 0:d.displayName)||"(未設定暱稱)";null==(g=e.payload)||g.fromUserId;c.string=m+" 想加你為好友"}var v=null==(a=s.getChildByName("AcceptBtn"))?void 0:a.getComponent(h),b=null==(o=s.getChildByName("DeclineBtn"))?void 0:o.getComponent(h);v&&v.node.on(h.EventType.CLICK,r(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.handleFriendRespond(e,"accept");case 2:case"end":return t.stop()}}),t)}))),this),b&&b.node.on(h.EventType.CLICK,r(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.handleFriendRespond(e,"decline");case 2:case"end":return t.stop()}}),t)}))),this),s.parent=this.listContent},s.renderGenericRow=function(e){var t,n,a,o=this,l=p(this.genericRowPrefab),s=null==(t=l.getChildByName("TitleLabel"))?void 0:t.getComponent(f),u=null==(n=l.getChildByName("DetailLabel"))?void 0:n.getComponent(f);s&&(s.string=e.title||"訊息"),u&&(u.string=e.body||"");var c=null==(a=l.getChildByName("AckBtn"))?void 0:a.getComponent(h);c&&c.node.on(h.EventType.CLICK,r(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m.markMailRead(e.mailId);case 3:o.refresh(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),v(o.floatingNode,"操作失敗");case 9:case"end":return t.stop()}}),t,null,[[0,6]])}))),this),l.parent=this.listContent},s.handleFriendRespond=function(){var e=r(i().mark((function e(t,n){var r,a,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.respondFriendRequest(t.payload.requestId,n);case 3:return"accept"===n&&v(this.floatingNode,"已成為好友！"),"decline"===n&&v(this.floatingNode,"已拒絕邀請"),e.prev=5,e.next=8,m.markMailRead(t.mailId);case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(5);case 12:return e.next=14,this.refresh();case 14:r=this.node.scene.getChildByName("FriendPanel"),null==(a=null==r?void 0:r.getComponent("FriendPanel"))||null==a.refreshList||a.refreshList(),e.next=24;break;case 19:e.prev=19,e.t1=e.catch(0),console.warn("respondFriendRequest failed:",e.t1),o=(null==e.t1?void 0:e.t1.code)||"",v(this.floatingNode,"request_not_found"===o?"邀請不存在或已處理":"not_request_participant"===o?"你沒有權限處理這個邀請":"操作失敗");case 24:case"end":return e.stop()}}),e,this,[[0,19],[5,10]])})));return function(t,n){return e.apply(this,arguments)}}(),t}(g)).prototype,"listContent",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(P.prototype,"friendReqRowPrefab",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(P.prototype,"genericRowPrefab",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(P.prototype,"emptyStateNode",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(P.prototype,"floatingNode",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=P))||N));s._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./ButtomPanelToggle.ts","./DataManager.ts","./ExpandMenu.ts","./FishAnimate.ts","./FishDetailManager.ts","./FishLogic.ts","./FriendPanel.ts","./GameManager.ts","./MailboxPanel.ts","./RenamePanel.ts","./RewardItem.ts","./RewardPopup.ts","./SwimmingFish.ts","./TankEnvironmentManager.ts","./TombManager.ts","./Api.ts","./LiffBridge.ts","./QuizData.ts","./QuizPanel.ts","./MonthlySignInManager.ts","./SignInPanel.ts","./WeeklySignInManager.ts","./CategoryTab.ts","./CircleBg.ts","./ItemCard.ts","./PurchaseModal.ts","./StoreState.ts","./StoreUI.ts","./Toast.ts","./mockCatalog.ts","./types.ts","./DevTest.ts","./UIUtils.ts","./utils.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/mockCatalog.ts",["cc"],(function(e){var c;return{setters:[function(e){c=e.cclegacy}],execute:function(){c._RF.push({},"0d7c0rymbNFRZEj9rv43AOK","mockCatalog",void 0);e("CATEGORIES",["全部","藥品","外觀","飼料","環境","裝飾"]),e("MOCK_CATALOG",[{id:"1",sku:"med_trans",name:"變性藥",type:"CONSUMABLE",category:"藥品",iconKey:"trans_medicine",priceSoft:{currency:"DRAGONBONE",amount:20}},{id:"2",sku:"med_change",name:"整形藥",type:"CONSUMABLE",category:"藥品",iconKey:"change",priceSoft:{currency:"DRAGONBONE",amount:100}},{id:"3",sku:"med_cold",name:"感冒藥",type:"CONSUMABLE",category:"藥品",iconKey:"cold_medicine",priceSoft:{currency:"DRAGONBONE",amount:5}},{id:"4",sku:"med_lvup",name:"升級藥",type:"CONSUMABLE",category:"藥品",iconKey:"lv_up",priceSoft:{currency:"DRAGONBONE",amount:50}},{id:"5",sku:"med_revive",name:"復活藥",type:"CONSUMABLE",category:"藥品",iconKey:"revive",priceSoft:{currency:"DRAGONBONE",amount:50}},{id:"6",sku:"feed_normal",name:"普通飼料",type:"CONSUMABLE",category:"飼料",iconKey:"normal_food",priceSoft:{currency:"DRAGONBONE",amount:1}},{id:"7",sku:"feed_high",name:"高級飼料",type:"CONSUMABLE",category:"飼料",iconKey:"high_level_food",priceSoft:{currency:"DRAGONBONE",amount:5}},{id:"8",sku:"env_brush",name:"魚缸刷",type:"CONSUMABLE",category:"環境",iconKey:"brush",priceSoft:{currency:"DRAGONBONE",amount:10}},{id:"9",sku:"env_fan",name:"風扇",type:"CONSUMABLE",category:"環境",iconKey:"fan",priceSoft:{currency:"DRAGONBONE",amount:10}},{id:"10",sku:"heater",name:"加熱棒",type:"CONSUMABLE",category:"環境",iconKey:"hot_bar",priceSoft:{currency:"DRAGONBONE",amount:10}}]);c._RF.pop()}}}));

System.register("chunks:///_virtual/MonthlySignInManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts","./RewardPopup.ts","./utils.ts"],(function(e){var t,n,a,r,i,o,l,u,s,p,c,m,h,d,y,g,f,b,S,w,F;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,a=e.initializerDefineProperty,r=e.assertThisInitialized,i=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){l=e.cclegacy,u=e._decorator,s=e.Node,p=e.Label,c=e.Button,m=e.Prefab,h=e.SpriteFrame,d=e.Component,y=e.UITransform,g=e.Vec3,f=e.tween,b=e.instantiate},function(e){S=e.DataManager},function(e){w=e.RewardPopup},function(e){F=e.getRandomItem}],execute:function(){var D,I,v,C,N,k,z,L,B,P,M,x,R,T,G,H,U,_,O,j,A,W,q,E,J,V,Y;l._RF.push({},"8f2972wm8JN0q4CufjSwzBR","MonthlySignInManager",void 0);var K=u.ccclass,Q=u.property;e("MonthlySignInManager",(D=K("MonthlySignInManager"),I=Q(s),v=Q(p),C=Q(c),N=Q(p),k=Q(m),z=Q(s),L=Q(h),B=Q(h),P=Q(h),M=Q(h),x=Q(h),R=Q(h),D((H=t((G=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i))||this,a(t,"daysGrid",H,r(t)),a(t,"monthlyCountLabel",U,r(t)),a(t,"claimButton",_,r(t)),a(t,"signInHintLabel",O,r(t)),a(t,"rewardPopupPrefab",j,r(t)),a(t,"flyingStampNode",A,r(t)),a(t,"normalFeedSpriteFrame",W,r(t)),a(t,"premiumFeedSpriteFrame",q,r(t)),a(t,"fanSpriteFrame",E,r(t)),a(t,"heaterSpriteFrame",J,r(t)),a(t,"brushSpriteFrame",V,r(t)),a(t,"defaultSpriteFrame",Y,r(t)),t.dayLabels=[],t.dayStampNodes=[],t.playerData=void 0,t}n(t,e);var l=t.prototype;return l.start=function(){var e=i(o().mark((function e(){var t,n,a,r,i,l,u,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(t=S.ready)?void 0:t.catch((function(){}));case 2:return e.next=4,S.getPlayerDataCached();case 4:if(this.playerData=e.sent,this.playerData&&this.playerData.signInData){e.next=8;break}return console.warn("[MonthlySignIn] 尚未取得玩家資料，停用本元件初始化"),e.abrupt("return");case 8:this.initDayNodes(),n=new Date,a=n.getMonth()+1,r=n.getFullYear(),i=n.toISOString().split("T")[0],(l=this.playerData.signInData.monthly).month===a&&l.year===r||(l.month=a,l.year=r,l.signedDaysCount=0,l.lastSignDate=""),this.updateSignInUI(),u=l.lastSignDate===i,s=l.signedDaysCount>=this.dayStampNodes.length,this.claimButton.interactable=!u&&!s,this.signInHintLabel.string=s?"本月已完成簽到":u?"今日已簽到":"點擊簽到",this.claimButton.node.on("click",this.onClaimButtonClick,this);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.initDayNodes=function(){this.dayLabels=[],this.dayStampNodes=[];for(var e=0;e<this.daysGrid.children.length;e++){var t=this.daysGrid.children[e],n=t.getChildByName("Status"),a=t.getChildByName("Stamp");if(n&&a){var r=n.getComponent(p);r&&(this.dayLabels.push(r),this.dayStampNodes.push(a))}}},l.updateSignInUI=function(){var e=this.playerData.signInData.monthly;this.monthlyCountLabel.string="本月累計簽到第 "+e.signedDaysCount+" 天";for(var t=0;t<this.dayLabels.length;t++){var n=this.dayLabels[t],a=this.dayStampNodes[t];n.string=""+(t+1),t<e.signedDaysCount?a.active=!0:a.active=!1}},l.addInventoryItem=function(e,t){var n=this.playerData.inventory;"normalFeed"===e?n.feeds.normal+=t:"premiumFeed"===e?n.feeds.premium+=t:e in n.items?n.items[e]+=t:console.warn("未知的物品 key: "+e)},l.onClaimButtonClick=function(){var e=i(o().mark((function e(){var t,n,a,r,i,l,u,s,p,c,m,h,d,D,I,v=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new Date,n=t.toISOString().split("T")[0],!((a=this.playerData.signInData.monthly).lastSignDate===n||a.signedDaysCount>=this.dayStampNodes.length)){e.next=5;break}return e.abrupt("return");case 5:if(!((r=a.signedDaysCount)>=this.dayStampNodes.length)){e.next=9;break}return console.warn("簽到格子數量不足"),e.abrupt("return");case 9:return i=this.dayStampNodes[r],a.signedDaysCount++,a.lastSignDate=n,l=t.getDay(),u=[],0===l||6===l?(s=F([{key:"premiumFeed",name:"高級飼料",count:1},{key:"fan",name:"風扇",count:1},{key:"heater",name:"加熱器",count:1},{key:"brush",name:"魚缸刷",count:1}]),this.addInventoryItem(s.key,s.count),u.push({icon:this.getIconSpriteFrame(s.key),name:s.name,count:s.count})):(this.addInventoryItem("normalFeed",1),u.push({icon:this.getIconSpriteFrame("normalFeed"),name:"普通飼料",count:1})),u.forEach((function(e){console.log("月簽到獎勵："+e.name+" x"+e.count)})),e.next=18,S.savePlayerDataWithCache(this.playerData);case 18:this.claimButton.interactable=!1,this.signInHintLabel.string="今日已簽到",p=i.getComponent(y).getBoundingBoxToWorld(),c=new g(p.x+p.width/2,p.y+p.height/2,0),m=this.flyingStampNode.parent.getComponent(y),h=m.convertToNodeSpaceAR(c),d=p.width/this.flyingStampNode.getComponent(y).width,D=p.height/this.flyingStampNode.getComponent(y).height,I=new g(d,D,1),this.flyingStampNode.active=!0,this.flyingStampNode.setScale(new g(3,3,1)),this.flyingStampNode.setPosition(new g(0,0,0)),f(this.flyingStampNode).to(1,{position:h,scale:I},{easing:"backOut"}).call((function(){v.updateSignInUI()})).delay(1).call((function(){var e=b(v.rewardPopupPrefab);e.getComponent(w).showRewards(u),v.node.getComponent(y).node.parent.addChild(e)})).start();case 31:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.getIconSpriteFrame=function(e){switch(e){case"normalFeed":return this.normalFeedSpriteFrame;case"premiumFeed":return this.premiumFeedSpriteFrame;case"fan":return this.fanSpriteFrame;case"heater":return this.heaterSpriteFrame;case"brush":return this.brushSpriteFrame;default:return this.defaultSpriteFrame}},t}(d)).prototype,"daysGrid",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(G.prototype,"monthlyCountLabel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(G.prototype,"claimButton",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(G.prototype,"signInHintLabel",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(G.prototype,"rewardPopupPrefab",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(G.prototype,"flyingStampNode",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(G.prototype,"normalFeedSpriteFrame",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(G.prototype,"premiumFeedSpriteFrame",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(G.prototype,"fanSpriteFrame",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(G.prototype,"heaterSpriteFrame",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(G.prototype,"brushSpriteFrame",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(G.prototype,"defaultSpriteFrame",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=G))||T));l._RF.pop()}}}));

System.register("chunks:///_virtual/PurchaseModal.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,n,r,a,l,o,s,u,c,h,f,p,b,m,y,d,g,B,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){a=t.cclegacy,l=t._decorator,o=t.Node,s=t.Sprite,u=t.Label,c=t.Button,h=t.resources,f=t.SpriteFrame,p=t.Widget,b=t.UITransform,m=t.Size,y=t.UIOpacity,d=t.tween,g=t.easing,B=t.v3,v=t.Component}],execute:function(){var L,w,C,q,M,z,S,A,x,O,P,k,N,R,D,E,F,I,U,T,_,G,K,W,j,H,V,X,J,Q,Y;a._RF.push({},"b4398mfrPhCVrFSe/Dkh1Xb","PurchaseModal",void 0);var Z=l.ccclass,$=l.property;t("PurchaseModal",(L=Z("PurchaseModal"),w=$(o),C=$(s),q=$(u),M=$(u),z=$(u),S=$(u),A=$(u),x=$(c),O=$(c),P=$(c),k=$(c),N=$(c),R=$(c),D=$(c),L((I=e((F=function(t){function e(){for(var e,i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e=t.call.apply(t,[this].concat(a))||this,n(e,"panel",I,r(e)),n(e,"icon",U,r(e)),n(e,"nameLabel",T,r(e)),n(e,"ownedLabel",_,r(e)),n(e,"qtyLabel",G,r(e)),n(e,"haveLabel",K,r(e)),n(e,"needLabel",W,r(e)),n(e,"minBtn",j,r(e)),n(e,"minusBtn",H,r(e)),n(e,"plusBtn",V,r(e)),n(e,"maxBtn",X,r(e)),n(e,"confirmBtn",J,r(e)),n(e,"cancelBtn",Q,r(e)),n(e,"closeBtn",Y,r(e)),e.state=void 0,e.item=void 0,e.qty=1,e.onConfirm=null,e}i(e,t);var a=e.prototype;return a.open=function(t,e,i){var n,r,a=this;this.state=t,this.item=e,this.onConfirm=i,this.nameLabel&&(this.nameLabel.string=null!=(n=e.name)?n:"");var l="CONSUMABLE"===e.type?t.getCount(e.sku):t.isOwned(e.sku)?1:0;this.ownedLabel&&(this.ownedLabel.string="持有數量 "+l),this.icon&&e.iconKey&&h.load("icons/"+e.iconKey+"/spriteFrame",f,(function(t,e){if(!t&&e){a.icon.spriteFrame=e,a.icon.type=s.Type.SIMPLE,a.icon.sizeMode=s.SizeMode.RAW;var i=a.icon.getComponent(p);i&&(i.isAlignLeft=i.isAlignRight=!1,i.isAlignTop=i.isAlignBottom=!1);var n=a.icon.getComponent(b),r=e.getRect().width,l=e.getRect().height,o=Math.min(120/r,120/l,1);n.setContentSize(new m(Math.round(r*o),Math.round(l*o)))}})),this.qty=1,this.refresh();var o=null!=(r=this.panel.getComponent(y))?r:this.panel.addComponent(y);o.opacity=0,this.panel.setScale(.95,.95,1),this.node.active=!0,d(o).to(.14,{opacity:255},{easing:g.quadOut}).start(),d(this.panel).to(.14,{scale:B(1,1,1)},{easing:g.quadOut}).start()},a.unitPrice=function(){var t,e;return null!=(t=null==(e=this.item.priceSoft)?void 0:e.amount)?t:0},a.maxAffordable=function(){if("CONSUMABLE"!==this.item.type)return 1;var t=Math.max(1,this.unitPrice()),e=this.state.wallet.DRAGONBONE;return Math.max(0,Math.min(999,Math.floor(e/t)))},a.refresh=function(){var t=this.state.wallet.DRAGONBONE,e=this.unitPrice()*this.qty;this.qtyLabel&&(this.qtyLabel.string=String(this.qty)),this.haveLabel&&(this.haveLabel.string=t.toString()),this.needLabel&&(this.needLabel.string=e.toString());var i="CONSUMABLE"!==this.item.type&&this.state.isOwned(this.item.sku),n=this.maxAffordable()||1;this.minBtn&&(this.minBtn.interactable=this.qty>1),this.minusBtn&&(this.minusBtn.interactable=this.qty>1),this.plusBtn&&(this.plusBtn.interactable=this.qty<n),this.maxBtn&&(this.maxBtn.interactable=this.qty<n);var r=!i&&t>=e&&this.qty>=1;this.confirmBtn&&(this.confirmBtn.interactable=r)},a.onMin=function(){this.qty=1,this.refresh()},a.onDec=function(){this.qty>1&&(this.qty--,this.refresh())},a.onInc=function(){var t=this.maxAffordable()||1;this.qty<t&&(this.qty++,this.refresh())},a.onMax=function(){var t=this.maxAffordable()||1;this.qty=Math.max(1,t),this.refresh()},a.onClickConfirm=function(){var t;null==(t=this.onConfirm)||t.call(this,this.qty),this.hide()},a.onClickCancel=function(){this.hide()},a.onClickClose=function(){this.hide()},a.onClickBackdrop=function(){this.hide()},a.hide=function(){var t,e=this,i=null!=(t=this.panel.getComponent(y))?t:this.panel.addComponent(y);d(i).to(.1,{opacity:0}).start(),d(this.panel).to(.1,{scale:B(.96,.96,1)}).call((function(){e.node.active=!1})).start()},e}(v)).prototype,"panel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(F.prototype,"icon",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(F.prototype,"nameLabel",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(F.prototype,"ownedLabel",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(F.prototype,"qtyLabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(F.prototype,"haveLabel",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(F.prototype,"needLabel",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(F.prototype,"minBtn",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(F.prototype,"minusBtn",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(F.prototype,"plusBtn",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=e(F.prototype,"maxBtn",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(F.prototype,"confirmBtn",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=e(F.prototype,"cancelBtn",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=e(F.prototype,"closeBtn",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=F))||E));a._RF.pop()}}}));

System.register("chunks:///_virtual/QuizData.ts",["cc"],(function(n){var e;return{setters:[function(n){e=n.cclegacy}],execute:function(){e._RF.push({},"95eccu4GlZFCYdCTI3L8OmB","QuizData",void 0);n("quizQuestions",[{question:"以下在地球上存在時間最久的是?",options:["鱘龍魚","鴨嘴獸","水杉"],answerIndex:0},{question:"鱘龍魚須要養多久算是成魚?",options:["800天以上","100以上","一年以上"],answerIndex:0},{question:"鱘龍魚的 Omega-3 脂肪酸含量大約是其他常見淡水魚類的幾倍?",options:["4-5倍","差不多","8倍以上"],answerIndex:0},{question:"最大的鱘龍魚體長可達?",options:["七公尺","三公尺","五公尺"],answerIndex:0},{question:"鱘龍魚的中骨脊髓中，天然富含下列哪一種營養素?",options:["膠原蛋白","鈣質","維生素C"],answerIndex:0},{question:"目前已知世界上有幾種鱘龍魚?",options:["28種","10種","18種"],answerIndex:0},{question:"目前歷史記錄中，鱘龍魚最長壽可達幾歲？",options:["超過100歲","40歲","70歲"],answerIndex:0},{question:"目前歷史紀錄中，最重的鱘龍魚體重可達?",options:["1500公斤","500公斤","1000公斤"],answerIndex:0},{question:"鱘龍魚的鼻孔主要用來?",options:["感知嗅覺訊號","呼吸","排水"],answerIndex:0},{question:"下列哪個國家是西伯利亞鱘最大的人工養殖輸出國?",options:["中國","俄羅斯","伊朗"],answerIndex:0},{question:"下列哪種烹調方式可保留最多 Omega-3?",options:["清蒸","高溫油炸","低溫烘烤"],answerIndex:0},{question:"哪一種鱘龍魚的魚子醬被譽為全球最昂貴?",options:["白鱘（Beluga）","西伯利亞鱘","中華鱘"],answerIndex:0},{question:"西伯利亞鱘主要棲息在哪類型水域?",options:["淡水河流","高鹽度海洋","淡鹹交界的紅樹林"],answerIndex:0},{question:"大多數鱘龍魚屬於什麼生活型態?",options:["溯河洄游魚","定居魚","潮間帶短暫魚"],answerIndex:0},{question:"下列哪個因素對鱘龍魚族群數量影響最大?",options:["水壩阻斷洄游通道","氣溫升高3度","捕食者變多"],answerIndex:0},{question:"鱘龍魚喜歡什麼樣的底層環境?",options:["沙質或泥質河床","珊瑚礁群落","龍舌蘭水草繁茂區"],answerIndex:0},{question:"在人工養殖條件下，西伯利亞鱘最適水溫範圍為?",options:["15～20°C ","5～10°C","25～30°C"],answerIndex:0},{question:"鱘龍魚在野外多在哪些洲出現?",options:["歐亞與北美","亞洲與非洲","南美與澳洲"],answerIndex:0}]);e._RF.pop()}}}));

System.register("chunks:///_virtual/QuizPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./utils.ts"],(function(e){var n,t,o,r,i,c,a,s,l,u,p,f,d,h,v,b;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){i=e.cclegacy,c=e._decorator,a=e.Label,s=e.Button,l=e.SpriteFrame,u=e.Sprite,p=e.Color,f=e.tween,d=e.Vec3,h=e.Node,v=e.Component},function(e){b=e.shuffleArray}],execute:function(){var w,m,g,y,E,C,S,I,z,F,A;i._RF.push({},"7c2cdvU+QlDcIa5MfAPFQc5","QuizPanel",void 0);var B=c.ccclass,L=c.property;e("QuizPanel",(w=B("QuizPanel"),m=L(a),g=L([s]),y=L(l),E=L(l),w((I=n((S=function(e){function n(){for(var n,t=arguments.length,i=new Array(t),c=0;c<t;c++)i[c]=arguments[c];return n=e.call.apply(e,[this].concat(i))||this,o(n,"questionLabel",I,r(n)),o(n,"optionButtons",z,r(n)),o(n,"correctIconSpriteFrame",F,r(n)),o(n,"wrongIconSpriteFrame",A,r(n)),n.resolveAnswer=void 0,n.correctIndex=0,n.isCorrect=!1,n}t(n,e);var i=n.prototype;return i.setup=function(e){var n=this;this.questionLabel.string=e.question;var t=b([].concat(e.options.slice(0,3)));this.correctIndex=t.indexOf(e.options[e.answerIndex]);for(var o=["A. ","B. ","C. "],r=function(e){var r=n.optionButtons[e],i=r.getComponentInChildren(a);e<3?(r.node.active=!0,i.string=o[e]+t[e],r.interactable=!0,r.node.off(h.EventType.MOUSE_ENTER),r.node.off(h.EventType.MOUSE_LEAVE),r.node.off("click"),r.node.on(h.EventType.MOUSE_ENTER,(function(){r.interactable&&(r.node.getComponent(u).color=new p(213,239,255))})),r.node.on(h.EventType.MOUSE_LEAVE,(function(){r.interactable&&(r.node.getComponent(u).color=new p(226,244,255))})),r.node.once("click",(function(){return n.onSelect(e)}))):r.node.active=!1},i=0;i<this.optionButtons.length;i++)r(i);return new Promise((function(e){n.resolveAnswer=e}))},i.onSelect=function(e){var n=this;this.isCorrect=e===this.correctIndex;var t=this.optionButtons[e];if(t.node.getComponent(u).color=this.isCorrect?new p(102,204,154):new p(255,50,51),this.isCorrect)f(t.node).to(.1,{scale:new d(1.05,1.05,1)}).to(.1,{scale:new d(1,1,1)}).start();else{for(var o=t.node.position.clone(),r=f(t.node),i=0;i<3;i++)r=r.to(.05,{position:new d(o.x+(i%2==0?10:-10),o.y,o.z)}).to(.05,{position:o});r.start()}var c=t.getComponentsInChildren(u).find((function(e){return e.node!==t.node}));c&&(c.spriteFrame=this.isCorrect?this.correctIconSpriteFrame:this.wrongIconSpriteFrame,c.node.active=!0),this.optionButtons.forEach((function(e){return e.interactable=!1})),this.scheduleOnce((function(){n.resolveAnswer(n.isCorrect),n.node.destroy()}),1.5)},n}(v)).prototype,"questionLabel",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=n(S.prototype,"optionButtons",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=n(S.prototype,"correctIconSpriteFrame",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=n(S.prototype,"wrongIconSpriteFrame",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=S))||C));i._RF.pop()}}}));

System.register("chunks:///_virtual/RenamePanel.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t,i,r,a,o,l,s,c;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,l=e.Node,s=e.EditBox,c=e.Component}],execute:function(){var u,p,f,h,m,d,g;a._RF.push({},"a1028v47H5K07nzlDR15RQK","RenamePanel",void 0);var y=o.ccclass,v=o.property;e("RenamePanel",(u=y("RenamePanel"),p=v(l),f=v(s),u((d=n((m=function(e){function n(){for(var n,t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return n=e.call.apply(e,[this].concat(a))||this,i(n,"panel",d,r(n)),i(n,"input",g,r(n)),n.fishId=-1,n}t(n,e);var a=n.prototype;return a.show=function(e){e&&(this.fishId=e.id,this.input.string=e.name,this.panel.active=!0)},a.hide=function(){this.panel.active=!1},a.renameFish=function(e,n){return!(!n||n.length>12)&&(e.name=n,!0)},a.confirmRename=function(){var e=this,n=this.input.string.trim();if(n){var t=JSON.parse(localStorage.getItem("playerData")),i=t.fishList.find((function(n){return n.id===e.fishId}));if(i)this.renameFish(i,n)?(localStorage.setItem("playerData",JSON.stringify(t)),this.hide()):console.warn("名字無效")}else console.warn("名字不能為空！")},n}(c)).prototype,"panel",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=n(m.prototype,"input",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=m))||h));a._RF.pop()}}}));

System.register("chunks:///_virtual/RewardItem.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,r,i,n,a,l,o,c,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,i=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){a=e.cclegacy,l=e._decorator,o=e.Sprite,c=e.Label,u=e.Component}],execute:function(){var p,s,b,m,f,y,d,g,h;a._RF.push({},"5933cdguJ5I4LXe+Iv+wspf","RewardItem",void 0);var L=l.ccclass,w=l.property;e("RewardItem",(p=L("RewardItem"),s=w(o),b=w(c),m=w(c),p((d=t((y=function(e){function t(){for(var t,r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return t=e.call.apply(e,[this].concat(a))||this,i(t,"itemSprite",d,n(t)),i(t,"nameLabel",g,n(t)),i(t,"countLabel",h,n(t)),t}return r(t,e),t.prototype.init=function(e,t,r){this.itemSprite.spriteFrame=e,this.nameLabel.string=t,this.countLabel.string="x"+r},t}(u)).prototype,"itemSprite",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=t(y.prototype,"nameLabel",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=t(y.prototype,"countLabel",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=y))||f));a._RF.pop()}}}));

System.register("chunks:///_virtual/RewardPopup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RewardItem.ts"],(function(e){var t,r,i,a,n,o,c,l,f,u,s,p,d,h,g;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,i=e.createForOfIteratorHelperLoose,a=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){o=e.cclegacy,c=e._decorator,l=e.Node,f=e.Prefab,u=e.instantiate,s=e.Vec3,p=e.UIOpacity,d=e.tween,h=e.Component},function(e){g=e.RewardItem}],execute:function(){var b,w,y,m,C,R,L,v,P,I,W,z,E;o._RF.push({},"bfdf9YEfL9KSqEJa2k66Zxa","RewardPopup",void 0);var F=c.ccclass,A=c.property;e("RewardPopup",(b=F("RewardPopup"),w=A(l),y=A(f),m=A(l),C=A(l),R=A(l),b((P=t((v=function(e){function t(){for(var t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i))||this,a(t,"rewardGrid",P,n(t)),a(t,"rewardItemPrefab",I,n(t)),a(t,"effectLightBase",W,n(t)),a(t,"effectLightRotateCW",z,n(t)),a(t,"effectLightRotateCCW",E,n(t)),t}r(t,e);var o=t.prototype;return o.showRewards=function(e){this.rewardGrid.removeAllChildren();for(var t,r=i(e);!(t=r()).done;){var a=t.value,n=u(this.rewardItemPrefab);n.getComponent(g).init(a.icon,a.name,a.count),this.rewardGrid.addChild(n)}this.playEnterAnimation(),this.playEffectLight()},o.playEnterAnimation=function(){this.node.scale=new s(.5,.5,1);var e=this.node.getComponent(p);e&&(e.opacity=0,d(e).to(.6,{opacity:255},{easing:"quadOut"}).start()),d(this.node).to(.6,{scale:new s(1,1,1)},{easing:"backOut"}).start()},o.playEffectLight=function(){this.effectLightRotateCW&&d(this.effectLightRotateCW).by(5,{angle:360}).repeatForever().start(),this.effectLightRotateCCW&&d(this.effectLightRotateCCW).by(5,{angle:-360}).repeatForever().start()},o.onConfirm=function(){this.node.destroy()},t}(h)).prototype,"rewardGrid",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(v.prototype,"rewardItemPrefab",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(v.prototype,"effectLightBase",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(v.prototype,"effectLightRotateCW",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(v.prototype,"effectLightRotateCCW",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=v))||L));o._RF.pop()}}}));

System.register("chunks:///_virtual/SignInPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts"],(function(e){var n,t,o,i,a,r,l,s,c,u,h,p,y,f;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized,a=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){l=e.cclegacy,s=e._decorator,c=e.Node,u=e.Button,h=e.Sprite,p=e.Color,y=e.Component},function(e){f=e.DataManager}],execute:function(){var w,v,d,g,b,m,k,P,T,S,I,B,D;l._RF.push({},"41118NYzBlDtoozrSfsrMdm","SignInPanel",void 0);var C=s.ccclass,z=s.property;e("SignInPanel",(w=C("SignInPanel"),v=z(c),d=z(c),g=z(u),b=z(u),m=z(u),w((T=n((P=function(e){function n(){for(var n,t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=e.call.apply(e,[this].concat(a))||this,o(n,"weeklyPanel",T,i(n)),o(n,"monthlyPanel",S,i(n)),o(n,"weeklyTabBtn",I,i(n)),o(n,"monthlyTabBtn",B,i(n)),o(n,"closeBtn",D,i(n)),n}t(n,e);var l=n.prototype;return l.start=function(){var e=a(r().mark((function e(){var n,t,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(n=this.weeklyTabBtn)||n.node.on(u.EventType.CLICK,this.showWeekly,this),null==(t=this.monthlyTabBtn)||t.node.on(u.EventType.CLICK,this.showMonthly,this),null==(o=this.closeBtn)||o.node.on(u.EventType.CLICK,this.closePanel,this),this.showWeekly(),e.next=6,this.checkIfShouldShow();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.checkIfShouldShow=function(){var e=a(r().mark((function e(){var n,t,o,i,a,l,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(n=f.ready)?void 0:n.catch((function(){}));case 2:return e.next=4,f.getPlayerDataCached();case 4:if((i=e.sent)&&i.signInData){e.next=9;break}return console.warn("[簽到面板] 尚未取得玩家資料，先隱藏面板"),this.node.active=!1,e.abrupt("return");case 9:a=(new Date).toISOString().split("T")[0],l=(null==(t=i.signInData.weekly)?void 0:t.lastSignDate)===a,s=(null==(o=i.signInData.monthly)?void 0:o.lastSignDate)===a,l?s?(this.node.active=!1,console.log("[簽到面板] 週與月皆已簽到 -> 關閉面板")):(this.node.active=!0,this.showMonthly(),console.log("[簽到面板] 今日週已簽到但月未簽到 -> 自動切到月簽到")):(this.node.active=!0,this.showWeekly(),console.log("[簽到面板] 今日週尚未簽到 -> 顯示週簽到"));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.showWeekly=function(){this.weeklyPanel.active=!0,this.monthlyPanel.active=!1,this.updateTabVisual()},l.showMonthly=function(){this.weeklyPanel.active=!1,this.monthlyPanel.active=!0,this.updateTabVisual()},l.updateTabVisual=function(){var e=this.weeklyTabBtn.node.getComponent(h),n=this.monthlyTabBtn.node.getComponent(h);e&&n&&(e.color=this.weeklyPanel.active?new p(255,255,255):new p(180,180,180),n.color=this.monthlyPanel.active?new p(255,255,255):new p(180,180,180))},l.closePanel=function(){this.node.active=!1},l.openPanel=function(){this.node.active=!0,this.showWeekly(),console.log("[簽到面板] 手動開啟")},l.onWeeklySignInDone=function(){var e=a(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.showMonthly(),console.log("[簽到面板] 週簽到完成 -> 自動切換到月簽到")}catch(e){console.warn("[簽到面板] 週簽到完成後切換月簽到失敗：",e)}case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n}(y)).prototype,"weeklyPanel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=n(P.prototype,"monthlyPanel",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=n(P.prototype,"weeklyTabBtn",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=n(P.prototype,"monthlyTabBtn",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=n(P.prototype,"closeBtn",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=P))||k));l._RF.pop()}}}));

System.register("chunks:///_virtual/StoreState.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts"],(function(e){var t,n,r,a,i;return{setters:[function(e){t=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){r=e.cclegacy,a=e.EventTarget},function(e){i=e.DataManager}],execute:function(){r._RF.push({},"3f6d8uH5ehPQLCO+fr44WzD","StoreState",void 0);e("StoreState",function(){function e(){var e=this;this.events=new a,this.wallet={DRAGONBONE:1200},this.owned=new Set,this.inventory=new Map,this.currentCategory="全部",this.catalog=[],i.onChange((function(t){return e.hydrateFromPlayer(t)})),i.getPlayerDataCached().then((function(t){return t&&e.hydrateFromPlayer(t)}))}var r=e.prototype;return r.hydrateFromPlayer=function(e){var t,n,r,a,i,o,u,s,c,l,h,v,f,d,p,m,y,g,k,w,b,_,x;this.wallet.DRAGONBONE=null!=(t=e.dragonBones)?t:0,this.events.emit("wallet:change"),this.owned=new Set(null!=(n=null==(r=e.fashion)?void 0:r.owned)?n:[]),this.events.emit("owned:change"),this.inventory.clear();var O=e.inventory||{feeds:{normal:0,premium:0},items:{}};this.inventory.set("feed_normal",null!=(a=null==(i=O.feeds)?void 0:i.normal)?a:0),this.inventory.set("feed_high",null!=(o=null==(u=O.feeds)?void 0:u.premium)?o:0),this.inventory.set("med_trans",null!=(s=null==(c=O.items)?void 0:c.genderPotion)?s:0),this.inventory.set("med_change",null!=(l=null==(h=O.items)?void 0:h.changePotion)?l:0),this.inventory.set("med_cold",null!=(v=null==(f=O.items)?void 0:f.coldMedicine)?v:0),this.inventory.set("med_lvup",null!=(d=null==(p=O.items)?void 0:p.upgradePotion)?d:0),this.inventory.set("med_revive",null!=(m=null==(y=O.items)?void 0:y.revivePotion)?m:0),this.inventory.set("env_brush",null!=(g=null==(k=O.items)?void 0:k.brush)?g:0),this.inventory.set("env_fan",null!=(w=null==(b=O.items)?void 0:b.fan)?w:0),this.inventory.set("heater",null!=(_=null==(x=O.items)?void 0:x.heater)?_:0),this.events.emit("inventory:change")},r.setCatalog=function(e){this.catalog=e.slice(),this.events.emit("catalog:change")},r.setCategory=function(e){this.currentCategory=e,this.events.emit("category:change")},r.canAfford=function(e){var t=e.priceSoft;return!!t&&this.wallet[t.currency]>=t.amount},r.isOwned=function(e){return this.owned.has(e)},r.getCount=function(e){var t;return null!=(t=this.inventory.get(e))?t:0},r.canAffordQty=function(e,t){var n=e.priceSoft;return!!n&&this.wallet[n.currency]>=n.amount*Math.max(1,t)},r.purchaseMany=function(){var e=t(n().mark((function e(t,r){var a,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Math.max(1,Math.floor(r)),"CONSUMABLE"===t.type){e.next=3;break}return e.abrupt("return",this.purchase(t));case 3:if(a=t.priceSoft){e.next=6;break}return e.abrupt("return",{ok:!1,reason:"NO_PRICE"});case 6:return e.next=8,i.purchase(t.sku,r,a.amount);case 8:if((o=e.sent).ok){e.next=11;break}return e.abrupt("return",{ok:!1,reason:o.error||"FAILED"});case 11:return e.abrupt("return",{ok:!0});case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),r.purchase=function(){var e=t(n().mark((function e(t){var r,a,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.priceSoft){e.next=3;break}return e.abrupt("return",{ok:!1,reason:"NO_PRICE"});case 3:if("NON_CONSUMABLE"!==t.type||!this.isOwned(t.sku)){e.next=5;break}return e.abrupt("return",{ok:!1,reason:"ALREADY_OWNED"});case 5:return e.next=7,i.purchase(t.sku,1,r.amount);case 7:if((a=e.sent).ok){e.next=11;break}return o="NOT_ENOUGH"===a.error?"NOT_ENOUGH":"FAILED",e.abrupt("return",{ok:!1,reason:o});case 11:return e.abrupt("return",{ok:!0});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.resetDemo=function(){var e=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.getPlayerDataCached({refresh:!0});case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:return t.dragonBones=1200,e.next=8,i.savePlayerDataWithCache(t);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}());r._RF.pop()}}}));

System.register("chunks:///_virtual/StoreUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./StoreState.ts","./mockCatalog.ts","./ItemCard.ts","./CategoryTab.ts","./PurchaseModal.ts","./Toast.ts"],(function(t){var e,n,r,a,o,i,s,l,u,c,f,p,h,g,y,b,m,d,C,v,T,w,S,I,O,B;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,r=t.createForOfIteratorHelperLoose,a=t.asyncToGenerator,o=t.regeneratorRuntime,i=t.initializerDefineProperty,s=t.assertThisInitialized},function(t){l=t.cclegacy,u=t._decorator,c=t.Node,f=t.Label,p=t.Prefab,h=t.ScrollView,g=t.Sprite,y=t.Color,b=t.instantiate,m=t.UIOpacity,d=t.tween,C=t.Component},function(t){v=t.StoreState},function(t){T=t.MOCK_CATALOG,w=t.CATEGORIES},function(t){S=t.ItemCard},function(t){I=t.CategoryTab},function(t){O=t.PurchaseModal},function(t){B=t.Toast}],execute:function(){var P,E,A,L,z,N,U,x,D,_,M,k,R,H,W,G,V,F,j,J,K;l._RF.push({},"16182Tt8BtOJJPVO5+AIjrx","StoreUI",void 0);var Y=u.ccclass,q=u.property;t("StoreUI",(P=Y("StoreUI"),E=q([c]),A=q(f),L=q(c),z=q(p),N=q(h),U=q(c),x=q(p),D=q(O),_=q(B),P((R=e((k=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,i(e,"categoryButtons",R,s(e)),i(e,"boneLabel",H,s(e)),i(e,"categoryTabs",W,s(e)),i(e,"categoryTabPrefab",G,s(e)),i(e,"itemScroll",V,s(e)),i(e,"itemContent",F,s(e)),i(e,"itemCardPrefab",j,s(e)),i(e,"modal",J,s(e)),i(e,"toast",K,s(e)),e.state=new v,e.renderWallet=function(){var t=e.state.wallet.DRAGONBONE;e.boneLabel.string=t.toString()},e.renderItems=function(){var t;e.itemContent.removeAllChildren(),e.filteredCatalog().forEach((function(t){var n=b(e.itemCardPrefab);n.setParent(e.itemContent),n.getComponent(S).init(t,{priceText:e.priceText(t),owned:"CONSUMABLE"!==t.type&&e.state.isOwned(t.sku),canBuy:e.state.canAfford(t),onBuy:function(t){return e.openPurchase(t)}})}));var n=null!=(t=e.itemContent.getComponent(m))?t:e.itemContent.addComponent(m);n.opacity=0,d(n).to(.15,{opacity:255}).start()},e}n(e,t);var l=e.prototype;return l.onLoad=function(){var t,e=this;null==(t=this.toast)||t.show("測試",.8),this.state.setCatalog(T),this.modal&&this.modal.node&&(this.modal.node.active=!1),this.renderWallet(),this.setupCategoryButtons(),this.renderItems(),this.state.events.on("wallet:change",this.renderWallet,this),this.state.events.on("owned:change",this.renderItems,this),this.state.events.on("inventory:change",this.renderItems,this),this.state.events.on("category:change",(function(){e.updateCategoryVisuals(),e.renderItems()}),this)},l.priceText=function(t){var e,n;return(null!=(e=null==(n=t.priceSoft)?void 0:n.amount)?e:0).toLocaleString("zh-TW")+" "},l.setupCategoryButtons=function(){for(var t=this,e=function(){var e,r=t.categoryButtons[n],a=null!=(e=w[n])?e:"分類"+(n+1),o=r.getComponent(f);o&&(o.string=a),r.off(c.EventType.TOUCH_END),r.on(c.EventType.TOUCH_END,(function(){t.state.setCategory(a)}),t)},n=0;n<this.categoryButtons.length;n++)e();this.updateCategoryVisuals()},l.updateCategoryVisuals=function(){for(var t=this.state.currentCategory,e=0;e<this.categoryButtons.length;e++){var n,r=this.categoryButtons[e],a=null!=(n=w[e])?n:"",o=r.getChildByName("Frame");if(o){var i=o.getComponent(g);i&&(i.color=a===t?y.WHITE:new y(220,220,220,255))}}},l.renderCategories=function(){var t=this;this.categoryTabs.removeAllChildren();for(var e,n=r(w);!(e=n()).done;){var a=e.value,o=b(this.categoryTabPrefab);o.setParent(this.categoryTabs),o.getComponent(I).init(a,(function(e){return t.state.setCategory(e)}))}},l.filteredCatalog=function(){var t=this.state.currentCategory;return"全部"===t?this.state.catalog:this.state.catalog.filter((function(e){return e.category===t}))},l.openPurchase=function(t){var e=this;this.modal.open(this.state,t,a(o().mark((function n(r){var a,i,s,l,u;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("CONSUMABLE"!==t.type){n.next=6;break}return n.next=3,e.state.purchaseMany(t,r);case 3:n.t0=n.sent,n.next=9;break;case 6:return n.next=8,e.state.purchase(t);case 8:n.t0=n.sent;case 9:(a=n.t0).ok?(s="CONSUMABLE"===t.type?" ×"+r:"",null==(i=e.toast)||i.show("購買成功：\n"+t.name+s)):(u="NOT_ENOUGH"===a.reason?"龍骨不足":"ALREADY_OWNED"===a.reason?"已擁有":"失敗",null==(l=e.toast)||l.show("購買失敗："+u));case 11:case"end":return n.stop()}}),n)}))))},l.onDevReset=function(){this.state.resetDemo(),this.renderItems()},e}(C)).prototype,"categoryButtons",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),H=e(k.prototype,"boneLabel",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(k.prototype,"categoryTabs",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(k.prototype,"categoryTabPrefab",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(k.prototype,"itemScroll",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(k.prototype,"itemContent",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(k.prototype,"itemCardPrefab",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(k.prototype,"modal",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(k.prototype,"toast",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=k))||M));l._RF.pop()}}}));

System.register("chunks:///_virtual/SwimmingFish.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FishDetailManager.ts"],(function(t){var e,i,n,r,o,s,a,l,u,h,c,m,p,f,d,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized,o=t.asyncToGenerator,s=t.regeneratorRuntime},function(t){a=t.cclegacy,l=t._decorator,u=t.UITransform,h=t.Vec3,c=t.Sprite,m=t.Node,p=t.Component,f=t.tween,d=t.find},function(t){v=t.FishDetailManager}],execute:function(){var b,g,S,F;a._RF.push({},"ff87csflAtIoZduCCeP/Ybx","SwimmingFish",void 0);var y=l.ccclass,B=l.property;t("SwimmingFish",y("SwimmingFish")(((F=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))||this).fishData=null,n(e,"interactive",S,r(e)),e._envForEmotion=null,e.isMovingRight=!1,e.speed=80,e.fishAreaWorldLeft=0,e.fishAreaWorldRight=0,e.emotionBubble=null,e.emotionSprite=null,e._lastEmotion=null,e._lastEmotionSprite=null,e}i(e,t),e.setEmotionFrames=function(t){this._emotionFrames=t||{}},e.getEmotionSpriteByKey=function(t){var e,i;return null!=(e=null!=(i=this._emotionFrames[t])?i:this._emotionFrames.happy)?e:null};var a=e.prototype;return a.start=function(){var t,e,i,n=this.node.parent,r=n.getComponent(u),o=n.getWorldPosition(),s=r.width/2;this.fishAreaWorldLeft=o.x-s+50,this.fishAreaWorldRight=o.x+s-50;var a=this.node.initialDirection;this.isMovingRight=1===a,this.node.setScale(this.isMovingRight?new h(-1,1,1):new h(1,1,1)),this.emotionBubble=this.node.getChildByName("EmotionBubble");var l=null==(t=this.emotionBubble)?void 0:t.getChildByName("EmotionIcon");this.emotionSprite=(null==l||null==(e=l.getChildByName("Sprite"))?void 0:e.getComponent(c))||null,this.emotionSprite||console.warn("[SwimmingFish] 找不到 EmotionBubble 內的 Sprite，請確認泡泡底下有 Sprite 元件");var p=null==(i=this.emotionBubble)?void 0:i.getChildByName("MagnifierBtn");null==p||p.on(m.EventType.TOUCH_END,this.onClickMagnifier,this),this.node.on(m.EventType.TOUCH_END,this.onClickFish,this)},a.update=function(t){var i,n;if(this!==e.currentSelectedFish&&null!=(i=this.emotionBubble)&&i.active&&(this.emotionBubble.active=!1),null==(n=this.emotionBubble)||!n.active){var r=this.speed*t*(this.isMovingRight?1:-1),o=this.node.position.x+r;this.node.setPosition(o,this.node.position.y,0);var s=this.node.getWorldPosition().x;s>this.fishAreaWorldRight&&this.isMovingRight?(this.isMovingRight=!1,this.node.setScale(new h(1,1,1))):s<this.fishAreaWorldLeft&&!this.isMovingRight&&(this.isMovingRight=!0,this.node.setScale(new h(-1,1,1)))}},a.setFishData=function(t,e){this.fishData=t,e&&"readOnly"in e&&(this.interactive=!e.readOnly),null!=e&&e.env&&(this._envForEmotion=e.env)},a.onClickFish=function(){var t=o(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.emotionBubble){t.next=2;break}return t.abrupt("return");case 2:if(e.currentSelectedFish!==this){t.next=6;break}return this.emotionBubble.active=!1,e.currentSelectedFish=null,t.abrupt("return");case 6:return e.currentSelectedFish&&(e.currentSelectedFish.emotionBubble.active=!1),e.currentSelectedFish=this,this.emotionBubble.active=!0,this.emotionBubble.setScale(new h(.3,.3,1)),t.next=12,this.updateBubbleEmotionIcon();case 12:f(this.emotionBubble).to(.25,{scale:new h(1,1,1)},{easing:"backOut"}).start();case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.clearSelection=function(){if(e.currentSelectedFish){var t=e.currentSelectedFish.emotionBubble;t&&t.isValid&&(t.active=!1),e.currentSelectedFish=null}},a.onClickMagnifier=function(){var t=o(s().mark((function t(){var e,i,n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.fishData){t.next=2;break}return t.abrupt("return");case 2:if(i=null==(e=d("/GameManager"))?void 0:e.getComponent(v)){t.next=5;break}return t.abrupt("return");case 5:if(this._lastEmotionSprite){t.next=8;break}return t.next=8,this.updateBubbleEmotionIcon();case 8:n=!this.interactive,i.showFishDetail(this.fishData,this._lastEmotionSprite||null,{readOnly:n});case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),a.updateBubbleEmotionIcon=function(){var t=o(s().mark((function t(){var i,n,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.emotionSprite&&this.fishData){t.next=2;break}return t.abrupt("return");case 2:i=this._envForEmotion||null,n=e.computeEmotion(this.fishData,i),(r=e.getEmotionSpriteByKey(n))&&(this.emotionSprite.spriteFrame=r,this._lastEmotion=n,this._lastEmotionSprite=r);case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.computeEmotion=function(t,e){var i,n;if(null!=(i=t.status)&&i.sick)return"sick";if((null==e?void 0:e.temperature)<18)return"cold";if((null==e?void 0:e.temperature)>23)return"hot";if((null!=(n=t.hunger)?n:0)>=80)return"hungry";var r=["happy","sad","angry"];return r[Math.floor(Math.random()*r.length)]},e}(p)).currentSelectedFish=null,F._emotionFrames={},S=e((g=F).prototype,"interactive",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),b=g))||b);a._RF.pop()}}}));

System.register("chunks:///_virtual/TankEnvironmentManager.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"fc7c8V4VSlJdJjnDRnHVYya","TankEnvironmentManager",void 0);e("TankEnvironmentManager",function(){function e(){}return e.adjustTemperature=function(e){var t=e.tankEnvironment;t.temperature=21,t.isTemperatureDanger=!1,t.lastTempUpdateTime=(new Date).toISOString(),console.log("水溫已調整為 21°C（正常範圍）")},e.cleanWater=function(e){var t=e.tankEnvironment;t.waterQualityStatus="clean",t.lastCleanTime=(new Date).toISOString(),t.loginDaysSinceClean=0,console.log("魚缸已清理，狀態變為乾淨")},e.shouldUpdateTemperature=function(e){var t=e.tankEnvironment,n=new Date(t.lastTempUpdateTime||new Date);return((new Date).getTime()-n.getTime())/36e5>=12},e.updateTemperature=function(e){var t=e.tankEnvironment,n=4*Math.random()-2;t.temperature=Math.round(10*(t.temperature+n))/10,t.lastTempUpdateTime=(new Date).toISOString(),t.isTemperatureDanger=t.temperature<18||t.temperature>23,console.log("水溫更新為 "+t.temperature+"°C，是否異常："+t.isTemperatureDanger)},e.checkWaterDirty=function(e){var t,n=e.tankEnvironment;(null!=(t=n.loginDaysSinceClean)?t:0)>=2&&(n.waterQualityStatus="dirty",console.log("魚缸已變髒！（以登入日累積達 2 天）"))},e.isEnvBad=function(e){var t=e.tankEnvironment;return t.isTemperatureDanger||"dirty"===t.waterQualityStatus},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/Toast.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,n,e,i,a,r,s,l,c,p,u;return{setters:[function(t){o=t.applyDecoratedDescriptor,n=t.inheritsLoose,e=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){a=t.cclegacy,r=t._decorator,s=t.Label,l=t.UIOpacity,c=t.tween,p=t.v3,u=t.Component}],execute:function(){var d,h,y,v,f;a._RF.push({},"09162BhNslDQIyD976srByq","Toast",void 0);var b=r.ccclass,g=r.property;t("Toast",(d=b("Toast"),h=g(s),d((f=o((v=function(t){function o(){for(var o,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return o=t.call.apply(t,[this].concat(a))||this,e(o,"label",f,i(o)),o}n(o,t);var a=o.prototype;return a.onLoad=function(){var t;(null!=(t=this.getComponent(l))?t:this.addComponent(l)).opacity=0,this.node.active=!1},a.show=function(t,o){var n,e,i=this;void 0===o&&(o=1.6);var a=null!=(n=this.getComponent(l))?n:this.addComponent(l),r=null!=(e=this.label)?e:this.getComponentInChildren(s);r?(r.string=t,this.node.active=!0,this.node.setSiblingIndex(9999),a.opacity=0,this.node.setPosition(0,-20,0),c(a).to(.15,{opacity:255}).delay(o).to(.15,{opacity:0}).call((function(){return i.node.active=!1})).start(),c(this.node).to(.15,{position:p(0,0,0)}).delay(o).to(.15,{position:p(0,10,0)}).start()):console.warn("Toast: label not bound")},o}(u)).prototype,"label",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=v))||y));a._RF.pop()}}}));

System.register("chunks:///_virtual/TombManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts","./UIUtils.ts"],(function(e){var t,n,i,r,a,o,l,s,u,c,f,h,b,p,m,g,d,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,a=e.asyncToGenerator,o=e.regeneratorRuntime,l=e.createForOfIteratorHelperLoose},function(e){s=e.cclegacy,u=e._decorator,c=e.Node,f=e.Prefab,h=e.Label,b=e.Component,p=e.instantiate,m=e.Button},function(e){g=e.DataManager},function(e){d=e.playOpenPanelAnim,v=e.showFloatingTextCenter}],execute:function(){var y,D,L,w,C,T,P,x,F,k,z,B,E,N,_,H,O,U,I,M,Y,A,R,W,j,G,S,V,q,J,K,Q,X,Z,$,ee,te,ne,ie;s._RF.push({},"ed3f6FtoxFFlLalg/eFzCms","TombManager",void 0);var re=u.ccclass,ae=u.property;e("TombManager",(y=re("TombManager"),D=ae(c),L=ae(f),w=ae(c),C=ae(h),T=ae(h),P=ae(h),x=ae(h),F=ae(h),k=ae(h),z=ae(c),B=ae(c),E=ae(h),N=ae(c),_=ae(c),H=ae(c),O=ae(h),U=ae(c),I=ae(c),y((A=t((Y=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,i(t,"tombContainer",A,r(t)),i(t,"tombstonePrefab",R,r(t)),i(t,"deadFishDetailPanel",W,r(t)),i(t,"titleLabel",j,r(t)),i(t,"nameLabel",G,r(t)),i(t,"genderLabel",S,r(t)),i(t,"daysLabel",V,r(t)),i(t,"stageLabel",q,r(t)),i(t,"deathDateLabel",J,r(t)),i(t,"floatingNode",K,r(t)),i(t,"reviveBtn",Q,r(t)),i(t,"reviveCountLabel",X,r(t)),i(t,"resetBtn",Z,r(t)),i(t,"closeBtn",$,r(t)),i(t,"confirmDialogPanel",ee,r(t)),i(t,"confirmDialogText",te,r(t)),i(t,"confirmDialogYesButton",ne,r(t)),i(t,"confirmDialogNoButton",ie,r(t)),t.deadFishList=[],t.confirmCallback=null,t}n(t,e);var s=t.prototype;return s.init=function(){var e=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.getPlayerDataCached();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:this.deadFishList=t.fishList.filter((function(e){return e.isDead})),this.refreshTombs();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.start=function(){var e=this;this.confirmDialogYesButton.on(c.EventType.TOUCH_END,(function(){e.confirmCallback&&(e.confirmCallback(),e.confirmCallback=null),e.confirmDialogPanel.active=!1})),this.confirmDialogNoButton.on(c.EventType.TOUCH_END,(function(){e.confirmCallback=null,e.confirmDialogPanel.active=!1}))},s.refreshTombs=function(){var e=a(o().mark((function e(){var t,n,i,r,a=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.getPlayerDataCached();case 2:if(t=e.sent,this.deadFishList=t.fishList.filter((function(e){return e.isDead})),this.tombContainer.removeAllChildren(),0!==this.deadFishList.length){e.next=7;break}return e.abrupt("return");case 7:n=o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=r.value,(n=p(a.tombstonePrefab)).getComponentInChildren(h).string=t.name,n.on(c.EventType.TOUCH_END,(function(){a.showDeadFishDetail(t)})),a.tombContainer.addChild(n);case 5:case"end":return e.stop()}}),e)})),i=l(this.deadFishList);case 9:if((r=i()).done){e.next=13;break}return e.delegateYield(n(),"t0",11);case 11:e.next=9;break;case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.showDeadFishDetail=function(){var e=a(o().mark((function e(t){var n,i,r,a=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(this.deadFishDetailPanel),e.next=3,g.getPlayerDataCached();case 3:i=e.sent,r=i.inventory.items.revivePotion,this.reviveCountLabel.string=""+r,this.reviveBtn.getComponent(m).interactable=r>0,this.titleLabel.string=t.name+" 的魚生回憶",this.nameLabel.string="名字："+t.name,this.genderLabel.string="性別："+("male"===t.gender?"公魚":"母魚"),this.daysLabel.string="成長天數：牠努力生活了 "+t.growthDaysPassed+" 天",this.stageLabel.string="階段：LV "+t.stage,this.deathDateLabel.string="離開的日子：在 "+(null!=(n=t.deathDate)?n:"未知")+"，牠悄悄地離開了魚缸",this.reviveBtn.off(c.EventType.TOUCH_END),this.resetBtn.off(c.EventType.TOUCH_END),this.closeBtn.off(c.EventType.TOUCH_END),r>0&&this.reviveBtn.on(c.EventType.TOUCH_END,(function(){a.showConfirmDialog("確定要復活 "+t.name+" 嗎？",(function(){return a.reviveFish(t)}))})),this.resetBtn.on(c.EventType.TOUCH_END,(function(){a.showConfirmDialog("確定要讓 "+t.name+" 重新開始嗎？",(function(){return a.resetFish(t)}))})),this.closeBtn.on(c.EventType.TOUCH_END,(function(){a.deadFishDetailPanel.active=!1}));case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.reviveFish=function(){var e=a(o().mark((function e(t){var n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.getPlayerDataCached();case 2:if(!((n=e.sent).inventory.items.revivePotion<=0)){e.next=6;break}return console.warn("沒有復活藥"),e.abrupt("return");case 6:if(-1!==(i=n.fishList.findIndex((function(e){return e.id===t.id})))){e.next=9;break}return e.abrupt("return");case 9:return n.inventory.items.revivePotion--,n.fishList[i].isDead=!1,n.fishList[i].emotion="happy",n.fishList[i].hunger=50,e.next=15,g.savePlayerDataWithCache(n);case 15:console.log(t.name+" 已復活"),v(this.floatingNode,t.name+" 已復活，快去 "+t.tankId+" 號魚缸看看牠吧！"),this.deadFishDetailPanel.active=!1,this.refreshTombs();case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.resetFish=function(){var e=a(o().mark((function e(t){var n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.getPlayerDataCached();case 2:if(n=e.sent,-1!==(i=n.fishList.findIndex((function(e){return e.id===t.id})))){e.next=6;break}return e.abrupt("return");case 6:return n.fishList[i].isDead=!1,n.fishList[i].emotion="happy",n.fishList[i].stage=1,n.fishList[i].growthDaysPassed=0,n.fishList[i].hunger=50,e.next=13,g.savePlayerDataWithCache(n);case 13:console.log(t.name+" 已重新開始養殖"),v(this.floatingNode,t.name+" 已重新開始，快去 "+t.tankId+" 號魚缸看看牠吧！"),this.deadFishDetailPanel.active=!1,this.refreshTombs();case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.showConfirmDialog=function(e,t){this.confirmDialogText.string=e,this.confirmDialogPanel.active=!0,this.confirmCallback=t},t}(b)).prototype,"tombContainer",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(Y.prototype,"tombstonePrefab",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(Y.prototype,"deadFishDetailPanel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(Y.prototype,"titleLabel",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(Y.prototype,"nameLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(Y.prototype,"genderLabel",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(Y.prototype,"daysLabel",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(Y.prototype,"stageLabel",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(Y.prototype,"deathDateLabel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(Y.prototype,"floatingNode",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(Y.prototype,"reviveBtn",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=t(Y.prototype,"reviveCountLabel",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(Y.prototype,"resetBtn",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=t(Y.prototype,"closeBtn",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=t(Y.prototype,"confirmDialogPanel",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=t(Y.prototype,"confirmDialogText",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=t(Y.prototype,"confirmDialogYesButton",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie=t(Y.prototype,"confirmDialogNoButton",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=Y))||M));s._RF.pop()}}}));

System.register("chunks:///_virtual/types.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"0b98bsmhVdK7ryL5Aeza7mf","types",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/UIUtils.ts",["cc"],(function(t){var e,n,i,o,a;return{setters:[function(t){e=t.cclegacy,n=t.Label,i=t.UIOpacity,o=t.tween,a=t.Vec3}],execute:function(){t({playOpenPanelAnim:function(t,e){void 0===e&&(e=.3);if(!t)return;t.active||(t.active=!0,t.scale=new a(.3,.3,1));o(t).to(e,{scale:new a(1,1,1)},{easing:"backOut"}).start()},showFloatingTextCenter:function(t,e){var c=null==t?void 0:t.getComponentInChildren(n),s=null==t?void 0:t.getComponent(i);if(!t||!c||!s)return void console.warn("[UIUtils] floatingNode 缺少 Node / Label / UIOpacity 元件");o(t).stop(),o(s).stop(),c.string=e,t.active=!0,s.opacity=0;var l=new a(0,0,0),r=new a(0,30,0);t.setPosition(l),o(s).to(.3,{opacity:255}).delay(1.2).to(.4,{opacity:0}).call((function(){return t.active=!1})).start(),o(t).to(1.2,{position:r},{easing:"quadOut"}).start()}}),e._RF.push({},"ce412tpvfFOL74Vyn/N7XEX","UIUtils",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/utils.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){t({getRandomItem:function(t){return t[Math.floor(Math.random()*t.length)]},getTodayIndex:function(){return((new Date).getDay()+6)%7},getWeekStartKey:function(t,e){void 0===t&&(t=new Date);void 0===e&&(e=480);var n=new Date(t.getTime()+6e4*e),r=new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate())),a=(r.getUTCDay()+6)%7;return r.setUTCDate(r.getUTCDate()-a),r.toISOString().slice(0,10)},shuffleArray:function(t){for(var e=[].concat(t),n=e.length-1;n>0;n--){var r=Math.floor(Math.random()*(n+1)),a=[e[r],e[n]];e[n]=a[0],e[r]=a[1]}return e}}),e._RF.push({},"2d2fbgjcXBLH5Tr8Xztdvcm","utils",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/WeeklySignInManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts","./RewardPopup.ts","./QuizPanel.ts","./SignInPanel.ts","./utils.ts"],(function(e){var t,n,a,r,i,o,s,l,u,c,p,g,d,y,h,f,b,m,S,I,w,D,k,P;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,a=e.initializerDefineProperty,r=e.assertThisInitialized,i=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){s=e.cclegacy,l=e._decorator,u=e.Sprite,c=e.Label,p=e.Button,g=e.Prefab,d=e.SpriteFrame,y=e.Color,h=e.Component,f=e.instantiate,b=e.UITransform},function(e){m=e.DataManager},function(e){S=e.RewardPopup},function(e){I=e.QuizPanel},function(e){w=e.SignInPanel},function(e){D=e.getTodayIndex,k=e.getWeekStartKey,P=e.getRandomItem}],execute:function(){var v,F,x,z,B,C,M,T,W,L,R,_,H,K,q,Q,U,O,j,A,G,V,E;s._RF.push({},"4236cmKkvVCsocbSypDKfTI","WeeklySignInManager",void 0);var J=l.ccclass,N=l.property,X=function(e){return e[e.Missed=0]="Missed",e[e.Today=1]="Today",e[e.Future=2]="Future",e[e.Signed=3]="Signed",e}(X||{});e("WeeklySignInManager",(v=J("WeeklySignInManager"),F=N(w),x=N(u),z=N(c),B=N(p),C=N(c),M=N(g),T=N(g),W=N(d),L=N(d),R=N(d),v((K=t((H=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i))||this,a(t,"signInPanel",K,r(t)),a(t,"dayBgSprites",q,r(t)),a(t,"dayLabels",Q,r(t)),a(t,"claimButton",U,r(t)),a(t,"signInHintLabel",O,r(t)),a(t,"rewardPopupPrefab",j,r(t)),a(t,"quizPanelPrefab",A,r(t)),a(t,"dragonBoneSpriteFrame",G,r(t)),a(t,"premiumFeedSpriteFrame",V,r(t)),a(t,"defaultSpriteFrame",E,r(t)),t.todayIndex=0,t.playerData=void 0,t}n(t,e);var s=t.prototype;return s.start=function(){var e=i(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(t=m.ready)?void 0:t.catch((function(){}));case 2:return e.next=4,m.getPlayerDataCached();case 4:if(this.playerData=e.sent,this.playerData&&this.playerData.signInData){e.next=8;break}return console.warn("[WeeklySignIn] 尚未取得玩家資料，停用本元件初始化"),e.abrupt("return");case 8:this.handleWeekReset(),this.todayIndex=D(),this.updateSignInUI(),this.claimButton.node.on("click",this.onClaimButtonClick,this),n=(new Date).toISOString().split("T")[0],this.playerData.signInData.weekly.lastSignDate===n?(this.claimButton.interactable=!1,this.signInHintLabel.string="今日已簽到"):(this.claimButton.interactable=!0,this.signInHintLabel.string="答題簽到");case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.handleWeekReset=function(){var e=i(o().mark((function e(){var t,n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=k(),n=this.playerData.signInData.weekly||{},a=n.weekKey,console.log("本週週鍵 =",t),console.log("玩家資料週鍵 =",a),a===t){e.next=10;break}return console.log("新的一週開始，重置週簽到資料"),this.playerData.signInData.weekly={weekKey:t,daysSigned:[!1,!1,!1,!1,!1,!1,!1],questionsCorrect:[!1,!1,!1,!1,!1,!1,!1],lastSignDate:""},e.next=10,m.savePlayerDataWithCache(this.playerData);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.updateSignInUI=function(){for(var e=0;e<this.dayBgSprites.length;e++){var t=this.dayBgSprites[e],n=this.dayLabels[e],a=void 0;a=this.playerData.signInData.weekly.daysSigned[e]?X.Signed:e===this.todayIndex?X.Today:e<this.todayIndex?X.Missed:X.Future,this.applyStyle(t,n,a)}},s.applyStyle=function(e,t,n){switch(n){case X.Signed:e.color=new y(180,255,180),t.string="✔ 已簽";break;case X.Today:e.color=new y(255,241,150),t.string="今天";break;case X.Missed:e.color=new y(255,143,143),t.string="未簽";break;case X.Future:e.color=new y(224,221,222),t.string="未來"}},s.getIconSpriteFrame=function(e){switch(e){case"dragonbone":return this.dragonBoneSpriteFrame;case"premium_feed":return this.premiumFeedSpriteFrame;default:return this.defaultSpriteFrame}},s.onClaimButtonClick=function(){var e=i(o().mark((function e(){var t,n,a,r,i,s,l,u,c,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(new Date).toISOString().split("T")[0],this.playerData.signInData.weekly.lastSignDate!==n){e.next=5;break}return console.log("今天已簽到"),e.abrupt("return");case 5:return e.next=7,m.getQuizQuestions();case 7:return a=e.sent,r=P(a),i=f(this.quizPanelPrefab),this.node.parent.addChild(i),s=i.getComponent(I),e.next=14,s.setup(r);case 14:return l=e.sent,this.playerData.signInData.weekly.lastSignDate=n,this.playerData.signInData.weekly.daysSigned[this.todayIndex]=!0,10,u=l?20:10,this.playerData.dragonBones+=u,6===this.todayIndex&&(this.playerData.inventory.feeds.premium+=1,console.log("今日為第七天，發送一包高級飼料！")),c=[{icon:this.getIconSpriteFrame("dragonbone"),name:"龍骨",count:u}],6===this.todayIndex&&c.push({icon:this.getIconSpriteFrame("premium_feed"),name:"高級飼料",count:1}),(p=f(this.rewardPopupPrefab)).getComponent(S).showRewards(c),this.node.getComponent(b).node.parent.addChild(p),e.next=28,m.savePlayerDataWithCache(this.playerData);case 28:this.updateSignInUI(),this.claimButton.interactable=!1,null==(t=this.signInPanel)||t.onWeeklySignInDone();case 31:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(h)).prototype,"signInPanel",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(H.prototype,"dayBgSprites",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Q=t(H.prototype,"dayLabels",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),U=t(H.prototype,"claimButton",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(H.prototype,"signInHintLabel",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(H.prototype,"rewardPopupPrefab",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(H.prototype,"quizPanelPrefab",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(H.prototype,"dragonBoneSpriteFrame",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(H.prototype,"premiumFeedSpriteFrame",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(H.prototype,"defaultSpriteFrame",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=H))||_));s._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});