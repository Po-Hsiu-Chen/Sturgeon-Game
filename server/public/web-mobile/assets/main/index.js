System.register("chunks:///_virtual/Api.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,r;return{setters:[function(e){t=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){r=e.cclegacy}],execute:function(){function a(){return(a=t(n().mark((function e(t){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/auth/line",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idToken:t})});case 2:if((r=e.sent).ok){e.next=5;break}throw new Error("auth/line failed");case 5:return e.abrupt("return",r.json());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function o(){return(o=t(n().mark((function e(t,r){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"http://localhost:3000",e.next=3,fetch("http://localhost:3000/linepay/request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t,planId:r})});case 3:if((a=e.sent).ok){e.next=6;break}throw new Error("linepay/request failed: "+a.status);case 6:return e.abrupt("return",a.json());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e({authWithLine:function(e){return a.apply(this,arguments)},createLinePayOrder:function(e,t){return o.apply(this,arguments)}}),r._RF.push({},"60365l6LiVPNJDhC4p/FcIV","Api",void 0),r._RF.pop()}}}));

System.register("chunks:///_virtual/BackgroundAnimator.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,r,i,s,a,n,o,p,u,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,i=t.initializerDefineProperty,s=t.assertThisInitialized},function(t){a=t.cclegacy,n=t._decorator,o=t.SpriteFrame,p=t.Sprite,u=t.resources,f=t.Component}],execute:function(){var h,c,l,m,_,d;a._RF.push({},"09a16m/pvVNf6MsYpK9e95p","BackgroundAnimator",void 0);var g=n.ccclass,F=n.property;t("BackgroundAnimator",(h=g("BackgroundAnimator"),c=F([o]),h((_=e((m=function(t){function e(){for(var e,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return e=t.call.apply(t,[this].concat(a))||this,i(e,"frames",_,s(e)),i(e,"fps",d,s(e)),e._sprite=null,e._t=0,e._i=0,e._defaultFrames=[],e}r(e,t);var a=e.prototype;return a.onLoad=function(){this._sprite=this.getComponent(p),this._defaultFrames=this.frames?this.frames.slice():[],this.frames.length>0&&this._sprite&&(this._sprite.spriteFrame=this.frames[0])},a.setBackground=function(t){var e=this;if(this._t=0,this._i=0,!t)return this.frames=this._defaultFrames?this._defaultFrames.slice():[],void(this._sprite&&this.frames.length>0&&(this._sprite.spriteFrame=this.frames[0]));u.loadDir("backgrounds/"+t,o,(function(r,i){!r&&i&&0!==i.length?(i.sort((function(t,e){return t.name.localeCompare(e.name)})),e.frames=i,e._sprite&&e.frames.length>0&&(e._sprite.spriteFrame=e.frames[0])):u.load("backgrounds/"+t+"/spriteFrame",o,(function(t,r){!t&&r&&(e.frames=[r],e._sprite&&(e._sprite.spriteFrame=r))}))}))},a.update=function(t){if(!(this.frames.length<=1)){this._t+=t;var e=1/this.fps;this._t>=e&&(this._t-=e,this._i=(this._i+1)%this.frames.length,this._sprite&&(this._sprite.spriteFrame=this.frames[this._i]))}},e}(f)).prototype,"frames",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),d=e(m.prototype,"fps",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),l=m))||l));a._RF.pop()}}}));

System.register("chunks:///_virtual/ButtomPanelToggle.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,o,i,l,s,c,r,a;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){l=t.cclegacy,s=t._decorator,c=t.Node,r=t.Button,a=t.Component}],execute:function(){var u,h,p,f,C,_,O,g,T;l._RF.push({},"4460aScEjdLF4HmtSnoEJ+w","ButtomPanelToggle",void 0);var d=s.ccclass,v=s.property;t("ButtomPanelToggle",(u=d("ButtomPanelToggle"),h=v(c),p=v(c),u(((T=function(t){function n(){for(var n,e=arguments.length,l=new Array(e),s=0;s<e;s++)l[s]=arguments[s];return n=t.call.apply(t,[this].concat(l))||this,o(n,"panel",_,i(n)),o(n,"closeBtn",O,i(n)),o(n,"closeOnBackground",g,i(n)),n._isOpen=!1,n._touchRoot=null,n}e(n,t);var l=n.prototype;return l.onLoad=function(){var t;this.node.on(r.EventType.CLICK,this.onClickButton,this),this.closeBtn&&this.closeBtn.on(r.EventType.CLICK,this.onClickClose,this),this.panel&&(this.panel.active=!1),this._touchRoot=null!=(t=this.node.scene.getChildByName("Canvas"))?t:null,this._touchRoot&&this._touchRoot.on(c.EventType.TOUCH_START,this.onGlobalTouch,this)},l.onDestroy=function(){this.node.off(r.EventType.CLICK,this.onClickButton,this),this.closeBtn&&this.closeBtn.off(r.EventType.CLICK,this.onClickClose,this),this._touchRoot&&this._touchRoot.off(c.EventType.TOUCH_START,this.onGlobalTouch,this),n._currentOpen===this&&(n._currentOpen=null)},l.onClickButton=function(){this._isOpen?this.closePanel():this.openPanel()},l.onClickClose=function(){this.closePanel()},l.onGlobalTouch=function(t){if(this.closeOnBackground&&this._isOpen&&this.panel){var n=t.target;n===this.node||n.isChildOf(this.node)||n===this.panel||n.isChildOf(this.panel)||this.closePanel()}},l.openPanel=function(){this.panel&&(n._currentOpen&&n._currentOpen!==this&&n._currentOpen.forceClosePanel(),this.panel.active=!0,this._isOpen=!0,n._currentOpen=this)},l.closePanel=function(){this.forceClosePanel()},l.forceClosePanel=function(){this.panel&&(this.panel.active=!1,this._isOpen=!1,n._currentOpen===this&&(n._currentOpen=null))},n}(a))._currentOpen=null,_=n((C=T).prototype,"panel",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=n(C.prototype,"closeBtn",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=n(C.prototype,"closeOnBackground",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),f=C))||f));l._RF.pop()}}}));

System.register("chunks:///_virtual/CategoryTab.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,n,r,o,a,c,l;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,c=t.Label,l=t.Component}],execute:function(){var s,u,p,y,b;o._RF.push({},"b4c90DrNntKa5RLkK5ZESyg","CategoryTab",void 0);var f=a.ccclass,h=a.property;t("CategoryTab",(s=f("CategoryTab"),u=h(c),s((b=e((y=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,n(e,"title",b,r(e)),e._tabName="ÂÖ®ÈÉ®",e._onPick=function(){},e}i(e,t);var o=e.prototype;return o.init=function(t,e){this._tabName=t,this._onPick=e,this.title&&(this.title.string=t)},o.onClick=function(){this._onPick(this._tabName)},e}(l)).prototype,"title",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),p=y))||p));o._RF.pop()}}}));

System.register("chunks:///_virtual/ChoosePartnerDialog.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts","./UIUtils.ts"],(function(e){var n,i,t,o,r,a,l,s,d,u,c,h,f,g,b,C,m,p,y,v;return{setters:[function(e){n=e.applyDecoratedDescriptor,i=e.inheritsLoose,t=e.createForOfIteratorHelperLoose,o=e.asyncToGenerator,r=e.regeneratorRuntime,a=e.initializerDefineProperty,l=e.assertThisInitialized},function(e){s=e.cclegacy,d=e._decorator,u=e.Node,c=e.Prefab,h=e.Button,f=e.Color,g=e.Sprite,b=e.Label,C=e.UITransform,m=e.instantiate,p=e.Component},function(e){y=e.GameManager},function(e){v=e.showFloatingTextCenter}],execute:function(){var T,L,w,I,M,P,F,D,B,z,N,E,R,S,A,K,U,_,G,x,H,V,k,j,O;s._RF.push({},"5ab3edLAQNODq/n1jPlz7Gd","ChoosePartnerDialog",void 0);var q=d.ccclass,Q=d.property,W=function(e){return e[e.My=0]="My",e[e.Friend=1]="Friend",e}(W||{});e("ChoosePartnerDialog",(T=q("ChoosePartnerDialog"),L=Q(y),w=Q(u),I=Q(u),M=Q(u),P=Q(u),F=Q(u),D=Q(c),B=Q(h),z=Q(h),N=Q(h),E=Q(u),T((A=n((S=function(e){function n(){for(var n,i=arguments.length,t=new Array(i),o=0;o<i;o++)t[o]=arguments[o];return n=e.call.apply(e,[this].concat(t))||this,a(n,"gameManager",A,l(n)),a(n,"titleLabelNode",K,l(n)),a(n,"mySection",U,l(n)),a(n,"myListContent",_,l(n)),a(n,"friendSection",G,l(n)),a(n,"friendListContent",x,l(n)),a(n,"rowPrefab",H,l(n)),a(n,"myTabBtn",V,l(n)),a(n,"friendTabBtn",k,l(n)),a(n,"closeBtn",j,l(n)),a(n,"floatingNode",O,l(n)),n.myFishId=-1,n.currentTab=W.My,n.friendCandidatesProvider=null,n._uiBound=!1,n}i(n,e);var s=n.prototype;return s.onLoad=function(){this._uiBound||(console.log("[ChooseDialog] onLoad -> bindUI()"),this.bindUI(),this._uiBound=!0),this.currentTab=W.My,this.updateTabVisuals()},s.openFor=function(e){console.log("[ChooseDialog] openFor, myFishId =",e),this.myFishId=e,this.node.active=!0,console.log("[ChooseDialog] node.active Â∑≤Ë®≠ true"),this.switchTab(W.My),this.renderLists()},s.setFriendCandidatesProvider=function(e){this.friendCandidatesProvider=function(){var n,i=null!=(n=e())?n:[];return console.log("[ChooseDialog] ÂèñÁî® friendCandidatesÔºåÈï∑Â∫¶ =",i.length),i},console.log("[ChooseDialog] provider Â∑≤Ê≥®ÂÖ•ÔºàÈùûÁ©∫ÔºüÔºâ=",!!e)},s.close=function(){this.node.active=!1},s.bindUI=function(){var e,n,i,t=this;console.log("[ChooseDialog] bindUI() Á∂ÅÂÆö‰∏≠"),null==(e=this.myTabBtn)||e.node.on(h.EventType.CLICK,(function(){console.log("[ChooseDialog] MyTab CLICK"),t.switchTab(W.My)}),this),null==(n=this.friendTabBtn)||n.node.on(h.EventType.CLICK,(function(){console.log("[ChooseDialog] FriendTab CLICK"),t.switchTab(W.Friend)}),this),null==(i=this.closeBtn)||i.node.on(h.EventType.CLICK,(function(){console.log("[ChooseDialog] Close CLICK"),t.close()}),this)},s.switchTab=function(e){console.log("[ChooseDialog] switchTab ->",e,"provider?",!!this.friendCandidatesProvider),e===W.Friend&&!this.friendCandidatesProvider&&(console.warn("[ChooseDialog] ÊÉ≥Âàá FriendÔºå‰ΩÜ provider ÁÇ∫Á©∫ÔºåÊîπÂõû My"),v(this.floatingNode,"ÈÇÑÊ≤íÊúâÊúãÂèãÁöÑÈ≠öÂèØ‰ª•ÈÅ∏Êìá üêü"),e=W.My),this.currentTab=e;var n=e===W.My;this.mySection.active=n,this.friendSection.active=!n,this.friendTabBtn.interactable=!!this.friendCandidatesProvider,console.log("[ChooseDialog] È°ØÁ§∫ÂàÜÈ†ÅÔºö",n?"My":"Friend"),this.updateTabVisuals(),this.renderLists()},s.updateTabVisuals=function(){var e=f.WHITE,n=new f(220,220,220,255),i=function(i,t){if(i){var o=i.node,r=o.getChildByName("Frame"),a=(null!=r?r:o).getComponent(g);a&&(a.color=t?e:n)}};if(i(this.myTabBtn,this.currentTab===W.My),i(this.friendTabBtn,this.currentTab===W.Friend),this.friendTabBtn&&!this.friendCandidatesProvider){var t=this.friendTabBtn.node,o=t.getChildByName("Frame"),r=(null!=o?o:t).getComponent(g);r&&(r.color=new f(180,180,180,255))}},s.renderLists=function(){this.clearList(this.myListContent),this.clearList(this.friendListContent);for(var e,n=this.gameManager.getMyPlayer(),i=this.getMyCandidates(n),o=0,r=t(i);!(e=r()).done;){var a=e.value;this.isCandidate(a)&&(this.addRow(this.myListContent,a,n.gameId),o++)}if(0===o&&this.showEmptyMessage(this.myListContent,"‰Ω†ÁõÆÂâçÊ≤íÊúâÂèØÁµêÂ©öÁöÑÈ≠ö üêü"),this.friendCandidatesProvider){for(var l,s=this.friendCandidatesProvider(),d=0,u=t(s);!(l=u()).done;){var c=l.value,h=c.ownerGameId,f=c.fish;this.isCandidate(f)&&(this.addRow(this.friendListContent,f,h),d++)}0===d&&this.showEmptyMessage(this.friendListContent,"ÊúãÂèãÁõÆÂâçÊ≤íÊúâÂèØÁµêÂ©öÁöÑÈ≠ö ü´Çüêü")}this.updateTabVisuals()},s.showEmptyMessage=function(e,n){var i=new u("EmptyMessage"),t=i.addComponent(b);t.string=n,t.fontSize=24,t.lineHeight=28,t.horizontalAlign=b.HorizontalAlign.CENTER,t.verticalAlign=b.VerticalAlign.CENTER,t.color=new f(0,0,0,255),i.addComponent(C).setAnchorPoint(.5,.5),i.setPosition(0,0,0),e.addChild(i)},s.clearList=function(e){e&&e.removeAllChildren()},s.addRow=function(e,n,i){var t,a,l=this,s=m(this.rowPrefab);s.parent=e;for(var d=null,u=0,c=["Name","NameLabel","Title","Label"];u<c.length;u++){var f=c[u],g=s.getChildByName(f);if(g){var C=g.getComponent(b);if(C){d=C;break}}}if(d||(d=null!=(t=s.getComponentInChildren(b))?t:null),d){var p="male"===n.gender?"‚ôÇ":"‚ôÄ";d.string=n.name+"Ôºà"+p+"Ôºâ  Lv."+n.stage}else console.warn("[ChoosePartnerDialog] RowPrefab Áº∫ LabelÔºàName/NameLabel/Title/Label ÈÉΩÊâæ‰∏çÂà∞Ôºâ");i!==this.gameManager.getMyPlayer().gameId&&(d.string+="  (Â•ΩÂèã)");var y=(null==(a=s.getChildByName("Choose"))?void 0:a.getComponent(h))||s.getComponentInChildren(h);null==y||y.node.on(h.EventType.CLICK,o(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("[ChoosePartnerDialog] choose",{myFishId:l.myFishId,partnerId:n.id,ownerGameId:i}),e.next=4,l.gameManager.marryFish(l.myFishId,n.id,i);case 4:l.close(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("[ChoosePartnerDialog] marry failed",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))))},s.getMyCandidates=function(e){var n=this;return e.fishList.filter((function(e){return n.isCandidate(e)&&e.id!==n.myFishId}))},s.isCandidate=function(e){var n,i=(null!=(n=e.stage)?n:0)>=6;return!!e&&!e.isDead&&!e.isMarried&&i},n}(p)).prototype,"gameManager",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=n(S.prototype,"titleLabelNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=n(S.prototype,"mySection",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=n(S.prototype,"myListContent",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=n(S.prototype,"friendSection",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=n(S.prototype,"friendListContent",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=n(S.prototype,"rowPrefab",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=n(S.prototype,"myTabBtn",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=n(S.prototype,"friendTabBtn",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=n(S.prototype,"closeBtn",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=n(S.prototype,"floatingNode",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=S))||R));s._RF.pop()}}}));

System.register("chunks:///_virtual/ConfirmDialogManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t,i,o,r,s,l,a,u,c,h,p;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized,r=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){l=e.cclegacy,a=e._decorator,u=e.Node,c=e.Label,h=e.Button,p=e.Component}],execute:function(){var f,b,v,_,g,d,y,m,B,N,T,C,L,w,D;l._RF.push({},"22778O+c3xPc7s8XH2BQ6x0","ConfirmDialogManager",void 0);var k=a.ccclass,x=a.property;e("ConfirmDialogManager",(f=k("ConfirmDialogManager"),b=x(u),v=x(u),_=x(u),g=x(c),d=x(h),y=x(h),f((N=n((B=function(e){function n(){for(var n,t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return n=e.call.apply(e,[this].concat(r))||this,i(n,"panel",N,o(n)),i(n,"contentNode",T,o(n)),i(n,"maskNode",C,o(n)),i(n,"messageLabel",L,o(n)),i(n,"yesBtn",w,o(n)),i(n,"noBtn",D,o(n)),n._resolver=null,n._open=!1,n}t(n,e);var l=n.prototype;return l.onLoad=function(){var e,n,t,i,o;this.panel&&(this.panel.active=!1),null==(e=this.yesBtn)||e.node.on(h.EventType.CLICK,this._onYes,this),null==(n=this.noBtn)||n.node.on(h.EventType.CLICK,this._onNo,this),null==(t=this.yesBtn)||t.node.on(u.EventType.TOUCH_END,this._onYesTouch,this),null==(i=this.noBtn)||i.node.on(u.EventType.TOUCH_END,this._onNoTouch,this),null==(o=this.maskNode)||o.on(u.EventType.TOUCH_END,(function(e){e.propagationStopped=!0}),this)},l._bringToFront=function(){var e,n,t,i=null==(e=this.panel)?void 0:e.parent;i&&this.panel.setSiblingIndex(i.children.length-1),null==(n=this.maskNode)||n.setSiblingIndex(0),null==(t=this.contentNode)||t.setSiblingIndex(1)},l._ensureInteractable=function(){var e,n;this.yesBtn&&(this.yesBtn.interactable=!0),this.noBtn&&(this.noBtn.interactable=!0),this.contentNode&&(this.contentNode.active=!0),(null==(e=this.yesBtn)?void 0:e.node)&&(this.yesBtn.node.active=!0),(null==(n=this.noBtn)?void 0:n.node)&&(this.noBtn.node.active=!0)},l._onYes=function(){this._resolver&&this._resolver(!0),this._close()},l._onNo=function(){this._resolver&&this._resolver(!1),this._close()},l._onYesTouch=function(){this._onYes()},l._onNoTouch=function(){this._onNo()},l.ask=function(){var e=r(s().mark((function e(n){var t=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._open){e.next=3;break}return this.messageLabel&&(this.messageLabel.string=n),e.abrupt("return",new Promise((function(e){var n=t._resolver;t._resolver=function(t){null==n||n(t),e(t)}})));case 3:return this._open=!0,this._resolver=null,this.messageLabel&&(this.messageLabel.string=n),this._bringToFront(),this._ensureInteractable(),this.panel&&(this.panel.active=!0),e.abrupt("return",new Promise((function(e){t._resolver=e})));case 10:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),l._close=function(){this._open=!1,this._resolver=null,this.panel&&(this.panel.active=!1)},n}(p)).prototype,"panel",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=n(B.prototype,"contentNode",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=n(B.prototype,"maskNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=n(B.prototype,"messageLabel",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=n(B.prototype,"yesBtn",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=n(B.prototype,"noBtn",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=B))||m));l._RF.pop()}}}));

System.register("chunks:///_virtual/DataManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./QuizData.ts"],(function(e){var r,t,n,a,s,u;return{setters:[function(e){r=e.createForOfIteratorHelperLoose,t=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){a=e.cclegacy,s=e._decorator},function(e){u=e.quizQuestions}],execute:function(){a._RF.push({},"5f04d33bXZHvp95rX07ICDM","DataManager",void 0);s.ccclass,s.property;var i=e("DataManager",function(){function e(){}return e.onChange=function(e){var r=this;return this._listeners.add(e),function(){return r._listeners.delete(e)}},e._emit=function(e){for(var t,n=r(this._listeners);!(t=n()).done;){(0,t.value)(e)}},e.ensureInitialized=function(){var e=t(n().mark((function e(r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setCurrentUser(r),e.next=3,this.getPlayerData(r);case 3:e.sent||console.error("[DataManager] ÂæåÁ´ØÊ≤íÊúâÈÄôÂÄãÁé©ÂÆ∂ÔºåË´ãÈáçÊñ∞ÁôªÂÖ• LINE");case 5:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.setCurrentUser=function(e){this.currentUserId=e},e.init=function(){var e=t(n().mark((function e(r){var t,a=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ready||(this.ready=new Promise((function(e){return a.readyResolve=e}))),this.initializing=!0,this.setCurrentUser(r),e.next=5,this.ensureInitialized(r);case 5:this.initializing=!1,null==(t=this.readyResolve)||t.call(this);case 7:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.getPlayerData=function(){var e=t(n().mark((function e(r){var t,a,s,u,i,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.ready||this.initializing){e.next=8;break}return e.prev=1,e.next=4,this.ready;case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:if(s="undefined"!=typeof window?localStorage.getItem("currentUserId"):null,u=(null!=(t=null!=(a=null!=r?r:this.currentUserId)?a:s)?t:"").trim()){e.next=13;break}return console.warn("[getPlayerData] Ê≤íÊúâ userIdÔºàÂèÉÊï∏ / currentUserId / localStorage ÈÉΩÊãø‰∏çÂà∞ÔºâÔºåÂõû null"),e.abrupt("return",null);case 13:return e.prev=13,e.next=16,fetch(this.apiBase+"/player/"+encodeURIComponent(u));case 16:if((i=e.sent).ok){e.next=28;break}if(404!==i.status){e.next=20;break}return e.abrupt("return",null);case 20:return e.t1=console,e.t2="ÂèñÂæóÁé©ÂÆ∂Ë≥áÊñôÂ§±Êïó: "+i.status+" ",e.next=24,i.text();case 24:return e.t3=e.sent,e.t4=e.t2+e.t3,e.t1.error.call(e.t1,e.t4),e.abrupt("return",null);case 28:return e.next=30,i.json();case 30:return o=e.sent,e.abrupt("return",this._migratePlayerData(o));case 34:return e.prev=34,e.t5=e.catch(13),console.error("[getPlayerData] fetch Â§±ÊïóÔºö",e.t5),e.abrupt("return",null);case 38:case"end":return e.stop()}}),e,this,[[1,6],[13,34]])})));return function(r){return e.apply(this,arguments)}}(),e.savePlayerData=function(){var e=t(n().mark((function e(r){var t,a,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.useLocalStorage){e.next=3;break}return localStorage.setItem("playerData",JSON.stringify(r)),e.abrupt("return",r);case 3:return e.next=5,fetch(this.apiBase+"/player/"+encodeURIComponent(r.userId),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 5:if((t=e.sent).ok){e.next=11;break}return e.next=9,t.text().catch((function(){return""}));case 9:throw a=e.sent,new Error("savePlayerData failed: "+t.status+" "+a);case 11:return e.next=13,t.json();case 13:return s=e.sent,this.setCurrentUser(s.userId),e.abrupt("return",s);case 16:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.getQuizQuestions=function(){var e=t(n().mark((function e(){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.useLocalStorage){e.next=4;break}return e.abrupt("return",u);case 4:return e.next=6,fetch(this.apiBase+"/quiz");case 6:return r=e.sent,e.next=9,r.json();case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.clearPlayerData=function(){this.useLocalStorage&&(localStorage.removeItem("playerData"),console.log("Áé©ÂÆ∂Ë≥áÊñôÂ∑≤Ê∏ÖÈô§"))},e.getPlayerDataCached=function(){var e=t(n().mark((function e(r){var a,s,u,i,o,c=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=null!=(a=null==r?void 0:r.maxAgeMs)?a:3e3,i=Date.now(),o=null!=(s=null==r?void 0:r.userId)?s:this.currentUserId,!(this._snapshot&&i-this._snapshotTime<u)||null!=r&&r.refresh){e.next=5;break}return e.abrupt("return",this._snapshot);case 5:if(!this._inFlight){e.next=7;break}return e.abrupt("return",this._inFlight);case 7:return this._inFlight=t(n().mark((function e(){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.getPlayerData(o);case 2:return r=e.sent,c._inFlight=null,r&&(c._snapshot=r,c._snapshotTime=Date.now(),c._emit(r)),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))(),e.abrupt("return",this._inFlight);case 9:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.refreshPlayerData=function(){var e=t(n().mark((function e(r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPlayerDataCached({refresh:!0,userId:r}));case 1:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.savePlayerDataWithCache=function(){var e=t(n().mark((function e(r){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.savePlayerData(r);case 2:return t=e.sent,this._snapshot=t,this._snapshotTime=Date.now(),this._emit(t),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.getFriends=function(){var e=t(n().mark((function e(){var r,t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.currentUserId){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,fetch(this.apiBase+"/friends/"+encodeURIComponent(r));case 5:if((t=e.sent).ok){e.next=8;break}return e.abrupt("return",[]);case 8:return e.next=10,t.json();case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.sendFriendRequest=function(){var e=t(n().mark((function e(r){var t,a,s,u;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.currentUserId){e.next=3;break}throw new Error("no current user");case 3:if(r){e.next=5;break}throw new Error("no friendId");case 5:return e.next=7,fetch(this.apiBase+"/friend-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fromUserId:t,toUserId:r})});case 7:if((a=e.sent).ok){e.next=15;break}return e.next=11,a.json().catch((function(){return{}}));case 11:throw s=e.sent,(u=new Error((null==s?void 0:s.error)||"sendFriendRequest failed")).code=null==s?void 0:s.error,u;case 15:return e.next=17,a.json();case 17:return e.abrupt("return",e.sent);case 18:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.getFriendRequests=function(){var e=t(n().mark((function e(){var r,t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.currentUserId){e.next=3;break}throw new Error("no current user");case 3:return e.next=5,fetch(this.apiBase+"/friend-requests?userId="+encodeURIComponent(r));case 5:if((t=e.sent).ok){e.next=8;break}throw new Error("getFriendRequests failed: "+t.status);case 8:return e.next=10,t.json();case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.getInbox=function(){var e=t(n().mark((function e(){var r,t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.currentUserId){e.next=3;break}throw new Error("no current user");case 3:return e.next=5,fetch(this.apiBase+"/mail/inbox?userId="+encodeURIComponent(r));case 5:if((t=e.sent).ok){e.next=8;break}throw new Error("getInbox failed: "+t.status);case 8:return e.next=10,t.json();case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.markMailRead=function(){var e=t(n().mark((function e(r){var t,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.currentUserId){e.next=3;break}throw new Error("no current user");case 3:return e.next=5,fetch(this.apiBase+"/mail/mark-read",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t,mailId:r})});case 5:if((a=e.sent).ok){e.next=8;break}throw new Error("markMailRead failed");case 8:return e.next=10,a.json();case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.respondFriendRequest=function(){var e=t(n().mark((function e(r,t){var a,s,u,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.currentUserId){e.next=3;break}throw new Error("no current user");case 3:return e.next=5,fetch(this.apiBase+"/friend-requests/respond",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a,requestId:r,action:t})});case 5:if((s=e.sent).ok){e.next=13;break}return e.next=9,s.json().catch((function(){return{}}));case 9:throw u=e.sent,(i=new Error((null==u?void 0:u.error)||"respondFriendRequest failed")).code=null==u?void 0:u.error,i;case 13:return e.next=15,s.json();case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e,this)})));return function(r,t){return e.apply(this,arguments)}}(),e.lookupUserById=function(){var e=t(n().mark((function e(r){var t,a,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(r||"").trim()){e.next=3;break}return e.abrupt("return",null);case 3:return e.prev=3,e.next=6,fetch(this.apiBase+"/public/player/"+encodeURIComponent(t));case 6:if(404!==(a=e.sent).status){e.next=9;break}return e.abrupt("return",null);case 9:if(a.ok){e.next=11;break}throw new Error("lookupUserById failed: "+a.status);case 11:return e.next=13,a.json();case 13:return s=e.sent,e.abrupt("return",{userId:s.userId,gameId:s.gameId,displayName:s.displayName,picture:s.picture});case 17:throw e.prev=17,e.t0=e.catch(3),console.warn("[lookupUserById] failed:",e.t0),e.t0;case 21:case"end":return e.stop()}}),e,this,[[3,17]])})));return function(r){return e.apply(this,arguments)}}(),e.getPublicPlayerData=function(){var e=t(n().mark((function e(r){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.apiBase+"/public/player/"+encodeURIComponent(r));case 2:if((t=e.sent).ok){e.next=9;break}return e.t0=Error,e.next=7,t.text();case 7:throw e.t1=e.sent,new e.t0(e.t1);case 9:return e.next=11,t.json();case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.deleteFriend=function(){var e=t(n().mark((function e(r){var t,a,s,u;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.currentUserId){e.next=3;break}throw new Error("no current user");case 3:return e.next=5,fetch(this.apiBase+"/friends/remove",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t,friendUserId:r})});case 5:if((a=e.sent).ok){e.next=13;break}return e.next=9,a.json().catch((function(){return{}}));case 9:throw s=e.sent,(u=new Error((null==s?void 0:s.error)||"deleteFriend failed")).code=null==s?void 0:s.error,u;case 13:return e.next=15,a.json();case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e.getRecommendedUsers=function(){var e=t(n().mark((function e(r){var t,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r=5),e.prev=1,t=this.currentUserId,e.next=5,fetch(this.apiBase+"/recommend-users?count="+r+"&excludeUserId="+encodeURIComponent(t||""));case 5:if((a=e.sent).ok){e.next=9;break}return console.warn("[DataManager] getRecommendedUsers failed:",a.status),e.abrupt("return",[]);case 9:return e.next=11,a.json();case 11:return e.abrupt("return",e.sent);case 14:return e.prev=14,e.t0=e.catch(1),console.warn("[DataManager] getRecommendedUsers error:",e.t0),e.abrupt("return",[]);case 18:case"end":return e.stop()}}),e,this,[[1,14]])})));return function(r){return e.apply(this,arguments)}}(),e.purchaseViaApi=function(){var e=t(n().mark((function e(r,t){var a,s,u,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=1),a=this.currentUserId){e.next=4;break}throw new Error("no current user");case 4:return e.next=6,fetch(this.apiBase+"/purchase",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a,sku:r,qty:t})});case 6:if((s=e.sent).ok){e.next=12;break}return e.next=10,s.text().catch((function(){return""}));case 10:throw u=e.sent,new Error("purchase failed: "+s.status+" "+u);case 12:return e.next=14,s.json();case 14:return i=e.sent,this._snapshot=i,this._snapshotTime=Date.now(),this._emit(i),e.abrupt("return",i);case 19:case"end":return e.stop()}}),e,this)})));return function(r,t){return e.apply(this,arguments)}}(),e.purchaseFallback=function(){var e=t(n().mark((function e(r,t,a){var s,u,i,o,c,h,p,f,l,d,v,x;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPlayerDataCached({refresh:!0});case 2:if(i=e.sent){e.next=5;break}throw new Error("no player data");case 5:if(o=a*t,!((null!=(s=i.dragonBones)?s:0)<o)){e.next=10;break}throw(c=new Error("NOT_ENOUGH")).code="NOT_ENOUGH",c;case 10:return i.dragonBones=(null!=(u=i.dragonBones)?u:0)-o,h=function(e,r){var t,n=e.split("."),a=n[0],s=n[1];i.inventory[a][s]=(null!=(t=i.inventory[a][s])?t:0)+r},f={cloth_bow:"acc_bowtie",cloth_chef_hat:"hat_chef",cloth_fedora:"hat_fedora",cloth_sun_glass:"acc_sunglass",cloth_crown:"hat_crown",cloth_flower:"acc_flower",cloth_heart_glass:"acc_heart_glass",cloth_magic_hat:"hat_magic",cloth_paint_hat:"hat_beret",cloth_party_hat:"hat_party"},(p={med_trans:function(e){return h("items.genderPotion",e)},med_change:function(e){return h("items.changePotion",e)},med_cold:function(e){return h("items.coldMedicine",e)},med_lvup:function(e){return h("items.upgradePotion",e)},med_revive:function(e){return h("items.revivePotion",e)},feed_normal:function(e){return h("feeds.normal",e)},feed_high:function(e){return h("feeds.premium",e)},env_brush:function(e){return h("items.brush",e)},env_fan:function(e){return h("items.fan",e)},heater:function(e){return h("items.heater",e)}})[r]?p[r](t):r.startsWith("deco_")||r.startsWith("bg_")?((d=new Set(null!=(l=i.decorationsOwned)?l:[])).add(r),i.decorationsOwned=Array.from(d)):(v=f[r]||r,-1===i.fashion.owned.indexOf(v)&&i.fashion.owned.push(v)),e.next=17,this.savePlayerDataWithCache(i);case 17:return x=e.sent,e.abrupt("return",x);case 19:case"end":return e.stop()}}),e,this)})));return function(r,t,n){return e.apply(this,arguments)}}(),e.purchase=function(){var e=t(n().mark((function e(r,t,a){var s,u;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=1),e.prev=1,e.next=4,this.purchaseViaApi(r,t);case 4:return s=e.sent,e.abrupt("return",{ok:!0,player:s});case 8:if(e.prev=8,e.t0=e.catch(1),null!=a){e.next=12;break}return e.abrupt("return",{ok:!1,error:(null==e.t0?void 0:e.t0.message)||"PURCHASE_FAILED"});case 12:return e.prev=12,e.next=15,this.purchaseFallback(r,t,a);case 15:return u=e.sent,e.abrupt("return",{ok:!0,player:u});case 19:return e.prev=19,e.t1=e.catch(12),e.abrupt("return",{ok:!1,error:(null==e.t1?void 0:e.t1.code)||(null==e.t1?void 0:e.t1.message)||"PURCHASE_FAILED"});case 22:case"end":return e.stop()}}),e,this,[[1,8],[12,19]])})));return function(r,t,n){return e.apply(this,arguments)}}(),e._migratePlayerData=function(e){if(Array.isArray(e.decorationsOwned)||(e.decorationsOwned=[]),Array.isArray(e.tankList))for(var t,n=r(e.tankList);!(t=n()).done;){var a=t.value;Array.isArray(a.decorations)||(a.decorations=[])}return e},e.saveOtherPlayerData=function(){var e=t(n().mark((function e(r){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.apiBase+"/player/"+encodeURIComponent(r.userId),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("saveOtherPlayerData failed: "+t.status);case 5:return e.next=7,t.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),e}());i.useLocalStorage=!1,i.apiBase="",i.currentUserId=null,i.ready=null,i.readyResolve=null,i.initializing=!1,i.FRIEND_LIMIT=30,i._snapshot=null,i._snapshotTime=0,i._inFlight=null,i._listeners=new Set,a._RF.pop()}}}));

System.register("chunks:///_virtual/DecorationEditor.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts","./DecorationItem.ts","./mockCatalog.ts","./BackgroundAnimator.ts"],(function(e){var t,n,r,a,i,o,s,c,u,l,d,h,p,f,g,m,v,y,b,D,k,C,L,_,P;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.createForOfIteratorHelperLoose,a=e.initializerDefineProperty,i=e.assertThisInitialized,o=e.asyncToGenerator,s=e.regeneratorRuntime,c=e.extends},function(e){u=e.cclegacy,l=e._decorator,d=e.Node,h=e.Button,p=e.Prefab,f=e.UIOpacity,g=e.tween,m=e.instantiate,v=e.Component,y=e.Label,b=e.Sprite,D=e.resources,k=e.SpriteFrame},function(e){C=e.DataManager},function(e){L=e.DecorationItem},function(e){_=e.MOCK_CATALOG},function(e){P=e.BackgroundAnimator}],execute:function(){var x,E,I,w,B,S,T,O,F,N,H,M,A,z,V;u._RF.push({},"d9febfmWGBL0a58XoNRxWwy","DecorationEditor",void 0);var W=l.ccclass,U=l.property,R="Deco_";e("DecorationEditor",(x=W("DecorationEditor"),E=U(d),I=U(d),w=U(h),B=U(h),S=U(p),T=U([d]),x((N=t((F=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,a(t,"panel",N,i(t)),a(t,"paletteContent",H,i(t)),a(t,"confirmBtn",M,i(t)),a(t,"cancelBtn",A,i(t)),a(t,"paletteButtonPrefab",z,i(t)),a(t,"hideDuringEdit",V,i(t)),t.gm=void 0,t.decoLayer=void 0,t.tankId=void 0,t.snapshot=[],t.currentBgId="bg_default",t.isLightSku=function(e){return e.startsWith("deco_light_")},t}n(t,e);var u=t.prototype;return u.isBgSku=function(e){return e.startsWith("bg_")||"bg_default"===e},u.isDecoSku=function(e){return e.startsWith("deco_")},u.onLoad=function(){var e,t;this.panel&&(this.panel.active=!1),null==(e=this.confirmBtn)||e.node.on(d.EventType.TOUCH_END,this.onConfirm,this),null==(t=this.cancelBtn)||t.node.on(d.EventType.TOUCH_END,this.onCancel,this)},u.onDestroy=function(){var e,t;this.decoLayer&&(this.decoLayer.off(d.EventType.CHILD_ADDED,this.updatePaletteLockState,this),this.decoLayer.off(d.EventType.CHILD_REMOVED,this.updatePaletteLockState,this)),null==(e=this.confirmBtn)||e.node.off(d.EventType.TOUCH_END,this.onConfirm,this),null==(t=this.cancelBtn)||t.node.off(d.EventType.TOUCH_END,this.onCancel,this)},u.enter=function(){var e=o(s().mark((function e(t,n){var a,i,o,u,l,h,p,f,g,m;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.gm=t,this.tankId=n,!(t.isViewingFriend||null!=(a=t.tombTankNode)&&a.active)){e.next=4;break}return e.abrupt("return");case 4:if(o=t.activeTankViewport,u=null==o?void 0:o.getChildByName("DecoLayer")){e.next=9;break}return console.warn("[DecorationEditor] Êâæ‰∏çÂà∞ DecoLayer"),e.abrupt("return");case 9:for(this.decoLayer=u,l=r(this.decoLayer.children);!(h=l()).done;)p=h.value,f=p.name.replace(/^Deco_/,""),this.isLightSku(f)||p.getComponent(L)||p.addComponent(L),p.name.startsWith(R)||(p.name="Deco_"+p.name);return this.decoLayer.on(d.EventType.CHILD_ADDED,this.updatePaletteLockState,this),this.decoLayer.on(d.EventType.CHILD_REMOVED,this.updatePaletteLockState,this),e.next=15,C.getPlayerDataCached();case 15:return g=e.sent,m=g.tankList.find((function(e){return e.id===n})),this.snapshot=(null!=(i=null==m?void 0:m.decorations)?i:[]).map((function(e){return c({},e)})),this.currentBgId=(null==m?void 0:m.backgroundId)||"bg_default",this.setDecorationInteractable(!0),this.openPanel(),this.setPanelsVisible(!1),e.next=24,this.renderPalette(g);case 24:this.updatePaletteLockState();case 25:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),u.openPanel=function(){var e;if(this.panel){var t=null!=(e=this.panel.getComponent(f))?e:this.panel.addComponent(f);t.opacity=0,this.panel.active=!0,g(t).to(.15,{opacity:255}).start()}},u.closePanel=function(){this.panel&&(this.setDecorationInteractable(!1),this.setPanelsVisible(!0),this.decoLayer&&(this.decoLayer.off(d.EventType.CHILD_ADDED,this.updatePaletteLockState,this),this.decoLayer.off(d.EventType.CHILD_REMOVED,this.updatePaletteLockState,this)),this.panel.active=!1)},u.setPanelsVisible=function(e){for(var t,n=r(null!=(a=this.hideDuringEdit)?a:[]);!(t=n()).done;){var a,i,o,s=t.value;s&&(this.panel&&(s===this.panel||null!=s.isChildOf&&s.isChildOf(this.panel)||null!=(i=(o=this.panel).isChildOf)&&i.call(o,s))||(s.active=e))}},u.renderPalette=function(){var e=o(s().mark((function e(t){var n,r,a,i,c,u=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.paletteContent){e.next=2;break}return e.abrupt("return");case 2:if(this.paletteButtonPrefab){e.next=5;break}return console.error("[DecorationEditor] Ë´ãÂÖàÂú®Ê™¢Êü•Âô®ÊåáÂÆö paletteButtonPrefab„ÄÇ"),e.abrupt("return");case 5:return this.paletteContent.removeAllChildren(),a=null!=(n=null==(r=t.decorationsOwned)?void 0:r.filter(this.isDecoSku))?n:[],i=this.getOwnedBackgrounds(t),c=[].concat(i,a),e.next=11,Promise.all(c.map(o(s().mark((function e(t){var n,r,a,i,o,c,l,p,g,v,D,k,C,L,P,x,E,I,w;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((c=m(u.paletteButtonPrefab)).setParent(u.paletteContent),c.__sku=t,c.__kind=u.isBgSku(t)?"bg":"deco",l=null!=(n=null==(r=c.getChildByName("Title"))?void 0:r.getComponent(y))?n:c.getComponentInChildren(y),p=_.find((function(e){return e.sku===t})),g=null!=(a=null==p?void 0:p.name)?a:"bg_default"===t?"È†êË®≠ËÉåÊôØ":t,l&&(l.string=g),!(v=c.getChildByName("Icon"))){e.next=16;break}return C=null!=(D=v.getComponent(b))?D:v.addComponent(b),L=null!=(k=null==p?void 0:p.iconKey)?k:t,e.next=14,u.loadIconFrame(L);case 14:(P=e.sent)&&(C.spriteFrame=P);case 16:x=null!=(i=c.getComponent(h))?i:c.addComponent(h),E=null!=(o=c.getComponent(f))?o:c.addComponent(f),u.isBgSku(t)?(x.interactable=!0,x.node.on(d.EventType.TOUCH_END,(function(){return u.applyBackground(t)}),u),E.opacity=t===u.currentBgId?255:120):u.isLightSku(t)?(x.interactable=!0,x.node.on(d.EventType.TOUCH_END,(function(){return u.toggleLight(t)}),u),I=u.hasDecoration(t),E.opacity=I?255:120):(x.interactable=!0,x.node.on(d.EventType.TOUCH_END,(function(){return u.toggleDecoration(t)}),u),w=u.hasDecoration(t),E.opacity=w?255:120);case 19:case"end":return e.stop()}}),e)})))));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),u.applyLight=function(e){if(this.decoLayer){for(var t,n=r(this.decoLayer.children.slice());!(t=n()).done;){var a=t.value,i=this.getDecoIdFromNode(a);i&&this.isLightSku(i)&&a.destroy()}if(e){var o=this.gm.getDecorationPrefab(e);if(o){var s=m(o);s.name="Deco_"+e,this.decoLayer.addChild(s),this.updatePaletteLockState()}}else this.updatePaletteLockState()}},u.updatePaletteLockState=function(){if(this.paletteContent)for(var e,t=r(this.paletteContent.children);!(e=t()).done;){var n,a,i=e.value,o=i.__sku,s=i.__kind,c=null!=(n=i.getComponent(h))?n:i.addComponent(h),u=null!=(a=i.getComponent(f))?a:i.addComponent(f);if(c.interactable=!0,"bg"===s)u.opacity=o===this.currentBgId?255:120;else{var l=this.hasDecoration(o);u.opacity=l?255:120}}},u.loadIconFrame=function(){var e=o(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){D.load("icons/"+t+"/spriteFrame",k,(function(n,r){if(!n&&r)return e(r);D.load("icons/"+t,k,(function(n,r){if(!n&&r)return e(r);D.loadDir("backgrounds/"+t,k,(function(t,n){if(!t&&n&&n.length>0)return n.sort((function(e,t){return e.name.localeCompare(t.name)})),e(n[0])}))}))}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u.spawnItem=function(e,t,n){var r;if(void 0===t&&(t=0),void 0===n&&(n=0),this.hasDecoration(e))console.warn("[Decor] ÊØèÁº∏ÂÉÖËÉΩÊîæ‰∏ÄÂÄãÔºö"+e);else{var a=this.gm.getDecorationPrefab(e);if(a){var i=m(a);i.name="Deco_"+e,i.setPosition(t,n,0),this.decoLayer.addChild(i);var o=null!=(r=i.getComponent(L))?r:i.addComponent(L);i.resumeSystemEvents(!0),o.selectMe(),this.updatePaletteLockState()}else console.warn("Êâæ‰∏çÂà∞Ë£ùÈ£æ PrefabÔºö",e)}},u.toggleDecoration=function(e){this.hasDecoration(e)?this.removeDecoration(e):this.spawnItem(e,0,0)},u.toggleLight=function(e){this.hasDecoration(e)?this.applyLight(""):this.applyLight(e)},u.setDecorationInteractable=function(e){if(this.decoLayer)for(var t,n=r(this.decoLayer.children);!(t=n()).done;){var a=t.value;e?a.resumeSystemEvents(!0):a.pauseSystemEvents(!0);var i=a.getComponent(L);i&&i.setSelected(!1)}},u.getOwnedBackgrounds=function(e){var t,n=(null!=(t=e.decorationsOwned)?t:[]).filter(this.isBgSku);return-1===n.indexOf("bg_default")&&n.unshift("bg_default"),n},u.applyBackground=function(){var e=o(s().mark((function e(t){var n,r,a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.currentBgId=t,(r=null==(n=this.gm.activeTankViewport)?void 0:n.getChildByName("Background"))&&((a=r.getComponent(P))?a.setBackground("bg_default"===t?void 0:t):(i=r.getComponent(b))&&("bg_default"===t?i.spriteFrame=this.gm.defaultBackgroundSpriteFrame:D.load("backgrounds/"+t+"/spriteFrame",k,(function(e,n){!e&&n?i.spriteFrame=n:D.load("backgrounds/"+t,k,(function(e,t){!e&&t&&(i.spriteFrame=t)}))})))),this.updatePaletteLockState();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),u.save=function(){var e=o(s().mark((function e(){var t,n,a,i,o,c,u,l,d,h=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getPlayerDataCached();case 2:if(t=e.sent,n=t.tankList.find((function(e){return e.id===h.tankId}))){e.next=6;break}return e.abrupt("return");case 6:a=[],i=r(this.decoLayer.children);case 8:if((o=i()).done){e.next=18;break}if(c=o.value,u=this.getDecoIdFromNode(c)){e.next=13;break}return e.abrupt("continue",16);case 13:l=c.getPosition(),d=c.getScale(),a.push({id:u,x:Math.round(l.x),y:Math.round(l.y),scale:Math.abs(d.x),rotation:Math.round(c.eulerAngles.z),flipX:d.x<0,zIndex:c.getSiblingIndex()});case 16:e.next=8;break;case 18:return n.decorations=a,n.backgroundId="bg_default"===this.currentBgId?void 0:this.currentBgId,e.next=22,C.savePlayerDataWithCache(t);case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.onConfirm=function(){var e=o(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.save();case 2:if("function"!=typeof(t=this.gm.switchTank)){e.next=6;break}return e.next=6,t.call(this.gm,this.tankId);case 6:this.closePanel();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.onCancel=function(){var e=o(s().mark((function e(){var t,n,r,a=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getPlayerDataCached();case 2:if(t=e.sent,!(n=t.tankList.find((function(e){return e.id===a.tankId})))){e.next=12;break}return n.decorations=this.snapshot.map((function(e){return c({},e)})),e.next=8,C.savePlayerDataWithCache(t);case 8:if("function"!=typeof(r=this.gm.switchTank)){e.next=12;break}return e.next=12,r.call(this.gm,this.tankId);case 12:this.closePanel();case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.hasDecoration=function(e){var t="Deco_"+e;return this.decoLayer.children.some((function(e){return e.name===t}))},u.getDecoIdFromNode=function(e){return e.name.startsWith(R)?e.name.substring(R.length):null},u.removeDecoration=function(e){if(this.decoLayer)for(var t,n="Deco_"+e,a=r(this.decoLayer.children.slice());!(t=a()).done;){var i=t.value;i.name===n&&i.destroy()}},u.removeAllLights=function(){if(this.decoLayer)for(var e,t=r(this.decoLayer.children.slice());!(e=t()).done;){var n=e.value,a=this.getDecoIdFromNode(n);a&&this.isLightSku(a)&&n.destroy()}},t}(v)).prototype,"panel",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(F.prototype,"paletteContent",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(F.prototype,"confirmBtn",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(F.prototype,"cancelBtn",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(F.prototype,"paletteButtonPrefab",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(F.prototype,"hideDuringEdit",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),O=F))||O));u._RF.pop()}}}));

System.register("chunks:///_virtual/DecorationItem.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,s,a,r,h,l,c,d,S,u,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){s=t.cclegacy,a=t._decorator,r=t.SpriteFrame,h=t.UITransform,l=t.Node,c=t.Graphics,d=t.Color,S=t.Sprite,u=t.Vec3,p=t.Component}],execute:function(){var g,v,y,f,m,M;s._RF.push({},"7779db9+BVJOIPRphX/pgOY","DecorationItem",void 0);var E=a.ccclass,I=a.property;t("DecorationItem",(g=E("DecorationItem"),v=I(r),g(((M=function(t){function e(){for(var e,n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return e=t.call.apply(t,[this].concat(s))||this,i(e,"closeIcon",m,o(e)),e.parentUI=void 0,e.dragging=!1,e.dragStart=new u,e.nodeStart=new u,e.scaling=!1,e.scaleStart=1,e.cornerIndex=0,e.centerAtStart=new u,e.radiusStart=1,e.scaleMin=.3,e.scaleMax=10,e.uiRoot=void 0,e.frame=void 0,e.handles=[],e.closeBtn=void 0,e.HANDLE_SIZE=12,e.CLOSE_SIZE=30,e.FRAME_WIDTH=5,e.FRAME_MARGIN=0,e.CLOSE_MARGIN=20,e}n(e,t);var s=e.prototype;return s.onLoad=function(){this.parentUI=this.node.parent.getComponent(h),this.buildSelectionUI(),this.setSelected(!1),this.node.on(l.EventType.TOUCH_START,this.onDown,this),this.node.on(l.EventType.TOUCH_MOVE,this.onMove,this),this.node.on(l.EventType.TOUCH_END,this.onUp,this),this.node.on(l.EventType.TOUCH_CANCEL,this.onUp,this),this.node.pauseSystemEvents(!0)},s.onDestroy=function(){e._selected===this&&(e._selected=null)},s.selectMe=function(){e._selected&&e._selected!==this&&e._selected.setSelected(!1),e._selected=this,this.setSelected(!0);var t=this.node.parent;this.node.setSiblingIndex(t.children.length-1)},s.createFilledBox=function(t,e){var n=new l("box");n.addComponent(h).setContentSize(t,t);var i=n.addComponent(c);return i.fillColor=e,i.rect(-t/2,-t/2,t,t),i.fill(),n},s.buildSelectionUI=function(){var t=this;this.uiRoot=new l("__SelectUI"),this.uiRoot.layer=this.node.layer,this.uiRoot.setParent(this.node),this.uiRoot.setPosition(0,0,0),this.frame=new l("Frame"),this.frame.layer=this.node.layer,this.frame.setParent(this.uiRoot);var e=this.frame.addComponent(c);e.lineWidth=this.FRAME_WIDTH,e.strokeColor=new d(255,60,60,255);var n=function(){var e=t.createFilledBox(t.HANDLE_SIZE,new d(0,0,0,255));return e.setParent(t.uiRoot),e.on(l.EventType.TOUCH_START,t.onScaleStart,t),e.on(l.EventType.TOUCH_MOVE,t.onScaleMove,t),e.on(l.EventType.TOUCH_END,t.onScaleEnd,t),e.on(l.EventType.TOUCH_CANCEL,t.onScaleEnd,t),e};this.handles=[n(),n(),n(),n()],this.handles[0].name="TL",this.handles[1].name="TR",this.handles[2].name="BL",this.handles[3].name="BR",this.closeBtn=new l("Close"),this.closeBtn.layer=this.node.layer,this.closeBtn.setParent(this.uiRoot),this.closeBtn.addComponent(h).setContentSize(this.CLOSE_SIZE,this.CLOSE_SIZE);var i=this.closeBtn.addComponent(S);this.closeIcon&&(i.spriteFrame=this.closeIcon),i.type=S.Type.SIMPLE,i.sizeMode=S.SizeMode.RAW,this.closeBtn.on(l.EventType.TOUCH_END,(function(){return t.node.destroy()}))},s.setSelected=function(t){this.uiRoot&&(this.uiRoot.active=t),t&&this.refreshSelectionUI()},s._getNodeScaleAbs=function(){var t=this.node.getScale();return{sx:Math.abs(t.x)||1,sy:Math.abs(t.y)||1}},s.refreshSelectionUI=function(){var t=this.node.getComponent(h),e=t.width+2*this.FRAME_MARGIN,n=t.height+2*this.FRAME_MARGIN,i=this._getNodeScaleAbs(),o=i.sx,s=i.sy,a=1/o,r=1/s,l=e*o,d=n*s;this.frame.setScale(a,r,1);var u=this.frame.getComponent(c);u.clear(),u.lineWidth=this.FRAME_WIDTH,u.moveTo(-l/2,-d/2),u.lineTo(l/2,-d/2),u.lineTo(l/2,d/2),u.lineTo(-l/2,d/2),u.close(),u.stroke();for(var p=[{x:-e/2,y:n/2},{x:e/2,y:n/2},{x:-e/2,y:-n/2},{x:e/2,y:-n/2}],g=0;g<4;g++){var v=this.handles[g];v.setPosition(p[g].x,p[g].y),v.setScale(a,r,1)}var y=this.CLOSE_MARGIN;this.closeBtn.setPosition(-e/2-y*a,n/2+y*r);var f=this.closeBtn.getComponent(S);if(f&&f.spriteFrame){var m,M,E,I,T=f.spriteFrame,x=null!=(m=null==(M=T.originalSize)?void 0:M.width)?m:T.rect.width,_=null!=(E=null==(I=T.originalSize)?void 0:I.height)?E:T.rect.height,C=this.CLOSE_SIZE/Math.max(x,_);this.closeBtn.setScale(C*a,C*r,1)}else this.closeBtn.setScale(a,r,1)},s.onDown=function(t){var e;t.target!==this.node&&null!=(e=t.target)&&e.isChildOf(this.uiRoot)||(this.selectMe(),this.dragging=!0,this.dragStart=this.getLocalPoint(t),this.nodeStart=this.node.getPosition())},s.onMove=function(t){if(this.dragging){var e=this.getLocalPoint(t),n=e.x-this.dragStart.x,i=e.y-this.dragStart.y,o=new u(this.nodeStart.x+n,this.nodeStart.y+i,0);this.clampToParent(o),this.node.setPosition(o)}},s.onUp=function(){this.dragging=!1},s.onScaleStart=function(t){this.selectMe(),this.scaling=!0,this.centerAtStart=this.node.getPosition().clone();var e=this.getLocalPoint(t),n=new u(e.x-this.centerAtStart.x,e.y-this.centerAtStart.y,0);this.radiusStart=Math.max(1,Math.hypot(n.x,n.y)),this.scaleStart=Math.abs(this.node.getScale().x);var i=t.target;this.cornerIndex=["TL","TR","BL","BR"].indexOf(i.name),t.propagationStopped=!0},s.onScaleMove=function(t){if(this.scaling){var e=this.getLocalPoint(t),n=new u(e.x-this.centerAtStart.x,e.y-this.centerAtStart.y,0),i=Math.max(1,Math.hypot(n.x,n.y))/this.radiusStart,o=this.scaleStart*i;o=Math.max(this.scaleMin,Math.min(this.scaleMax,o));var s=this.node.getScale().x<0?-1:1;this.node.setScale(s*o,o,1),this.refreshSelectionUI()}},s.onScaleEnd=function(){this.scaling=!1},s.clampToParent=function(t){var e=this.parentUI.width/2,n=this.parentUI.height/2;t.x=Math.max(-e,Math.min(e,t.x)),t.y=Math.max(-n,Math.min(n,t.y))},s.getLocalPoint=function(t){var e=t.getUILocation();return this.parentUI.convertToNodeSpaceAR(new u(e.x,e.y,0))},e}(p))._selected=null,m=e((f=M).prototype,"closeIcon",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=f))||y));s._RF.pop()}}}));

System.register("chunks:///_virtual/DevTest.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts","./GameManager.ts"],(function(e){var t,n,r,a,u,i,c,o,s,l,p,f,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,a=e.assertThisInitialized,u=e.asyncToGenerator,i=e.regeneratorRuntime},function(e){c=e.cclegacy,o=e._decorator,s=e.EditBox,l=e.Component,p=e.find},function(e){f=e.DataManager},function(e){h=e.GameManager}],execute:function(){var d,y,v,g,D,x,m;c._RF.push({},"fe63dMrY9ZGCr/R8Zz3KSud","DevTest",void 0);var b=o.ccclass,w=o.property;e("DevTest",(d=b("DevTest"),y=w(s),v=w(s),d((x=t((D=function(e){function t(){for(var t,n=arguments.length,u=new Array(n),i=0;i<n;i++)u[i]=arguments[i];return t=e.call.apply(e,[this].concat(u))||this,r(t,"fishIdInput",x,a(t)),r(t,"tempInput",m,a(t)),t}n(t,e);var c=t.prototype;return c.onClearData=function(){f.clearPlayerData()},c.onHungerDeath=function(){var e=u(i().mark((function e(){var t,n,r,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=parseInt(this.fishIdInput.string),!isNaN(n)){e.next=4;break}return console.warn("Ë´ãËº∏ÂÖ•Ê≠£Á¢∫ÁöÑÈ≠ö ID"),e.abrupt("return");case 4:return e.next=6,null==(t=f.ready)?void 0:t.catch((function(){}));case 6:return e.next=8,f.getPlayerDataCached();case 8:if(r=e.sent){e.next=11;break}return e.abrupt("return");case 11:if(a=r.fishList.find((function(e){return e.id===n}))){e.next=15;break}return console.warn("Êâæ‰∏çÂà∞È≠ö ID: "+n),e.abrupt("return");case 15:return a.hunger=100,e.next=18,f.savePlayerDataWithCache(r);case 18:console.log("È≠ö "+a.name+" È£¢È§ìË®≠ÁÇ∫ 100ÔºåÂ∞áÊñº‰∏ãÊ¨°ÂïüÂãïËá™ÂãïÊ≠ª‰∫°");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.toHalfWidth=function(e){return e.replace(/[\uFF01-\uFF5E]/g,(function(e){return String.fromCharCode(e.charCodeAt(0)-65248)})).replace(/\u3000/g," ")},c.onSetTemperature=function(){var e=u(i().mark((function e(){var t,n,r,a,u,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.tempInput){e.next=3;break}return console.warn("tempInput Ê≤íÊúâÂú®Á∑®ËºØÂô®Á∂ÅÂÆöÂà∞ DevTestÔºÅ"),e.abrupt("return");case 3:if(r=null!=(t=this.tempInput.string)?t:"",a=this.toHalfWidth(r).trim(),u=parseFloat(a),isFinite(u)){e.next=9;break}return console.warn('Ë´ãËº∏ÂÖ•Êï∏Â≠óÊ∞¥Ê∫´ÔºàÁõÆÂâçËº∏ÂÖ•: "'+r+'" -> "'+a+'"Ôºâ'),e.abrupt("return");case 9:return e.next=11,null==(n=f.ready)?void 0:n.catch((function(){}));case 11:return e.next=13,f.getPlayerDataCached();case 13:if(c=e.sent){e.next=16;break}return e.abrupt("return");case 16:return c.tankEnvironment.temperature=u,e.next=19,f.savePlayerDataWithCache(c);case 19:console.log("Ê∞¥Ê∫´Â∑≤Ë®≠ÁÇ∫ "+u+"¬∞C");case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.onSetWaterClean=function(){var e=u(i().mark((function e(){var t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(t=f.ready)?void 0:t.catch((function(){}));case 2:return e.next=4,f.getPlayerDataCached();case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return");case 7:return n.tankEnvironment.waterQualityStatus="clean",e.next=10,f.savePlayerDataWithCache(n);case 10:console.log("Ê∞¥Ë≥™Â∑≤Ë®≠ÁÇ∫‰πæÊ∑®");case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c.onSetWaterDirty=function(){var e=u(i().mark((function e(){var t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(t=f.ready)?void 0:t.catch((function(){}));case 2:return e.next=4,f.getPlayerDataCached();case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return");case 7:return n.tankEnvironment.waterQualityStatus="dirty",e.next=10,f.savePlayerDataWithCache(n);case 10:console.log("Ê∞¥Ë≥™Â∑≤Ë®≠ÁÇ∫È´í");case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c.onSimulateDirtyAndSickToday=function(){var e=u(i().mark((function e(){var t,n,r,a,u,c,o,s,l,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(t=f.ready)?void 0:t.catch((function(){}));case 2:return e.next=4,f.getPlayerDataCached();case 4:if(a=e.sent){e.next=7;break}return e.abrupt("return");case 7:return(u=a.tankEnvironment).waterQualityStatus="dirty",u.loginDaysSinceClean=Math.max(1,null!=(n=u.loginDaysSinceClean)?n:0),u.badEnvLoginDays=1,c=new Date,o=new Date(c.getTime()-864e5),a.lastLoginDate=o.toISOString().split("T")[0],a.lastLoginTime=o.toISOString(),s=JSON.stringify(a,null,2),e.next=18,f.savePlayerDataWithCache(a);case 18:return l=e.sent,console.log("ÈÄÅÂá∫ÁöÑ data:",s),console.log("‰º∫ÊúçÂô®ÂõûÂÇ≥ fresh:",JSON.stringify(l,null,2)),d=null==(r=p("/GameManager"))?void 0:r.getComponent(h),e.next=24,null==d?void 0:d.processDailyUpdate();case 24:console.log("‰ªäÊó•Ê∞¥Ë≥™ÁÇ∫È´íÔºå‰∏î‰æùÁ∑©Ë°ùÊ©üÂà∂ËÆì‰∏ÄÈöªÈ≠öÊÑüÂÜí„ÄÇ");case 25:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t}(l)).prototype,"fishIdInput",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=t(D.prototype,"tempInput",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=D))||g));c._RF.pop()}}}));

System.register("chunks:///_virtual/ExpandMenu.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,e,i,o,a,s,l,p,c,r,u,h,g,f;return{setters:[function(n){t=n.applyDecoratedDescriptor,e=n.inheritsLoose,i=n.initializerDefineProperty,o=n.assertThisInitialized},function(n){a=n.cclegacy,s=n._decorator,l=n.Node,p=n.input,c=n.Input,r=n.UIOpacity,u=n.Vec3,h=n.tween,g=n.UITransform,f=n.Component}],execute:function(){var T,_,d,v,y,w,m,B,C;a._RF.push({},"487a7VYpdpMYrEVpwVZ65C0","ExpandMenu",void 0);var E=s.ccclass,b=s.property;n("ExpandMenu",(T=E("ExpandMenu"),_=b(l),d=b(l),v=b(l),T((m=t((w=function(n){function t(){for(var t,e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];return t=n.call.apply(n,[this].concat(a))||this,i(t,"panel",m,o(t)),i(t,"content",B,o(t)),i(t,"toggleBtn",C,o(t)),t._isOpen=!1,t._isAnimating=!1,t._openTween=void 0,t._closeTween=void 0,t}e(t,n);var a=t.prototype;return a.onLoad=function(){this.initPanelState(!1),this.toggleBtn.on(l.EventType.TOUCH_END,this.onToggle,this),p.on(c.EventType.TOUCH_START,this.onBackgroundTouch,this)},a.onDestroy=function(){var n,t;this.toggleBtn.off(l.EventType.TOUCH_END,this.onToggle,this),p.off(c.EventType.TOUCH_START,this.onBackgroundTouch,this),null==(n=this._openTween)||n.stop(),null==(t=this._closeTween)||t.stop()},a.initPanelState=function(n){var t,e=null!=(t=this.panel.getComponent(r))?t:this.panel.addComponent(r);n?(this.panel.active=!0,this.panel.scale=new u(1,1,1),e.opacity=255):(this.panel.active=!1,this.panel.scale=new u(.8,.8,.8),e.opacity=0)},a.onToggle=function(){this._isAnimating||(this._isOpen?this.close():this.open())},a.open=function(){var n,t=this,e=this.panel.getComponent(r);this.panel.active=!0,this.panel.scale=new u(.8,.8,.8),e.opacity=0,null==(n=this._closeTween)||n.stop(),this._isAnimating=!0,this._openTween=h(this.panel).parallel(h(this.panel).to(.15,{scale:new u(1.02,1.02,1.02)}),h(e).to(.15,{opacity:255})).to(.08,{scale:new u(1,1,1)}).call((function(){t._isAnimating=!1,t._isOpen=!0})).start()},a.close=function(){var n,t=this,e=this.panel.getComponent(r);null==(n=this._openTween)||n.stop(),this._isAnimating=!0,this._closeTween=h(this.panel).to(.12,{scale:new u(.92,.92,.92)}).parallel(h(this.panel).to(.12,{scale:new u(.8,.8,.8)}),h(e).to(.12,{opacity:0})).call((function(){t.panel.active=!1,t._isAnimating=!1,t._isOpen=!1})).start()},a.onBackgroundTouch=function(n){if(this._isOpen&&!this._isAnimating){var t=n.getUILocation();this.isPointInNode(this.panel,t)||this.isPointInNode(this.toggleBtn,t)||this.close()}},a.isPointInNode=function(n,t){var e=n.getComponent(g);return!!e&&e.getBoundingBoxToWorld().contains(t)},t}(f)).prototype,"panel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(w.prototype,"content",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=t(w.prototype,"toggleBtn",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=w))||y));a._RF.pop()}}}));

System.register("chunks:///_virtual/FashionManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(a){var t,r,e,n,i,o,c,s;return{setters:[function(a){t=a.applyDecoratedDescriptor,r=a.inheritsLoose,e=a.initializerDefineProperty,n=a.assertThisInitialized},function(a){i=a.cclegacy,o=a._decorator,c=a.SpriteFrame,s=a.Component}],execute:function(){var u,h,l,p,f,_;i._RF.push({},"3a1a9A+sm9IkZRXG05GL8HL","FashionManager",void 0);var g=o.ccclass,m=o.property;a("FashionManager",(u=g("FashionManager"),h=m([c]),u(((_=function(a){function t(){for(var t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=a.call.apply(a,[this].concat(i))||this,e(t,"hatFrames",f,n(t)),t.map={},t}return r(t,a),t.prototype.onLoad=function(){var a=this;t.inst=this;["acc_bowtie","hat_chef","hat_fedora","acc_sunglass","hat_crown","acc_flower","acc_heart_glass","hat_magic","hat_beret","hat_party"].forEach((function(t,r){return a.map[t]=a.hatFrames[r]}))},t.get=function(a){var t;return(null==(t=this.inst)?void 0:t.map[a])||null},t}(s)).inst=void 0,f=t((p=_).prototype,"hatFrames",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=p))||l));i._RF.pop()}}}));

System.register("chunks:///_virtual/FishAnimate.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var i,t,n,r,o,s,a,l,u,c;return{setters:[function(e){i=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,s=e._decorator,a=e.Node,l=e.tween,u=e.Vec3,c=e.Component}],execute:function(){var g,f,p,h,w,y,b,d,m;o._RF.push({},"cfec2qXdB1LZKH61R24EaR1","FishAnimate",void 0);var A=s.ccclass,v=s.property;e("FishPartsRotateSwing",(g=A("FishAnimate"),f=v({type:a}),p=v({type:a}),g((y=i((w=function(e){function i(){for(var i,t=arguments.length,o=new Array(t),s=0;s<t;s++)o[s]=arguments[s];return i=e.call.apply(e,[this].concat(o))||this,n(i,"fishHand",y,r(i)),n(i,"fishTail",b,r(i)),n(i,"swingAngle",d,r(i)),n(i,"swingTime",m,r(i)),i}t(i,e);var o=i.prototype;return o.start=function(){this.swingNodeRotate(this.fishHand,this.swingAngle,this.swingTime),this.swingNodeRotate(this.fishTail,this.swingAngle,this.swingTime)},o.swingNodeRotate=function(e,i,t){if(e){var n=e.eulerAngles.clone();!function r(){l(e).to(t/2,{eulerAngles:new u(n.x,n.y,n.z+i)}).to(t,{eulerAngles:new u(n.x,n.y,n.z-i)}).to(t/2,{eulerAngles:n}).call(r).start()}()}},i}(c)).prototype,"fishHand",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=i(w.prototype,"fishTail",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=i(w.prototype,"swingAngle",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),m=i(w.prototype,"swingTime",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),h=w))||h));o._RF.pop()}}}));

System.register("chunks:///_virtual/FishDetailManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SwimmingFish.ts","./FishLogic.ts","./GameManager.ts","./DataManager.ts","./UIUtils.ts","./ConfirmDialogManager.ts","./FashionManager.ts","./ChoosePartnerDialog.ts","./FriendPanel.ts"],(function(e){var t,n,r,i,a,o,s,u,l,c,h,f,d,p,g,b,m,y,v,C,x,w,P,k,F,D,I,T,L,B,N,M,S,E,O;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.asyncToGenerator,i=e.regeneratorRuntime,a=e.initializerDefineProperty,o=e.assertThisInitialized,s=e.extends,u=e.createForOfIteratorHelperLoose},function(e){l=e.cclegacy,c=e._decorator,h=e.Node,f=e.Label,d=e.Sprite,p=e.Prefab,g=e.SpriteFrame,b=e.EditBox,m=e.Color,y=e.Button,v=e.UIOpacity,C=e.Tween,x=e.UITransform,w=e.Vec3,P=e.tween,k=e.Component,F=e.instantiate},function(e){D=e.SwimmingFish},function(e){I=e.FishLogic},function(e){T=e.GameManager},function(e){L=e.DataManager},function(e){B=e.showFloatingTextCenter,N=e.playOpenPanelAnim},function(e){M=e.ConfirmDialogManager},function(e){S=e.FashionManager},function(e){E=e.ChoosePartnerDialog},function(e){O=e.FriendPanel}],execute:function(){var z,_,U,R,H,A,G,W,K,V,Y,q,j,J,Q,X,Z,$,ee,te,ne,re,ie,ae,oe,se,ue,le,ce,he,fe,de,pe,ge,be,me,ye,ve,Ce,xe,we,Pe,ke,Fe,De,Ie,Te,Le,Be,Ne,Me,Se,Ee,Oe,ze,_e,Ue,Re,He,Ae,Ge,We,Ke,Ve,Ye,qe,je,Je,Qe,Xe,Ze,$e,et,tt,nt,rt,it,at,ot,st,ut,lt,ct,ht,ft,dt,pt,gt,bt,mt,yt;l._RF.push({},"87e56rnJ5NE5Yy1vwwEWYcu","FishDetailManager",void 0);var vt=c.ccclass,Ct=c.property,xt={acc_bowtie:{slot:"head",name:"Ëù¥Ëù∂Áµê",iconIndex:0},hat_chef:{slot:"head",name:"ÂªöÂ∏´Â∏Ω",iconIndex:1},hat_fedora:{slot:"head",name:"Á¥≥Â£´Â∏Ω",iconIndex:2},acc_sunglass:{slot:"head",name:"Â¢®Èè°",iconIndex:3},hat_crown:{slot:"head",name:"ÁöáÂÜ†",iconIndex:4},acc_flower:{slot:"head",name:"Ëä±Áí∞",iconIndex:5},acc_heart_glass:{slot:"head",name:"ÊÑõÂøÉÁúºÈè°",iconIndex:6},hat_magic:{slot:"head",name:"È≠îÊ≥ïÂ∏Ω",iconIndex:7},hat_beret:{slot:"head",name:"Áï´ÂÆ∂Â∏Ω",iconIndex:8},hat_party:{slot:"head",name:"Ê¥æÂ∞çÂ∏Ω",iconIndex:9}};e("FishDetailManager",(z=vt("FishDetailManager"),_=Ct(M),U=Ct(h),R=Ct(h),H=Ct(f),A=Ct(f),G=Ct(h),W=Ct(f),K=Ct(f),V=Ct(f),Y=Ct(d),q=Ct(f),j=Ct(f),J=Ct([h]),Q=Ct(h),X=Ct(h),Z=Ct(h),$=Ct(f),ee=Ct(f),te=Ct(h),ne=Ct(h),re=Ct(f),ie=Ct(h),ae=Ct(f),oe=Ct(h),se=Ct(f),ue=Ct(h),le=Ct(f),ce=Ct(h),he=Ct(h),fe=Ct(p),de=Ct(h),pe=Ct(g),ge=Ct(g),be=Ct(g),me=Ct(g),ye=Ct(g),ve=Ct(g),Ce=Ct(g),xe=Ct(h),we=Ct(b),Pe=Ct(h),ke=Ct(h),Fe=Ct(h),De=Ct(T),z((Le=t((Te=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=e.call.apply(e,[this].concat(r))||this,a(t,"confirmDialogManager",Le,o(t)),a(t,"floatingNode",Be,o(t)),a(t,"fishDetailPanel",Ne,o(t)),a(t,"fishNameLabel",Me,o(t)),a(t,"stageLabel",Se,o(t)),a(t,"renameButton",Ee,o(t)),a(t,"genderLabel",Oe,o(t)),a(t,"daysLabel",ze,o(t)),a(t,"hungerLabel",_e,o(t)),a(t,"fishStatusImage",Ue,o(t)),a(t,"floatingText",Re,o(t)),a(t,"marriageLabel",He,o(t)),a(t,"tabButtons",Ae,o(t)),a(t,"feedSection",Ge,o(t)),a(t,"feedBtnNormal",We,o(t)),a(t,"feedBtnPremium",Ke,o(t)),a(t,"feedNormalCountLabel",Ve,o(t)),a(t,"feedPremiumCountLabel",Ye,o(t)),a(t,"healSection",qe,o(t)),a(t,"genderPotionBtn",je,o(t)),a(t,"genderPotionCountLabel",Je,o(t)),a(t,"upgradePotionBtn",Qe,o(t)),a(t,"upgradePotionCountLabel",Xe,o(t)),a(t,"coldMedicineBtn",Ze,o(t)),a(t,"coldMedicineCountLabel",$e,o(t)),a(t,"changePotionBtn",et,o(t)),a(t,"changePotionCountLabel",tt,o(t)),a(t,"fashionSection",nt,o(t)),a(t,"fashionGrid",rt,o(t)),a(t,"ownedItemCardPrefab",it,o(t)),a(t,"closeButton",at,o(t)),a(t,"happySprite",ot,o(t)),a(t,"sadSprite",st,o(t)),a(t,"angrySprite",ut,o(t)),a(t,"hungrySprite",lt,o(t)),a(t,"coldSprite",ct,o(t)),a(t,"hotSprite",ht,o(t)),a(t,"sickSprite",ft,o(t)),a(t,"RenamePanel",dt,o(t)),a(t,"renameInput",pt,o(t)),a(t,"renameConfirmButton",gt,o(t)),a(t,"renameCancelButton",bt,o(t)),a(t,"chooseDialogNode",mt,o(t)),a(t,"gameManager",yt,o(t)),t.currentFishId=-1,t.isReadOnly=!1,t._currentTab="feed",t._tabKeys=["feed","heal","fashion"],t._tabSections=void 0,t.chooseDialog=void 0,t}n(t,e);var l=t.prototype;return l.onLoad=function(){var e=this;this.chooseDialog=this.chooseDialogNode.getComponent(E);var t=this.node.scene.getComponentInChildren(T);null==t||t.node.on("marriage-updated",r(i().mark((function t(n){var r,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n&&(e.currentFishId===n.fishId||e.currentFishId===n.spouseId)){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,L.getPlayerDataCached({refresh:!0});case 4:r=t.sent,(a=r.fishList.find((function(t){return t.id===e.currentFishId})))&&e.showFishDetail(a,void 0,{preserveTab:!0});case 7:case"end":return t.stop()}}),t)}))))},l.start=function(){var e=this;D.setEmotionFrames({happy:this.happySprite,sad:this.sadSprite,angry:this.angrySprite,hungry:this.hungrySprite,cold:this.coldSprite,hot:this.hotSprite,sick:this.sickSprite}),this._tabSections={feed:this.feedSection,heal:this.healSection,fashion:this.fashionSection};for(var t=function(){var t=e._tabKeys[n],a=e.tabButtons[n];a.off(h.EventType.TOUCH_END),a.on(h.EventType.TOUCH_END,r(i().mark((function n(){var r,a;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.isReadOnly||"heal"!==t&&"fashion"!==t){n.next=3;break}return B(e.floatingNode,"ÊúãÂèãÁöÑÈ≠öÁº∏Âè™ËÉΩÁÄèË¶ΩÔºåÁÑ°Ê≥ï‰ΩøÁî®ÈÄôÂÄãÂàÜÈ†Å"),n.abrupt("return");case 3:if("fashion"!==t){n.next=11;break}return n.next=6,e.getCurrentFishAndPlayer();case 6:if(r=n.sent,(a=r.fish)&&!(a.stage<6)){n.next=11;break}return B(e.floatingNode,"ÈúÄË¶ÅÈÅîÂà∞Á¨¨ 6 ÈöéÊâçËÉΩ‰ΩøÁî®ÊôÇË£ù"),n.abrupt("return");case 11:e.switchTab(t);case 12:case"end":return n.stop()}}),n)}))))},n=0;n<this.tabButtons.length;n++)t();this.closeButton.on(h.EventType.TOUCH_END,this.closeFishDetail,this),this.renameButton.on(h.EventType.TOUCH_END,this.showRenamePanel,this),this.renameConfirmButton.on(h.EventType.TOUCH_END,this.renameFish,this),this.renameCancelButton.on(h.EventType.TOUCH_END,this.hideRenamePanel,this)},l.showFishDetail=function(){var e=r(i().mark((function e(t,n,r){var a,o,s,u,l,c,f,d,p,g,b,m,v,C,x,w;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.getPlayerDataCached({refresh:!0});case 2:if(o=e.sent,(s=o.fishList.find((function(e){return e.id===t.id})))&&(t=s),N(this.fishDetailPanel),this.currentFishId=t.id,this.isReadOnly=!(null==r||!r.readOnly),u=!(null==r||!r.preserveTab),l=this.isReadOnly?"feed":u?this._currentTab:"feed",this.switchTab(l),this.fishNameLabel.string=t.name,this.genderLabel.string="ÊÄßÂà•Ôºö"+("male"===t.gender?"ÂÖ¨":"ÊØç"),this.daysLabel.string="Â∑≤ÊàêÈï∑Â§©Êï∏Ôºö"+t.growthDaysPassed,this.stageLabel.string="LV "+t.stage,this.hungerLabel.string="È£¢È§ìÂÄºÔºö"+Math.floor(t.hunger)+" / 100",c=o,f="",t.isMarried&&null!=t.spouseId&&t.spouseOwnerGameId===c.gameId&&(f=null!=(d=null==(p=c.fishList.find((function(e){return e.id===t.spouseId})))?void 0:p.name)?d:""),this.marriageLabel.string=t.isMarried?"Â©öÂßªÔºöÂ∑≤ÁµêÂ©ö"+(f?"ÔºàÂ∞çË±°Ôºö"+f+"Ôºâ":""):"Â©öÂßªÔºöÊú™ÁµêÂ©ö",g=!this.isReadOnly,b=!this.isReadOnly&&(null!=(a=t.stage)?a:1)>=3,this.setButtonEnabled(this.tabButtons[1],g),this.setButtonEnabled(this.tabButtons[2],b),!this.isReadOnly){e.next=29;break}this.feedNormalCountLabel.string="-",this.feedPremiumCountLabel.string="-",e.next=38;break;case 29:return e.next=31,L.getPlayerDataCached();case 31:m=e.sent,this.feedNormalCountLabel.string=m.inventory.feeds.normal.toString(),this.feedPremiumCountLabel.string=m.inventory.feeds.premium.toString(),this.genderPotionCountLabel.string=m.inventory.items.genderPotion.toString(),this.upgradePotionCountLabel.string=m.inventory.items.upgradePotion.toString(),this.changePotionCountLabel.string=m.inventory.items.changePotion.toString(),this.coldMedicineCountLabel.string=m.inventory.items.coldMedicine.toString();case 38:if(this.feedBtnNormal.off(h.EventType.TOUCH_END),this.feedBtnPremium.off(h.EventType.TOUCH_END),this.genderPotionBtn.off(h.EventType.TOUCH_END),this.upgradePotionBtn.off(h.EventType.TOUCH_END),this.coldMedicineBtn.off(h.EventType.TOUCH_END),this.changePotionBtn.off(h.EventType.TOUCH_END),this.isReadOnly||(this.feedBtnNormal.on(h.EventType.TOUCH_END,this.feedNormal,this),this.feedBtnPremium.on(h.EventType.TOUCH_END,this.feedPremium,this),this.genderPotionBtn.on(h.EventType.TOUCH_END,this.onUseGenderPotion,this),this.upgradePotionBtn.on(h.EventType.TOUCH_END,this.onUseUpgradePotion,this),this.coldMedicineBtn.on(h.EventType.TOUCH_END,this.onUseColdMedicine,this),this.changePotionBtn.on(h.EventType.TOUCH_END,this.onUseChangePotion,this)),this.feedBtnNormal.getComponent(y).interactable=!this.isReadOnly,this.feedBtnPremium.getComponent(y).interactable=!this.isReadOnly,!n){e.next=51;break}this.fishStatusImage.spriteFrame=n,e.next=57;break;case 51:return e.next=53,this.getCurrentFishAndPlayer();case 53:v=e.sent,C=v.env,(x=t.emotion)?this.fishStatusImage.spriteFrame=D.getEmotionSpriteByKey(x):(w=D.computeEmotion(t,C),this.fishStatusImage.spriteFrame=D.getEmotionSpriteByKey(w));case 57:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),l.feedNormal=function(){this.feedFish(3,"normal")},l.feedPremium=function(){this.feedFish(20,"premium")},l.feedFish=function(){var e=r(i().mark((function e(t,n){var r,a,o,s,u,l=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.getPlayerDataCached();case 2:if(r=e.sent,a=r.fishList.find((function(e){return e.id===l.currentFishId}))){e.next=6;break}return e.abrupt("return");case 6:if(!(a.hunger<=0)){e.next=9;break}return this.showFloatingTextRightOf(this.hungerLabel.node,"Â∑≤È£ΩÔºåÁÑ°ÈúÄÈ§µÈ£ü"),e.abrupt("return");case 9:return o=I.feed(a,r.inventory,t,n),console.log(o),e.next=13,L.savePlayerDataWithCache(r);case 13:this.hungerLabel.string="È£¢È§ìÂÄºÔºö"+Math.floor(a.hunger)+" / 100",this.feedNormalCountLabel.string=r.inventory.feeds.normal.toString(),this.feedPremiumCountLabel.string=r.inventory.feeds.premium.toString(),this.showFloatingTextRightOf(this.hungerLabel.node,"È§µÈ£ü -"+t),s=this.node.scene.getComponentsInChildren(D),null==(u=s.find((function(e){var t;return(null==(t=e.fishData)?void 0:t.id)===a.id})))||u.setFishData(a);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),l.renameFish=function(){var e=r(i().mark((function e(){var t,n,r,a=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.renameInput.string.trim()){e.next=4;break}return console.warn("ÂêçÂ≠ó‰∏çËÉΩÁÇ∫Á©∫ÔºÅ"),e.abrupt("return");case 4:return e.next=6,L.getPlayerDataCached();case 6:if(n=e.sent,r=n.fishList.find((function(e){return e.id===a.currentFishId}))){e.next=10;break}return e.abrupt("return");case 10:if(I.renameFish(r,t)){e.next=14;break}return console.warn("ÂêçÂ≠óÁÑ°Êïà"),e.abrupt("return");case 14:return e.next=16,L.savePlayerDataWithCache(n);case 16:this.hideRenamePanel(),this.showFishDetail(r);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.switchTab=function(e){var t=this;this.isReadOnly&&"feed"!==e&&(B(this.floatingNode,"ÊúãÂèãÁöÑÈ≠öÁº∏Âè™ËÉΩÁÄèË¶ΩÔºåÁÑ°Ê≥ï‰ΩøÁî®ÈÄôÂÄãÂàÜÈ†Å"),e="feed"),this._currentTab=e,this._tabKeys.forEach((function(n){return t._tabSections[n].active=n===e})),this.updateTabVisuals(),"fashion"!==e||this.isReadOnly||this.getCurrentFishAndPlayer().then((function(e){var n=e.fish;n&&t.renderFashionGrid(n)}))},l.updateTabVisuals=function(){var e=this,t=m.WHITE,n=new m(220,220,220,255);this.tabButtons.forEach((function(r,i){var a=e._tabKeys[i],o=r.getChildByName("Frame"),s=null==o?void 0:o.getComponent(d);s&&(s.color=a===e._currentTab?t:n)}))},l.onUseGenderPotion=function(){var e=this;this.getCurrentFishAndPlayer().then(r(i().mark((function t(n){var r,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.playerData,a=n.fish,r&&a){t.next=3;break}return t.abrupt("return");case 3:if(!(r.inventory.items.genderPotion<=0)){t.next=6;break}return B(e.floatingNode,"Ê≤íÊúâËÆäÊÄßËó•‰∫Ü"),t.abrupt("return");case 6:return t.next=8,e.confirmDialogManager.ask("Á¢∫ÂÆöË¶Å‰ΩøÁî®ËÆäÊÄßËó•ÂóéÔºü");case 8:if(t.sent){t.next=11;break}return t.abrupt("return");case 11:return t.next=13,e.useGenderPotion();case 13:case"end":return t.stop()}}),t)}))))},l.useGenderPotion=function(){var e=r(i().mark((function e(){var t,n,r,a,o=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.getPlayerDataCached();case 2:if(t=e.sent,n=t.fishList.find((function(e){return e.id===o.currentFishId}))){e.next=6;break}return e.abrupt("return");case 6:return r=I.useGenderPotion(n,t.inventory.items),e.next=9,L.savePlayerDataWithCache(t);case 9:return console.log(r),e.next=12,this.showFishDetail(n,void 0,{preserveTab:!0});case 12:this.showFloatingTextRightOf(this.genderLabel.node,"ËÆäÊÄßÂÆåÊàêÔºÅ"),(a=this.node.scene.getComponentInChildren(T))&&a.replaceFishNode(n);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.onUseUpgradePotion=function(){var e=this;this.getCurrentFishAndPlayer().then(r(i().mark((function t(n){var r,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.playerData,a=n.fish,r&&a){t.next=3;break}return t.abrupt("return");case 3:if(!(r.inventory.items.upgradePotion<=0)){t.next=6;break}return B(e.floatingNode,"Ê≤íÊúâÂçáÁ¥öËó•‰∫Ü"),t.abrupt("return");case 6:return t.next=8,e.confirmDialogManager.ask("Á¢∫ÂÆöË¶Å‰ΩøÁî®ÂçáÁ¥öËó•ÂóéÔºü");case 8:if(t.sent){t.next=11;break}return t.abrupt("return");case 11:return t.next=13,e.useUpgradePotion();case 13:case"end":return t.stop()}}),t)}))))},l.useUpgradePotion=function(){var e=r(i().mark((function e(){var t,n,r,a,o,s,u=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.getPlayerDataCached();case 2:if(t=e.sent,n=t.fishList.find((function(e){return e.id===u.currentFishId}))){e.next=6;break}return e.abrupt("return");case 6:return r=I.useUpgradePotion(n,t.inventory.items),a=r.message,o=r.upgraded,e.next=9,L.savePlayerDataWithCache(t);case 9:return console.log(a),e.next=12,this.showFishDetail(n,void 0,{preserveTab:!0});case 12:this.showFloatingTextRightOf(this.daysLabel.node,"ÊàêÈï∑Â§©Êï∏ +5"),o&&(s=this.node.scene.getComponentInChildren(T))&&s.replaceFishNode(n);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.onUseColdMedicine=function(){var e=this;this.getCurrentFishAndPlayer().then(r(i().mark((function t(n){var r,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.playerData,a=n.fish,r&&a){t.next=3;break}return t.abrupt("return");case 3:if(!(r.inventory.items.coldMedicine<=0)){t.next=6;break}return B(e.floatingNode,"Ê≤íÊúâÊÑüÂÜíËó•‰∫Ü"),t.abrupt("return");case 6:if(a.status&&a.status.sick){t.next=9;break}return B(e.floatingNode,"ÈÄôÈöªÈ≠öÊ≤íÊúâÁîüÁóÖ"),t.abrupt("return");case 9:return t.next=11,e.confirmDialogManager.ask("Á¢∫ÂÆöË¶Å‰ΩøÁî®ÊÑüÂÜíËó•ÂóéÔºü");case 11:if(t.sent){t.next=14;break}return t.abrupt("return");case 14:return t.next=16,e.useColdMedicine();case 16:case"end":return t.stop()}}),t)}))))},l.useColdMedicine=function(){var e=r(i().mark((function e(){var t,n,r,a,o,s,u=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.getPlayerDataCached();case 2:if(t=e.sent,n=t.fishList.find((function(e){return e.id===u.currentFishId}))){e.next=6;break}return e.abrupt("return");case 6:return r=I.useColdMedicine(n,t.inventory.items),a=r.message,o=r.cured,e.next=9,L.savePlayerDataWithCache(t);case 9:if(console.log(a),!o){e.next=16;break}return(s=this.node.scene.getComponentInChildren(T))&&s.replaceFishNode(n),this.showFloatingTextRightOf(this.fishStatusImage.node,"Â∑≤Ê≤ªÁôíÔºÅ"),e.next=16,this.showFishDetail(n,void 0,{preserveTab:!0});case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.onUseChangePotion=function(){var e=this;this.getCurrentFishAndPlayer().then(r(i().mark((function t(n){var r,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.playerData,a=n.fish,r&&a){t.next=3;break}return t.abrupt("return");case 3:if(!(r.inventory.items.changePotion<=0)){t.next=6;break}return B(e.floatingNode,"Ê≤íÊúâÊï¥ÂΩ¢Ëó•‰∫Ü"),t.abrupt("return");case 6:if(!(a.stage<6)){t.next=9;break}return B(e.floatingNode,"ÈúÄË¶ÅÈÅîÂà∞Á¨¨ 6 ÈöéÊâçËÉΩ‰ΩøÁî®Êï¥ÂΩ¢Ëó•"),t.abrupt("return");case 9:return t.next=11,e.confirmDialogManager.ask("Á¢∫ÂÆöË¶Å‰ΩøÁî®Êï¥ÂΩ¢Ëó•ÂóéÔºü");case 11:if(t.sent){t.next=14;break}return t.abrupt("return");case 14:return t.next=16,e.useChangePotion();case 16:case"end":return t.stop()}}),t)}))))},l.useChangePotion=function(){var e=r(i().mark((function e(){var t,n,r,a,o=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.getPlayerDataCached();case 2:if(t=e.sent,n=t.fishList.find((function(e){return e.id===o.currentFishId}))){e.next=6;break}return e.abrupt("return");case 6:return r=I.useChangePotion(n,t.inventory.items),e.next=9,L.savePlayerDataWithCache(t);case 9:return console.log(r),e.next=12,this.showFishDetail(n,void 0,{preserveTab:!0});case 12:(a=this.node.scene.getComponentInChildren(T))&&a.replaceFishNode(n);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.setButtonEnabled=function(e,t){var n;(null==(n=e.getComponent(y))?void 0:n.node)&&(e.getComponent(y).interactable=t);var r=e.getComponent(v);r||(r=e.addComponent(v)),r.opacity=t?255:120},l.getCurrentFishAndPlayer=function(){var e=r(i().mark((function e(){var t,n,r,a,o,s,u,l,c=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(t=this.node.scene.getComponentInChildren(T))||!t.isViewingFriend){e.next=6;break}return r=t.viewingFriend,a=null==r||null==(n=r.fishList)?void 0:n.find((function(e){return e.id===c.currentFishId})),o=null==r?void 0:r.tankEnvironment,e.abrupt("return",{playerData:null,fish:a,env:o,isFriend:!0});case 6:return e.next=8,L.getPlayerDataCached();case 8:return s=e.sent,u=null==s?void 0:s.fishList.find((function(e){return e.id===c.currentFishId})),l=null==s?void 0:s.tankEnvironment,e.abrupt("return",{playerData:s,fish:u,env:l,isFriend:!1});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.showFloatingTextRightOf=function(e,t){var n=this.floatingText.node,r=n.getComponent(v);if(r){C.stopAllByTarget(n),C.stopAllByTarget(r),this.floatingText.string=t,n.active=!0,r.opacity=0;var i=e.getComponent(x).getBoundingBoxToWorld(),a=new w(i.xMax+10,(i.yMin+i.yMax)/2,0),o=n.parent.getComponent(x).convertToNodeSpaceAR(a);n.setPosition(o);var s=o.clone().add(new w(0,30,0));P(r).to(.1,{opacity:255}).delay(.4).to(.2,{opacity:0}).call((function(){return n.active=!1})).start(),P(n).to(.6,{position:s},{easing:"quadOut"}).start()}else console.warn("FloatingText node is missing UIOpacity component!")},l.hideAllSubPanels=function(){this.RenamePanel.active=!1},l.closeFishDetail=function(){this.fishDetailPanel.active=!1,this.hideAllSubPanels(),D.clearSelection()},l.showRenamePanel=function(){var e=r(i().mark((function e(){var t,n,r=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.getPlayerDataCached();case 2:if(t=e.sent,n=t.fishList.find((function(e){return e.id===r.currentFishId}))){e.next=6;break}return e.abrupt("return");case 6:this.renameInput.string=n.name,this.RenamePanel.active=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.hideRenamePanel=function(){this.RenamePanel.active=!1},l.renderFashionGrid=function(){var e=r(i().mark((function e(t){var n,a,o,l,c,p,g,b,m,C,x=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.fashionGrid.removeAllChildren(),e.next=3,L.getPlayerDataCached();case 3:l=e.sent,c=(null!=(n=null==(a=l.fashion)?void 0:a.owned)?n:[]).filter((function(e){return!!xt[e]})),p=c.map((function(e){return s({id:e},xt[e],{icon:S.get(e)})})),g=(null!=(o=t.stage)?o:1)>=6,b=i().mark((function e(){var n,a,o,s,u,l,c,p,b,m,w;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=C.value,u=F(x.ownedItemCardPrefab),l=u.getChildByName("Frame"),c=null==l||null==(n=l.getChildByName("ItemImage"))?void 0:n.getComponent(d),p=null==(a=u.getChildByName("NameLabel"))?void 0:a.getComponent(f),b=u.getChildByName("EquippedBadge"),m=u.getComponent(y)||u.addComponent(y),w=u.getComponent(v)||u.addComponent(v),c.spriteFrame=s.icon,p.string=s.name,b.active=(null==(o=t.outfit)?void 0:o.head)===s.id,m.interactable=g&&!x.isReadOnly,w.opacity=g&&!x.isReadOnly?255:120,u.on(h.EventType.TOUCH_END,r(i().mark((function e(){var n,r,a,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m.interactable){e.next=3;break}return B(x.floatingNode,"ÈúÄË¶ÅÈÅîÂà∞Á¨¨ 6 ÈöéÊâçËÉΩ‰ΩøÁî®ÊôÇË£ù"),e.abrupt("return");case 3:return e.next=5,L.getPlayerDataCached();case 5:if(r=e.sent,a=r.fishList.find((function(e){return e.id===t.id}))){e.next=9;break}return e.abrupt("return");case 9:return a.outfit=null!=(n=a.outfit)?n:{head:null,accessories:[]},a.outfit.head=a.outfit.head===s.id?null:s.id,e.next=13,L.savePlayerDataWithCache(r);case 13:return e.next=15,x.showFishDetail(a,void 0,{preserveTab:!0});case 15:o=x.node.scene.getComponentsInChildren(D),(u=o.find((function(e){var t;return(null==(t=e.fishData)?void 0:t.id)===a.id})))&&(u.setFishData(a),u.refreshOutfit());case 18:case"end":return e.stop()}}),e)})))),x.fashionGrid.addChild(u);case 15:case"end":return e.stop()}}),e)})),m=u(p);case 9:if((C=m()).done){e.next=13;break}return e.delegateYield(b(),"t0",11);case 11:e.next=9;break;case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),l.onClickMarry=function(){var e=r(i().mark((function e(){var t,n,r,a,o,s,l,c,h;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("[MarryClick][v2] onClickMarry Ë¢´Êåâ‰∏ã, currentFishId =",this.currentFishId),!(this.currentFishId<0)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.getCurrentFishAndPlayer();case 5:if(n=e.sent,r=n.fish){e.next=9;break}return e.abrupt("return");case 9:if(!r.isMarried){e.next=12;break}return B(this.floatingNode,"ÈÄôÊ¢ùÈ≠öÂ∑≤Á∂ìÁµêÂ©öÂõâ üíç"),e.abrupt("return");case 12:if(!((null!=(t=r.stage)?t:0)<6)){e.next=15;break}return B(this.floatingNode,"ÈúÄË¶ÅÈÅîÂà∞Á¨¨ 6 ÈöéÊâçËÉΩÁµêÂ©öÔºÅ"),e.abrupt("return");case 15:return console.log("[MarryClick][v2] currentUserId =",L.currentUserId,"apiBase =",L.apiBase),a=[],e.prev=17,e.next=20,L.getFriends().catch((function(e){return console.warn("[MarryClick][v2] getFriends Â§±ÊïóÔºö",e),[]}));case 20:o=e.sent,console.log("[MarryClick][v2] Â•ΩÂèãÊï∏ =",o.length,o),s=i().mark((function e(){var t,n,r,o,s,l,h,f,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.value,e.next=3,L.getPublicPlayerData(r.userId).catch((function(e){return console.warn("[MarryClick][v2] ÂèñÂ•ΩÂèãÂÖ¨ÈñãË≥áÊñôÂ§±Êïó",r.userId,e),null}));case 3:if(o=e.sent){e.next=6;break}return e.abrupt("return",1);case 6:for(s=null!=(t=o.gameId)?t:r.userId,l=null!=(n=o.fishList)?n:[],console.log("[MarryClick][v2] ÂÖ¨ÈñãË≥áÊñô",r.userId,"gameId=",o.gameId,"fishList # =",l.length),h=u(l);!(f=h()).done;)d=f.value,console.log(" [MarryClick][v2] friend fish -> id=",d.id,"name=",d.name,"stage=",d.stage,"isMarried=",d.isMarried,"isDead=",d.isDead),a.push({ownerGameId:s,fish:d});case 10:case"end":return e.stop()}}),e)})),l=u(o);case 24:if((c=l()).done){e.next=30;break}return e.delegateYield(s(),"t0",26);case 26:if(!e.t0){e.next=28;break}return e.abrupt("continue",28);case 28:e.next=24;break;case 30:console.log("[MarryClick][v2] ÂΩôÊï¥ÂÆåÊàêÔºàÊú™ÈÅéÊøæÔºâÔºåÊúãÂèãÈ≠öÁ∏ΩÊï∏ =",a.length),e.next=36;break;case 33:e.prev=33,e.t1=e.catch(17),console.error("[MarryClick][v2] ËÅöÂêàÊúãÂèãÂÄôÈÅ∏ÊôÇÁôºÁîüÈåØË™§",e.t1);case 36:if(this.chooseDialog.setFriendCandidatesProvider((function(){return console.log("[ChooseDialog][v2] ÂèñÁî® friendCandidatesRawÔºåÈï∑Â∫¶ =",a.length),a})),!(h=this.node.scene.getComponentInChildren(O))){e.next=42;break}return e.next=41,h.refreshFriendCandidates();case 41:this.chooseDialog.setFriendCandidatesProvider((function(){return h.getFriendMarriageCandidates()}));case 42:this.chooseDialog.openFor(r.id);case 43:case"end":return e.stop()}}),e,this,[[17,33]])})));return function(){return e.apply(this,arguments)}}(),l.onClickBreed=function(){var e=r(i().mark((function e(){var t,n,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.currentFishId<0)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getCurrentFishAndPlayer();case 4:if(t=e.sent,n=t.fish,r=t.isFriend,n){e.next=9;break}return e.abrupt("return");case 9:if(!r){e.next=12;break}return B(this.floatingNode,"ÊúãÂèãÁöÑÈ≠öÁÑ°Ê≥ïÂú®ÈÄôË£°ÁîüÈ≠öÂØ∂ÂØ∂"),e.abrupt("return");case 12:if(n.isMarried){e.next=15;break}return B(this.floatingNode,"ÈÇÑÊ≤íÁµêÂ©öÔºå‰∏çËÉΩÁîüÈ≠öÂØ∂ÂØ∂ÂñîÔºÅ"),e.abrupt("return");case 15:return e.next=17,this.gameManager.breedFish(this.currentFishId);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(k)).prototype,"confirmDialogManager",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Be=t(Te.prototype,"floatingNode",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ne=t(Te.prototype,"fishDetailPanel",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Me=t(Te.prototype,"fishNameLabel",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Se=t(Te.prototype,"stageLabel",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ee=t(Te.prototype,"renameButton",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Oe=t(Te.prototype,"genderLabel",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ze=t(Te.prototype,"daysLabel",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_e=t(Te.prototype,"hungerLabel",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ue=t(Te.prototype,"fishStatusImage",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Re=t(Te.prototype,"floatingText",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),He=t(Te.prototype,"marriageLabel",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ae=t(Te.prototype,"tabButtons",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ge=t(Te.prototype,"feedSection",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),We=t(Te.prototype,"feedBtnNormal",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ke=t(Te.prototype,"feedBtnPremium",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ve=t(Te.prototype,"feedNormalCountLabel",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ye=t(Te.prototype,"feedPremiumCountLabel",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),qe=t(Te.prototype,"healSection",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),je=t(Te.prototype,"genderPotionBtn",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Je=t(Te.prototype,"genderPotionCountLabel",[re],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qe=t(Te.prototype,"upgradePotionBtn",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xe=t(Te.prototype,"upgradePotionCountLabel",[ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ze=t(Te.prototype,"coldMedicineBtn",[oe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$e=t(Te.prototype,"coldMedicineCountLabel",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),et=t(Te.prototype,"changePotionBtn",[ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tt=t(Te.prototype,"changePotionCountLabel",[le],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),nt=t(Te.prototype,"fashionSection",[ce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rt=t(Te.prototype,"fashionGrid",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),it=t(Te.prototype,"ownedItemCardPrefab",[fe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),at=t(Te.prototype,"closeButton",[de],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ot=t(Te.prototype,"happySprite",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),st=t(Te.prototype,"sadSprite",[ge],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ut=t(Te.prototype,"angrySprite",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),lt=t(Te.prototype,"hungrySprite",[me],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ct=t(Te.prototype,"coldSprite",[ye],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ht=t(Te.prototype,"hotSprite",[ve],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ft=t(Te.prototype,"sickSprite",[Ce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),dt=t(Te.prototype,"RenamePanel",[xe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pt=t(Te.prototype,"renameInput",[we],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),gt=t(Te.prototype,"renameConfirmButton",[Pe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),bt=t(Te.prototype,"renameCancelButton",[ke],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mt=t(Te.prototype,"chooseDialogNode",[Fe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),yt=t(Te.prototype,"gameManager",[De],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ie=Te))||Ie));l._RF.pop()}}}));

System.register("chunks:///_virtual/FishFamilyService.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,t,a,n;return{setters:[function(e){r=e.createForOfIteratorHelperLoose,t=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"b2882h/PIVPk5r3Jd6Cr6mW","FishFamilyService",void 0);var s=e("COST_MARRIAGE",30),i=e("COST_BIRTH",50),d=e("ADULT_STAGE",6);e("FishFamilyService",function(){function e(e){this.adapter=e}var n=e.prototype;return n.findFishByIdAndOwner=function(e,r){var t;return null!=(t=r.fishList.find((function(r){return r.id===e})))?t:null},n.findFirstAvailableTankId=function(e){for(var t,a=[].concat(e.tankList).sort((function(e,r){return e.id-r.id})),n=r(a);!(t=n()).done;){var s,i=t.value,d=null!=(s=i.capacity)?s:1===i.id?3:6;if(i.fishIds.map((function(r){return e.fishList.find((function(e){return e.id===r}))})).filter((function(e){return!!e&&!e.isDead})).length<d)return i.id}return null},n.isAdult=function(e){return e.stage>=d},n.isAlive=function(e){return!e.isDead},n.canMarry=function(e,r,t,a){return this.isAdult(e)&&this.isAdult(t)?this.isAlive(e)&&this.isAlive(t)?e.isMarried||t.isMarried?{ok:!1,msg:"Âè™ËÉΩËàáÊú™Â©öÈ≠öÁµêÂ©ö"}:this.adapter.getMyPlayer().dragonBones<s?{ok:!1,msg:"ÈæçÈ™®‰∏çË∂≥ÔºàÈúÄË¶Å "+s+"Ôºâ"}:{ok:!0}:{ok:!1,msg:"ÂÖ∂‰∏≠‰∏ÄÊñπÂ∑≤Ê≠ª‰∫°"}:{ok:!1,msg:"ÈõôÊñπÈÉΩÈúÄË¶ÅÊòØÊàêÈ≠öÔºàLV6Ôºâ"}},n.marry=function(){var e=t(a().mark((function e(r,t,n,i){var d,u,o,p,c,l,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=this.adapter.getMyPlayer(),u=t===d.gameId?d:this.adapter.getPlayerByGameId(t),o=i===d.gameId?d:this.adapter.getPlayerByGameId(i),u&&o){e.next=6;break}return this.adapter.toast("Êâæ‰∏çÂà∞Áé©ÂÆ∂Ë≥áÊñô"),e.abrupt("return",!1);case 6:if(p=this.findFishByIdAndOwner(r,u),c=this.findFishByIdAndOwner(n,o),p&&c){e.next=11;break}return this.adapter.toast("Êâæ‰∏çÂà∞È≠ö"),e.abrupt("return",!1);case 11:if((l=this.canMarry(p,u,c,o)).ok){e.next=15;break}return this.adapter.toast(l.msg),e.abrupt("return",!1);case 15:return d.dragonBones-=s,h=(new Date).toISOString(),p.isMarried=!0,p.spouseId=c.id,p.spouseOwnerGameId=o.gameId,p.marriedAt=h,c.isMarried=!0,c.spouseId=p.id,c.spouseOwnerGameId=u.gameId,c.marriedAt=h,e.next=27,this.adapter.saveMyPlayer("marry");case 27:if(o.gameId===d.gameId){e.next=35;break}if(!this.adapter.canMutateOtherPlayer(o.gameId)){e.next=33;break}return e.next=31,this.adapter.saveOtherPlayer(o,"marry-cross");case 31:e.next=35;break;case 33:return e.next=35,this.adapter.enqueueMailFor(o.gameId,"marry",{type:"MARRY_APPLY",partnerId:p.id,partnerOwner:u.gameId,fishId:c.id,fishOwner:o.gameId,marriedAt:h});case 35:return this.adapter.toast("ÁµêÂ©öÊàêÂäüÔºÅÂ∑≤Ëä±Ë≤ª "+s+" ÈæçÈ™®"),e.abrupt("return",!0);case 37:case"end":return e.stop()}}),e,this)})));return function(r,t,a,n){return e.apply(this,arguments)}}(),n.canBreed=function(e,r,t,a){if(!e.isMarried||!t.isMarried)return{ok:!1,msg:"Â∞öÊú™ÁµêÂ©ö"};if(!this.isAlive(e)||!this.isAlive(t))return{ok:!1,msg:"ÂÖ∂‰∏≠‰∏ÄÊñπÂ∑≤Ê≠ª‰∫°"};if(e.gender===t.gender)return{ok:!1,msg:"ÁîüÈ≠öÂØ∂ÂØ∂ÈúÄË¶Å‰∏ÄÂÖ¨‰∏ÄÊØç"};var n=this.adapter.getMyPlayer(),s=a.gameId!==n.gameId,d=s?1:0,u=this.adapter.countEmptySlots(n),o=s?this.adapter.countEmptySlots(a):1/0;return u<1?{ok:!1,msg:"‰Ω†ÁöÑÈ≠öÁº∏Ê≤íÊúâÁ©∫‰Ωç"}:s&&o<d?{ok:!1,msg:"Â•ΩÂèãÈ≠öÁº∏Ê≤íÊúâÁ©∫‰Ωç"}:n.dragonBones<i?{ok:!1,msg:"ÈæçÈ™®‰∏çË∂≥ÔºàÈúÄË¶Å "+i+"Ôºâ"}:{ok:!0,cross:s}},n.breed=function(){var e=t(a().mark((function e(r){var t,n,s,d,u,o,p;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.adapter.getMyPlayer(),(n=this.findFishByIdAndOwner(r,t))&&n.isMarried&&n.spouseId&&n.spouseOwnerGameId){e.next=5;break}return this.adapter.toast("ÈÖçÂÅ∂Ë≥áË®ä‰∏çÂÆåÊï¥"),e.abrupt("return",!1);case 5:if(s=n.spouseOwnerGameId===t.gameId?t:this.adapter.getPlayerByGameId(n.spouseOwnerGameId)){e.next=9;break}return this.adapter.toast("Êâæ‰∏çÂà∞ÈÖçÂÅ∂ÊâÄÂ±¨Áé©ÂÆ∂"),e.abrupt("return",!1);case 9:if(d=this.findFishByIdAndOwner(n.spouseId,s)){e.next=13;break}return this.adapter.toast("Êâæ‰∏çÂà∞ÈÖçÂÅ∂"),e.abrupt("return",!1);case 13:if((u=this.canBreed(n,t,d,s)).ok){e.next=17;break}return this.adapter.toast(u.msg),e.abrupt("return",!1);case 17:if(null!=(o=this.findFirstAvailableTankId(t))){e.next=21;break}return this.adapter.toast("‰Ω†ÁöÑÈ≠öÁº∏Ê≤íÊúâÁ©∫‰Ωç"),e.abrupt("return",!1);case 21:if(p=null,!u.cross){e.next=27;break}if(null!=(p=this.findFirstAvailableTankId(s))){e.next=27;break}return this.adapter.toast("Â•ΩÂèãÈ≠öÁº∏Ê≤íÊúâÁ©∫‰Ωç"),e.abrupt("return",!1);case 27:return t.dragonBones-=i,e.next=30,this.adapter.addBabyFishToTank(t.gameId,o);case 30:if(!u.cross||null==p){e.next=38;break}if(!this.adapter.canMutateOtherPlayer(s.gameId)){e.next=36;break}return e.next=34,this.adapter.addBabyFishToTank(s.gameId,p);case 34:e.next=38;break;case 36:return e.next=38,this.adapter.enqueueMailFor(s.gameId,"new-baby",{type:"GRANT_BABY",suggestedTankId:p});case 38:return e.next=40,this.adapter.saveMyPlayer("breed");case 40:return this.adapter.toast("È≠öÂØ∂ÂØ∂Ë™ïÁîüÂï¶ÔºÅ"),e.abrupt("return",!0);case 42:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),n.dissolveOnDeath=function(e){if(!e.isMarried||null==e.spouseId||!e.spouseOwnerGameId)return!1;var r=this.adapter.getMyPlayer(),t=e.spouseOwnerGameId===r.gameId?r:this.adapter.getPlayerByGameId(e.spouseOwnerGameId),a=null==t?void 0:t.fishList.find((function(r){return r.id===e.spouseId}));return e.isMarried=!1,e.spouseId=null,e.spouseOwnerGameId=null,a&&(a.isMarried=!1,a.spouseId=null,a.spouseOwnerGameId=null),!0},e}());n._RF.pop()}}}));

System.register("chunks:///_virtual/FishLogic.ts",["cc"],(function(e){var n;return{setters:[function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"3c40aGigUFOeZwflbv+5hJh","FishLogic",void 0);e("FishLogic",function(){function e(){}return e.feed=function(e,n,t,r){return n.feeds[r]<=0?"Ê≤íÊúâ "+("normal"===r?"ÊôÆÈÄö":"È´òÁ¥ö")+"È£ºÊñô‰∫Ü":(n.feeds[r]--,e.hunger=Math.max(0,e.hunger-t),e.lastFedDate=(new Date).toISOString(),"Â∑≤È§µÈ£ü "+e.name+"ÔºåÈ£¢È§ìÂÄº -"+t)},e.renameFish=function(e,n){return!(!n||n.length>12)&&(e.name=n,!0)},e.useUpgradePotion=function(e,n){if(n.upgradePotion<=0)return{message:"Ê≤íÊúâÂçáÁ¥öËó•‰∫Ü",upgraded:!1};if(e.isDead)return{message:"È≠öÂ∑≤Ê≠ª‰∫°Ôºå‰∏çËÉΩ‰ΩøÁî®ÂçáÁ¥öËó•",upgraded:!1};if(e.stage>=6)return{message:"ÈÄôÈöªÈ≠öÂ∑≤ÈÅîÊúÄÈ´òÈöéÊÆµ",upgraded:!1};n.upgradePotion--,e.growthDaysPassed+=5;var t=this.tryStageUpgradeByGrowthDays(e);return{message:t?e.name+" ÂçáÁ¥öÁÇ∫Á¨¨ "+e.stage+" ÈöéÔºÅÔºàÂêÉËó•Èï∑Â§ßÔºâ":e.name+" ÊàêÈï∑Â§©Êï∏ +5",upgraded:t}},e.useGenderPotion=function(e,n){return n.genderPotion<=0?"Ê≤íÊúâËÆäÊÄßËó•‰∫Ü":e.isDead?"È≠öÂ∑≤Ê≠ª‰∫°Ôºå‰∏çËÉΩËÆäÊÄß":(n.genderPotion--,e.gender="male"===e.gender?"female":"male",e.name+" ÁöÑÊÄßÂà•Â∑≤ËÆäÊõ¥ÁÇ∫ "+("male"===e.gender?"ÂÖ¨":"ÊØç"))},e.useColdMedicine=function(e,n){return n.coldMedicine<=0?{message:"Ê≤íÊúâÊÑüÂÜíËó•‰∫Ü",cured:!1}:e.isDead?{message:"È≠öÂ∑≤Ê≠ª‰∫°Ôºå‰∏çËÉΩ‰ΩøÁî®ÊÑüÂÜíËó•",cured:!1}:(e.status||(e.status={sick:!1}),e.status.sick?(n.coldMedicine-=1,e.status.sick=!1,e.emotion="happy",{message:e.name+" Â∑≤Ê≤ªÁôí",cured:!0}):{message:e.name+" ‰∏¶Ê≤íÊúâÁîüÁóÖ",cured:!1})},e.useChangePotion=function(e,n){if(n.changePotion<=0)return"Ê≤íÊúâÊï¥ÂΩ¢Ëó•‰∫Ü";if(e.isDead)return"È≠öÂ∑≤Ê≠ª‰∫°Ôºå‰∏çËÉΩÊï¥ÂΩ¢";n.changePotion--;var t=e.adultForm,r=this.getRandomForm(["form1","form2","form3","form4"],t);return e.adultForm=r,e.name+" ÁöÑÈ≠öÂûãÊÖãÂ∑≤Âæû "+t+" ËÆäÊõ¥ÁÇ∫ "+e.adultForm},e.getRandomForm=function(e,n){var t;do{t=e[Math.floor(Math.random()*e.length)]}while(t===n);return t},e.tryStageUpgradeByGrowthDays=function(e){for(var n={1:0,2:5,3:15,4:35,5:60,6:90},t=!1;e.stage<6&&e.growthDaysPassed>=n[e.stage+1];)e.stage++,t=!0;return t},e}());n._RF.pop()}}}));

System.register("chunks:///_virtual/FriendPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts","./GameManager.ts","./UIUtils.ts","./ConfirmDialogManager.ts"],(function(e){var t,n,r,i,a,s,o,l,u,c,d,f,p,h,v,m,g,b,x,C,y,I,w,k,F;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.createForOfIteratorHelperLoose,i=e.asyncToGenerator,a=e.regeneratorRuntime,s=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){l=e.cclegacy,u=e._decorator,c=e.Node,d=e.SpriteFrame,f=e.Prefab,p=e.Button,h=e.EditBox,v=e.Color,m=e.Sprite,g=e.Label,b=e.instantiate,x=e.Component,C=e.ImageAsset,y=e.Texture2D},function(e){I=e.DataManager},function(e){w=e.GameManager},function(e){k=e.showFloatingTextCenter},function(e){F=e.ConfirmDialogManager}],execute:function(){var T,L,B,E,P,N,S,A,D,_,M,z,R,U,K,q,G,V,O,H,Y,j,X,Z,J,Q,W,$,ee,te,ne;l._RF.push({},"41c4dY/ZOFPd41kmFX8GyU6","FriendPanel",void 0);var re=u.ccclass,ie=u.property,ae=function(e){return e.Friends="friends",e.Explore="explore",e}(ae||{});e("FriendPanel",(T=re("FriendPanel"),L=ie(c),B=ie(F),E=ie(d),P=ie(f),N=ie(p),S=ie(p),A=ie(c),D=ie(c),_=ie(f),M=ie(c),z=ie(c),R=ie(h),U=ie(p),K=ie(f),T((V=t((G=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=e.call.apply(e,[this].concat(r))||this,s(t,"floatingNode",V,o(t)),s(t,"confirmDialogManager",O,o(t)),s(t,"defaultAvatar",H,o(t)),s(t,"emptyStatePrefab",Y,o(t)),s(t,"friendsTabBtn",j,o(t)),s(t,"exploreTabBtn",X,o(t)),s(t,"friendsSection",Z,o(t)),s(t,"friendsListContent",J,o(t)),s(t,"friendRowPrefab",Q,o(t)),s(t,"exploreSection",W,o(t)),s(t,"exploreListContent",$,o(t)),s(t,"friendIdInput",ee,o(t)),s(t,"searchBtn",te,o(t)),s(t,"searchRowPrefab",ne,o(t)),t.currentTab=ae.Friends,t._friends=[],t}n(t,e);var l=t.prototype;return l.onEnable=function(){this.bindEvents(),this.switchTab(this.currentTab)},l.onDisable=function(){this.unbindEvents()},l.refreshFriendCandidates=function(){var e=i(a().mark((function e(){var t,n,i,s,o,l,u,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getFriends().catch((function(){return[]}));case 2:t=e.sent,console.log("[FriendPanel] Â•ΩÂèãÊï∏ =",t.length),n=[],i=r(t);case 6:if((s=i()).done){e.next=17;break}return u=s.value,e.next=10,I.getPublicPlayerData(u.userId).catch((function(){return null}));case 10:if(c=e.sent){e.next=13;break}return e.abrupt("continue",15);case 13:console.log("[FriendPanel] ÂÖ¨ÈñãË≥áÊñô",u.userId,"fishList # =",null!=(o=null==(l=c.fishList)?void 0:l.length)?o:0),n.push(c);case 15:e.next=6;break;case 17:this._friends=n,console.log("[FriendPanel] Â∑≤Âø´ÂèñÂê´ fishList ÁöÑÂ•ΩÂèã =",this._friends.length),this.node.emit("friends-refreshed",this._friends);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.setFriends=function(e){this._friends=null!=e?e:[]},l.getAllFriendPlayerData=function(){var e;return null!=(e=this._friends)?e:[]},l.getFriendMarriageCandidates=function(){for(var e,t=[],n=r(null!=(i=this._friends)?i:[]);!(e=n()).done;)for(var i,a,s=e.value,o=r(null!=(l=s.fishList)?l:[]);!(a=o()).done;){var l,u,c=a.value;!c.isDead&&!c.isMarried&&(null!=(u=c.stage)?u:0)>=6&&t.push({ownerGameId:s.gameId,fish:c})}return console.log("[FriendPanel] getFriendMarriageCandidates ÂõûÂÇ≥ =",t.length,t),t},l.bindEvents=function(){var e,t,n;null==(e=this.exploreTabBtn)||e.node.on(p.EventType.CLICK,this.onClickExploreTab,this),null==(t=this.friendsTabBtn)||t.node.on(p.EventType.CLICK,this.onClickFriendsTab,this),null==(n=this.searchBtn)||n.node.on(p.EventType.CLICK,this.onClickSearch,this)},l.unbindEvents=function(){var e,t,n;null==(e=this.exploreTabBtn)||e.node.off(p.EventType.CLICK,this.onClickExploreTab,this),null==(t=this.friendsTabBtn)||t.node.off(p.EventType.CLICK,this.onClickFriendsTab,this),null==(n=this.searchBtn)||n.node.off(p.EventType.CLICK,this.onClickSearch,this)},l.onClickFriendsTab=function(){this.switchTab(ae.Friends)},l.onClickExploreTab=function(){this.switchTab(ae.Explore)},l.switchTab=function(){var e=i(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentTab=t,this.updateTabVisual(),this.friendsSection&&(this.friendsSection.active=t===ae.Friends),this.exploreSection&&(this.exploreSection.active=t===ae.Explore),null==(n=this.getActiveList())||n.removeAllChildren(),t!==ae.Friends){e.next=10;break}return e.next=8,this.refreshFriendsList();case 8:e.next=12;break;case 10:return e.next=12,this.refreshExploreList();case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),l.updateTabVisual=function(){var e,t,n=this.currentTab===ae.Friends,r=new v(80,180,255,255),i=new v(180,180,180,255),a=null==(e=this.friendsTabBtn)?void 0:e.getComponent(m),s=null==(t=this.exploreTabBtn)?void 0:t.getComponent(m);a&&(a.color=n?r:i),s&&(s.color=n?i:r)},l.refreshExploreList=function(){var e=i(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.exploreListContent).removeAllChildren(),this.addEmptyStateToList(t,"-----Êé®Ëñ¶Â•ΩÂèã-----",!0),e.next=5,this.recommendFriends(!0);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.refreshFriendsList=function(){var e=i(a().mark((function e(){var t,n,s,o,l,u=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.friendsListContent).removeAllChildren(),e.prev=2,e.next=5,I.getFriends().catch((function(){return[]}));case 5:if((n=e.sent)&&0!==n.length){e.next=9;break}return this.addEmptyStateToList(t,"ÈÇÑÊ≤íÊúâÂ•ΩÂèãÔºåÂø´ÂéªÊé¢Á¥¢Áµê‰∫§Êñ∞ÊúãÂèãÂêßÔºÅ"),e.abrupt("return");case 9:s=a().mark((function e(){var n,r,s,o,c,d,f,h,v,x,C,y,I;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=l.value,f=b(u.friendRowPrefab),h=null==(n=f.getChildByName("NameLabel"))?void 0:n.getComponent(g),null==(v=null==(r=f.getChildByName("DeleteBtn"))?void 0:r.getComponent(p))||v.node.on(p.EventType.CLICK,i(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.displayName||d.userId||"ÈÄô‰ΩçÂ•ΩÂèã",u.confirmDialogManager){e.next=4;break}return console.warn("[FriendPanel] confirm manager missing; skipping ask."),e.abrupt("return");case 4:return e.next=6,u.confirmDialogManager.ask("Á¢∫ÂÆöË¶ÅÂà™Èô§„Äå"+t+"„ÄçÂóéÔºü");case 6:if(e.sent){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,u.deleteFriend(d,v);case 11:case"end":return e.stop()}}),e)}))),u),h&&(h.string=d.displayName||"(Êú™Ë®≠ÂÆöÊö±Á®±)"),(x=null==(s=f.getChildByName("IdLabel"))?void 0:s.getComponent(g))&&(x.string="ID: "+u.getDisplayId(d)),C=f.getChildByName("UserAvatarMask"),!(y=null==C||null==(o=C.getChildByName("UserAvatar"))?void 0:o.getComponent(m))){e.next=17;break}if(!d.picture){e.next=16;break}return e.next=14,u.loadAvatar(d.picture,y);case 14:e.next=17;break;case 16:y.spriteFrame=u.defaultAvatar;case 17:null==(I=null==(c=f.getChildByName("ViewBtn"))?void 0:c.getComponent(p))||I.node.on(p.EventType.CLICK,(function(){return u.onViewFriendTank(d.userId)}),u),f.parent=t;case 20:case"end":return e.stop()}}),e)})),o=r(n);case 11:if((l=o()).done){e.next=15;break}return e.delegateYield(s(),"t0",13);case 13:e.next=11;break;case 15:e.next=22;break;case 17:e.prev=17,e.t1=e.catch(2),console.warn("[FriendPanel] load friends failed:",e.t1),t.removeAllChildren(),this.addEmptyStateToList(t,"ËºâÂÖ•Â•ΩÂèãÂ§±ÊïóÔºåË´ãÁ®çÂæåÂÜçË©¶");case 22:case"end":return e.stop()}}),e,this,[[2,17]])})));return function(){return e.apply(this,arguments)}}(),l.recommendFriends=function(){var e=i(a().mark((function e(t){var n,i,s,o,l,u,c,d,f,h,v,x,C,y,w,k,F,T;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!1),n=this.exploreListContent,t||(n.removeAllChildren(),this.addEmptyStateToList(n,"Êé®Ëñ¶‰∏≠‚Ä¶")),e.prev=3,e.next=6,I.getRecommendedUsers(5).catch((function(){return[]}));case 6:if((i=e.sent)&&0!==i.length){e.next=10;break}return t||this.addEmptyStateToList(n,"ÁõÆÂâçÊ≤íÊúâÊé®Ëñ¶ÁöÑÁé©ÂÆ∂"),e.abrupt("return");case 10:return e.next=12,Promise.all([I.getFriends().catch((function(){return[]})),I.getFriendRequests().catch((function(){return{incoming:[],outgoing:[]}}))]);case 12:s=e.sent,o=s[0],l=s[1],u=r(i);case 16:if((c=u()).done){e.next=37;break}if(x=c.value,C=b(this.searchRowPrefab),(y=null==(d=C.getChildByName("NameLabel"))?void 0:d.getComponent(g))&&(y.string=x.displayName||"(Êú™Ë®≠ÂÆöÊö±Á®±)"),(w=null==(f=C.getChildByName("IdLabel"))?void 0:f.getComponent(g))&&(w.string="ID: "+this.getDisplayId(x)),k=C.getChildByName("UserAvatarMask"),!(F=null==k||null==(h=k.getChildByName("UserAvatar"))?void 0:h.getComponent(m))){e.next=32;break}if(!x.picture){e.next=31;break}return e.next=29,this.loadAvatar(x.picture,F);case 29:e.next=32;break;case 31:F.spriteFrame=this.defaultAvatar;case 32:(T=null==(v=C.getChildByName("InviteBtn"))?void 0:v.getComponent(p))&&this.setupInviteButton(T,x.userId,o,l),C.parent=n;case 35:e.next=16;break;case 37:e.next=43;break;case 39:e.prev=39,e.t0=e.catch(3),console.warn("[FriendPanel] recommend friends failed:",e.t0),t||(n.removeAllChildren(),this.addEmptyStateToList(n,"Êé®Ëñ¶Â•ΩÂèãÂ§±ÊïóÔºåË´ãÁ®çÂæåÂÜçË©¶"));case 43:case"end":return e.stop()}}),e,this,[[3,39]])})));return function(t){return e.apply(this,arguments)}}(),l.onClickSearch=function(){var e=i(a().mark((function e(){var t,n,r,i,s,o,l,u,c,d,f,h,v,x,C,y,w;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentTab===ae.Explore){e.next=3;break}return e.next=3,this.switchTab(ae.Explore);case 3:if(t=this.exploreListContent,n=(this.friendIdInput.string||"").trim()){e.next=9;break}return t.removeAllChildren(),this.addEmptyStateToList(t,"Ë´ãËº∏ÂÖ•Â•ΩÂèã ID"),e.abrupt("return");case 9:return e.prev=9,t.removeAllChildren(),l=this.addEmptyStateToList(t,"ÊêúÂ∞ã‰∏≠‚Ä¶"),e.next=14,I.lookupUserById(n);case 14:if(u=e.sent,l&&l.isValid&&l.destroy(),u){e.next=23;break}return t.removeAllChildren(),this.addEmptyStateToList(t,"Êµ∑Ë£°ÁøªÈÅç‰∫ÜÔºå‰πüÊ≤íÊâæÂà∞ÈÄô‰ΩçÁé©ÂÆ∂"),this.addEmptyStateToList(t,"-----Êé®Ëñ¶Â•ΩÂèã-----",!0),e.next=22,this.recommendFriends(!0);case 22:return e.abrupt("return");case 23:if(c=b(this.searchRowPrefab),(d=null==(r=c.getChildByName("NameLabel"))?void 0:r.getComponent(g))&&(d.string=u.displayName||"(Êú™Ë®≠ÂÆöÊö±Á®±)"),(f=null==(i=c.getChildByName("IdLabel"))?void 0:i.getComponent(g))&&(f.string="ID: "+this.getDisplayId(u)),h=c.getChildByName("UserAvatarMask"),!(v=null==h||null==(s=h.getChildByName("UserAvatar"))?void 0:s.getComponent(m))){e.next=37;break}if(!u.picture){e.next=36;break}return e.next=34,this.loadAvatar(u.picture,v);case 34:e.next=37;break;case 36:v.spriteFrame=this.defaultAvatar;case 37:return x=null==(o=c.getChildByName("InviteBtn"))?void 0:o.getComponent(p),e.next=40,Promise.all([I.getFriends().catch((function(){return[]})),I.getFriendRequests().catch((function(){return{incoming:[],outgoing:[]}}))]);case 40:C=e.sent,y=C[0],w=C[1],x&&this.setupInviteButton(x,u.userId,y,w),c.parent=t,e.next=52;break;case 47:e.prev=47,e.t0=e.catch(9),console.warn("[FriendPanel] search failed:",e.t0),t.removeAllChildren(),this.addEmptyStateToList(t,"Êü•Ë©¢Â§±ÊïóÔºåË´ãÁ®çÂæåÂÜçË©¶");case 52:case"end":return e.stop()}}),e,this,[[9,47]])})));return function(){return e.apply(this,arguments)}}(),l.getActiveList=function(){return this.currentTab===ae.Friends?this.friendsListContent:this.exploreListContent},l.loadAvatar=function(){var e=i(a().mark((function e(t,n){var r,i,s,o,l,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{mode:"cors"});case 3:return r=e.sent,e.next=6,r.blob();case 6:return i=e.sent,e.next=9,createImageBitmap(i);case 9:s=e.sent,o=new C(s),(l=new y).image=o,(u=new d).texture=l,n.spriteFrame=u,e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),console.warn("ËºâÂÖ•Â•ΩÂèãÈ†≠Ë≤ºÂ§±Êïó:",e.t0),n.spriteFrame=this.defaultAvatar;case 22:case"end":return e.stop()}}),e,this,[[0,18]])})));return function(t,n){return e.apply(this,arguments)}}(),l.onViewFriendTank=function(){var e=i(a().mark((function e(t){var n,r,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.getPublicPlayerData(t);case 3:r=e.sent,null==(i=null==(n=this.node.scene.getChildByName("GameManager"))?void 0:n.getComponent(w))||i.showFriendTank(r),this.node.active=!1,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.warn("getPublicPlayerData failed:",e.t0),k(this.floatingNode,"ËºâÂÖ•Â•ΩÂèãË≥áÊñôÂ§±Êïó");case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),l.setInviteBtn=function(e,t,n){if(e){var r=e.node.getComponentInChildren(g);r&&(r.string=t),e.interactable=n}},l.addEmptyStateToList=function(e,t,n){if(void 0===n&&(n=!1),this.emptyStatePrefab){var r=b(this.emptyStatePrefab),i=r.getComponentInChildren(g);return i&&(i.string=t,n?(i.color=new v(0,0,0,255),i.fontSize=20):(i.color=new v(0,0,0,255),i.fontSize=24)),r.parent=e,r}},l.setupInviteButton=function(e,t,n,r){var s,o,l=this;e.node.off(p.EventType.CLICK);var u=null==n?void 0:n.some((function(e){return e.userId===t})),c=null==r||null==(s=r.outgoing)?void 0:s.some((function(e){return e.toUserId===t&&"pending"===e.status})),d=null==r||null==(o=r.incoming)?void 0:o.some((function(e){return e.fromUserId===t&&"pending"===e.status}));(null==n?void 0:n.length)>=I.FRIEND_LIMIT?this.setInviteBtn(e,"Â•ΩÂèãÂ∑≤Êªø",!1):u?this.setInviteBtn(e,"Â∑≤ÊòØÂ•ΩÂèã",!1):c?this.setInviteBtn(e,"Â∑≤ÈÄÅÂá∫ÈÇÄË´ã",!1):d?this.setInviteBtn(e,"Â∞çÊñπÂ∑≤ÈÇÄË´ã‰Ω†",!1):(this.setInviteBtn(e,"ÈÄÅÂá∫ÈÇÄË´ã",!0),e.node.on(p.EventType.CLICK,i(a().mark((function n(){var i,s;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,l.setInviteBtn(e,"ÈÄÅÂá∫‰∏≠‚Ä¶",!1),n.next=4,I.sendFriendRequest(t);case 4:i=n.sent,r.outgoing.push({requestId:i.request.requestId,fromUserId:I.currentUserId,toUserId:t,createdAt:(new Date).toISOString(),status:"pending"}),null!=i&&i.autoAccepted?(l.setInviteBtn(e,"Â∑≤ÊàêÁÇ∫Â•ΩÂèã",!1),k(l.floatingNode,"Â∑≤ÊàêÁÇ∫Â•ΩÂèãÔºÅ")):(l.setInviteBtn(e,"Â∑≤ÈÄÅÂá∫ÈÇÄË´ã",!1),k(l.floatingNode,"ÈÇÄË´ãÂ∑≤ÈÄÅÂá∫ÔºåÁ≠âÂæÖÂ∞çÊñπÁ¢∫Ë™ç")),l.node.emit("refresh-mail-badge"),n.next=15;break;case 10:n.prev=10,n.t0=n.catch(0),console.warn("sendFriendRequest failed:",n.t0),"friend_limit_reached"===(s=null==n.t0?void 0:n.t0.code)||"friend_limit_reached_sender"===s||"friend_limit_reached_recipient"===s?(l.setInviteBtn(e,"Â•ΩÂèãÂ∑≤Êªø",!1),k(l.floatingNode,"‰Ω†ÁöÑÂ•ΩÂèãÊï∏ÈáèÊàñÂ∞çÊñπÂ∑≤ÊªøÔºåÁÑ°Ê≥ïÊñ∞Â¢û")):(l.setInviteBtn(e,"ÈÄÅÂá∫ÈÇÄË´ã",!0),k(l.floatingNode,"ÈÇÄË´ãÂ§±ÊïóÔºåË´ãÁ®çÂæåÂÜçË©¶"));case 15:case"end":return n.stop()}}),n,null,[[0,10]])}))),this))},l.deleteFriend=function(){var e=i(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[FriendPanel] deleteFriend enter",null==t?void 0:t.userId,null==t?void 0:t.displayName,"btn:",!!n),e.prev=1,n&&(n.interactable=!1),e.next=5,I.deleteFriend(t.userId);case 5:return console.log("[FriendPanel] deleteFriend success for",t.userId),k(this.floatingNode,"Â∑≤Ëß£Èô§Â•ΩÂèãÈóú‰øÇ"),e.next=9,this.refreshFriendsList();case 9:if(this.currentTab!==ae.Explore){e.next=12;break}return e.next=12,this.refreshExploreList();case 12:e.next=19;break;case 14:e.prev=14,e.t0=e.catch(1),console.warn("[FriendPanel] deleteFriend failed:",e.t0),k(this.floatingNode,"Âà™Èô§Â§±ÊïóÔºåË´ãÁ®çÂæåÂÜçË©¶"),n&&(n.interactable=!0);case 19:case"end":return e.stop()}}),e,this,[[1,14]])})));return function(t,n){return e.apply(this,arguments)}}(),l.getDisplayId=function(e){return e.gameId&&String(e.gameId)||e.userId},t}(x)).prototype,"floatingNode",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(G.prototype,"confirmDialogManager",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(G.prototype,"defaultAvatar",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(G.prototype,"emptyStatePrefab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(G.prototype,"friendsTabBtn",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=t(G.prototype,"exploreTabBtn",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(G.prototype,"friendsSection",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(G.prototype,"friendsListContent",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(G.prototype,"friendRowPrefab",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(G.prototype,"exploreSection",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=t(G.prototype,"exploreListContent",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=t(G.prototype,"friendIdInput",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=t(G.prototype,"searchBtn",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=t(G.prototype,"searchRowPrefab",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=G))||q));l._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SwimmingFish.ts","./DataManager.ts","./FishLogic.ts","./TombManager.ts","./TankEnvironmentManager.ts","./UIUtils.ts","./LiffBridge.ts","./Api.ts","./ConfirmDialogManager.ts","./DecorationEditor.ts","./FishFamilyService.ts","./FriendPanel.ts","./BackgroundAnimator.ts"],(function(e){var t,n,r,a,i,s,o,u,l,c,h,f,d,p,m,b,g,y,v,k,w,x,D,T,F,C,B,L,I,P,N,E,S,M,A,O,U,z;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.asyncToGenerator,a=e.regeneratorRuntime,i=e.createForOfIteratorHelperLoose,s=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){u=e.cclegacy,l=e._decorator,c=e.Color,h=e.Node,f=e.SpriteFrame,d=e.Prefab,p=e.Button,m=e.Label,b=e.Sprite,g=e.instantiate,y=e.UITransform,v=e.Vec3,k=e.Component,w=e.ImageAsset,x=e.Texture2D,D=e.resources},function(e){T=e.SwimmingFish},function(e){F=e.DataManager},function(e){C=e.FishLogic},function(e){B=e.TombManager},function(e){L=e.TankEnvironmentManager},function(e){I=e.showFloatingTextCenter},function(e){P=e.getIdentity,N=e.initLiff},function(e){E=e.authWithLine,S=e.createLinePayOrder},function(e){M=e.ConfirmDialogManager},function(e){A=e.DecorationEditor},function(e){O=e.FishFamilyService},function(e){U=e.FriendPanel},function(e){z=e.BackgroundAnimator}],execute:function(){var _,R,V,H,Q,W,G,j,J,Y,q,X,Z,K,$,ee,te,ne,re,ae,ie,se,oe,ue,le,ce,he,fe,de,pe,me,be,ge,ye,ve,ke,we,xe,De,Te,Fe,Ce,Be,Le,Ie,Pe,Ne,Ee,Se,Me,Ae,Oe,Ue,ze,_e,Re,Ve,He,Qe,We,Ge,je,Je,Ye,qe,Xe,Ze,Ke,$e,et,tt,nt,rt,at,it,st,ot,ut,lt,ct,ht,ft,dt,pt,mt,bt,gt,yt,vt,kt,wt,xt,Dt,Tt,Ft;u._RF.push({},"d13bcYsAP9GrbI7DBywQwwD","GameManager",void 0);var Ct=l.ccclass,Bt=l.property,Lt=new c(255,0,0,255),It=new c(120,198,80,255),Pt=new c(0,0,255,255),Nt={backgrounds:new Map,decorations:new Map};e("GameManager",(_=Ct("GameManager"),R=Bt(h),V=Bt(M),H=Bt(B),Q=Bt(h),W=Bt(h),G=Bt(f),j=Bt([d]),J=Bt([d]),Y=Bt([d]),q=Bt([d]),X=Bt([p]),Z=Bt(p),K=Bt(h),$=Bt(m),ee=Bt(m),te=Bt(b),ne=Bt(f),re=Bt(m),ae=Bt(m),ie=Bt(m),se=Bt(m),oe=Bt(p),ue=Bt(p),le=Bt(p),ce=Bt(m),he=Bt(m),fe=Bt(m),de=Bt(h),pe=Bt(h),me=Bt(h),be=Bt(p),ge=Bt(h),ye=Bt(h),ve=Bt(m),ke=Bt(p),we=Bt(h),xe=Bt(p),De=Bt(p),Te=Bt(p),Fe=Bt(h),Ce=Bt(p),Be=Bt(m),Le=Bt(p),Ie=Bt(A),Pe=Bt(p),_((Se=t((Ee=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,s(t,"floatingNode",Se,o(t)),s(t,"confirmDialogManager",Me,o(t)),s(t,"tombManager",Ae,o(t)),s(t,"activeTankViewport",Oe,o(t)),s(t,"fishArea",Ue,o(t)),s(t,"defaultBackgroundSpriteFrame",ze,o(t)),s(t,"maleFishPrefabsByStage",_e,o(t)),s(t,"femaleFishPrefabsByStage",Re,o(t)),s(t,"maleStage6FormPrefabs",Ve,o(t)),s(t,"femaleStage6FormPrefabs",He,o(t)),s(t,"tankButtons",Qe,o(t)),s(t,"tombTankBtn",We,o(t)),s(t,"tombTankNode",Ge,o(t)),s(t,"userNameLabel",je,o(t)),s(t,"gameIdLabel",Je,o(t)),s(t,"userAvatar",Ye,o(t)),s(t,"defaultAvatar",qe,o(t)),s(t,"dragonboneLabel",Xe,o(t)),s(t,"fishCountLabel",Ze,o(t)),s(t,"temperatureLabel",Ke,o(t)),s(t,"waterQualityLabel",$e,o(t)),s(t,"minComfortTemp",et,o(t)),s(t,"maxComfortTemp",tt,o(t)),s(t,"heaterBtn",nt,o(t)),s(t,"fanBtn",rt,o(t)),s(t,"brushBtn",at,o(t)),s(t,"heaterCountLabel",it,o(t)),s(t,"fanCountLabel",st,o(t)),s(t,"brushCountLabel",ot,o(t)),s(t,"dirtyWaterOverlay",ut,o(t)),s(t,"coldOverlay",lt,o(t)),s(t,"hotOverlay",ct,o(t)),s(t,"singInBtn",ht,o(t)),s(t,"signInPanel",ft,o(t)),s(t,"noticePanel",dt,o(t)),s(t,"noticeLabel",pt,o(t)),s(t,"noticeCloseBtn",mt,o(t)),s(t,"tombHintPanel",bt,o(t)),s(t,"tombHintCloseBtn",gt,o(t)),s(t,"backToMyTankBtn",yt,o(t)),s(t,"mailBoxBtn",vt,o(t)),s(t,"mailboxRedDot",kt,o(t)),s(t,"addFishBtn",wt,o(t)),s(t,"tankFishCountLabel",xt,o(t)),s(t,"decorEditBtn",Dt,o(t)),s(t,"decorEditor",Tt,o(t)),s(t,"rechargeBtn",Ft,o(t)),t.currentTankId=1,t.friendCurrentTankIndex=0,t.offDMChange=null,t.playerData=null,t.isViewingFriend=!1,t.viewingFriend=null,t.lastNoticeType="none",t.family=void 0,t._breedingInProgress=!1,t.friendSnapshot=[],t.ADULT_FORM_ORDER=["form1","form2","form3","form4"],t.onMailboxRefreshed=function(e){var n=e.unread;t.applyMailboxBadge(n)},t._handlingDMChange=!1,t}n(t,e);var u=t.prototype;return u.getAdultFormDisplayName=function(e){var t;return e&&null!=(t={form1:"Normal",form2:"Â§ßÁúºÈ≠ö",form3:"ËÉñÈØâÈ≠ö",form4:"È™®È†≠È≠ö"}[e])?t:"Êú™Áü•ÂûãÊÖã"},u.getDecorationPrefab=function(e){var t;return null==(t=Nt.decorations)?void 0:t.get(e)},u.formToIndex=function(e){var t=this.ADULT_FORM_ORDER.indexOf(e||"form1");return t>=0?t:0},u.pickAdultForm=function(e,t){var n=this.ADULT_FORM_ORDER;return n[Math.floor(Math.random()*n.length)]},u.getMyPlayer=function(){return this.playerData},u.getCurrentTankId=function(){return this.currentTankId},u.onLoad=function(){var e=r(a().mark((function e(){var t,n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={getMyPlayer:function(){return n.playerData},getPlayerByGameId:function(e){var t,r,a=n.node.scene.getComponentInChildren(U),i=(null==a||null==(t=a.getAllFriendPlayerData())?void 0:t.find((function(t){return t.gameId===e})))||null;return i||((null==(r=n.friendSnapshot)?void 0:r.find((function(t){return t.gameId===e})))||null)},saveOtherPlayer:function(){var e=r(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(F.apiBase+"/player/"+encodeURIComponent(t.userId),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),saveMyPlayer:function(){var e=r(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.savePlayerDataWithCache(n.playerData);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),toast:function(e){I(n.floatingNode,e)},getCurrentTankId:function(){return n.currentTankId},addBabyFishToTank:function(){var e=r(a().mark((function e(t,r){var i,s,o,u,l,c,h,f,d,p,m,b;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==n.playerData.gameId){e.next=4;break}return e.next=3,n.commitAddFish(r,0,"È≠öÂØ∂ÂØ∂Ë™ïÁîüÂï¶ÔºÅ");case 3:return e.abrupt("return",-1);case 4:if(l=n.node.scene.getComponentInChildren(U),c=null!=(i=null!=(s=null==l||null==l.getAllFriendPlayerData?void 0:l.getAllFriendPlayerData())?s:n.friendSnapshot)?i:[],h=c.find((function(e){return e.gameId===t}))){e.next=10;break}return console.warn("[breed] Êâæ‰∏çÂà∞Â•ΩÂèã PlayerDataÔºåÁï•ÈÅéÂ•ΩÂèãÂØ∂ÂØ∂Ê¥æÁôº"),e.abrupt("return",-1);case 10:return f=r,h.tankList.some((function(e){return e.id===f}))||(f=1),d=null!=(o=null==(u=h.tankList.find((function(e){return e.id===f})))?void 0:u.capacity)?o:1===f?3:6,h.tankList.find((function(e){return e.id===f})).fishIds.map((function(e){return h.fishList.find((function(t){return t.id===e}))})).filter((function(e){return!!e&&!e.isDead})).length>=d&&(console.warn("[breed] Â•ΩÂèãÊåáÂÆöÈ≠öÁº∏Â∑≤ÊªøÔºåÊîπÁôºÂà∞ 1 ËôüÁº∏"),f=1),p=(h.fishList.reduce((function(e,t){return Math.max(e,t.id)}),0)||0)+1,b={id:p,name:"È±òÈæç"+p+"Ëôü",gender:(m=["male","female"])[Math.floor(Math.random()*m.length)],stage:1,growthDaysPassed:0,lastFedDate:(new Date).toISOString(),hunger:50,hungerRateMultiplier:1,appearance:"beautiful",outfit:{head:null,accessories:[]},isMarried:!1,spouseId:null,status:{hungry:!1,hot:!1,cold:!1,sick:!1},emotion:"happy",isDead:!1,tankId:f,spouseOwnerGameId:null,marriedAt:null},h.fishList.push(b),h.tankList.find((function(e){return e.id===f})).fishIds.push(b.id),e.next=23,fetch(F.apiBase+"/player/"+encodeURIComponent(h.userId),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)});case 23:return e.abrupt("return",b.id);case 24:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),countEmptySlots:function(e){for(var t,n=0,r=i(e.tankList);!(t=r()).done;){var a,s=t.value,o=null!=(a=s.capacity)?a:1===s.id?3:6,u=s.fishIds.map((function(t){return e.fishList.find((function(e){return e.id===t}))})).filter((function(e){return!!e&&!e.isDead})).length;n+=Math.max(0,o-u)}return n},canMutateOtherPlayer:function(e){return!0},enqueueMailFor:function(){var e=r(a().mark((function e(t,n,r){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},this.family=new O(t);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.start=function(){var e=r(a().mark((function e(){var t,n,i,s,o,u,l,c,h,f,d=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=new URLSearchParams(window.location.search),s="1"===i.get("dev"),o=i.get("uid")||"DEV_LOCAL",e.prev=3,!s){e.next=12;break}return console.warn("[Game] DEV Ê®°Âºè"),F.useLocalStorage=!1,F.apiBase="http://localhost:3000",e.next=10,F.init(o);case 10:e.next=26;break;case 12:return e.next=14,N("2007937783-PJ4ZRBdY");case 14:return e.next=16,P();case 16:if(u=e.sent,l=u.idToken){e.next=20;break}throw new Error("Âèñ‰∏çÂà∞ idTokenÔºåË´ãÁî® LINE App / LIFF URL ÈñãÂïü");case 20:return e.next=22,E(l);case 22:return c=e.sent,h=c.lineUserId,e.next=26,F.init(h);case 26:return e.next=28,this.preloadDecorationPrefabs();case 28:return e.next=30,this.preloadBackgroundSpriteFrames();case 30:return e.next=32,F.getPlayerDataCached();case 32:return this.playerData=e.sent,e.next=35,this.initCapsAndRules();case 35:e.next=41;break;case 37:return e.prev=37,e.t0=e.catch(3),console.error("[Game] ÂïüÂãïÂ§±ÊïóÔºö",e.t0),e.abrupt("return");case 41:if(this.playerData){e.next=44;break}return console.error("Áé©ÂÆ∂Ë≥áÊñôËÆÄÂèñÂ§±Êïó"),e.abrupt("return");case 44:if(null==(t=this.node.scene)||t.on("mailbox-refreshed",this.onMailboxRefreshed,this),this.refreshMailboxBadge(),!(f=this.node.scene.getComponentInChildren(U))){e.next=52;break}return e.next=50,f.refreshFriendCandidates();case 50:this.friendSnapshot=f.getAllFriendPlayerData(),f.node.on("friends-refreshed",(function(e){d.friendSnapshot=e||[],console.log("[GM] friendSnapshot updated, size =",d.friendSnapshot.length)}));case 52:return e.next=54,this.processDailyUpdate();case 54:return this.initButtons(),this.initPanels(),e.next=58,this.switchTank(1);case 58:return this.updateAddFishBtnState(),this.updateTankFishCountLabel(),e.next=62,null==(n=this.tombManager)?void 0:n.init();case 62:return e.next=64,this.refreshEnvironmentUI();case 64:this.maybeShowEnvNoticeOnEnter(),this.offDMChange=F.onChange(r(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.handlePlayerDataChange(t,"dm-change");case 2:case"end":return e.stop()}}),e)})))),this.userNameLabel.string=this.playerData.displayName||"Êú™ÂëΩÂêç",this.gameIdLabel.string="ID: "+(this.playerData.gameId||this.playerData.userId||""),this.playerData.picture?this.loadAvatar(this.playerData.picture):this.userAvatar.spriteFrame=this.defaultAvatar;case 69:case"end":return e.stop()}}),e,this,[[3,37]])})));return function(){return e.apply(this,arguments)}}(),u.onDestroy=function(){var e=r(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.offDMChange)||t.call(this),this.offDMChange=null,null==(n=this.node.scene)||n.off("mailbox-refreshed",this.onMailboxRefreshed,this);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.loadAvatar=function(){var e=r(a().mark((function e(t){var n,r,i,s,o,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{mode:"cors"});case 3:return n=e.sent,e.next=6,n.blob();case 6:return r=e.sent,e.next=9,createImageBitmap(r);case 9:i=e.sent,s=new w(i),(o=new x).image=s,(u=new f).texture=o,this.userAvatar.spriteFrame=u,e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),console.error("ËºâÂÖ•È†≠Ë≤ºÂ§±Êïó",e.t0),this.userAvatar.spriteFrame=this.defaultAvatar;case 22:case"end":return e.stop()}}),e,this,[[0,18]])})));return function(t){return e.apply(this,arguments)}}(),u.setHeaderUser=function(){var e=r(a().mark((function e(t,n,r){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.userNameLabel.string=t||"Êú™ÂëΩÂêç",this.gameIdLabel.string="ID: "+(n||""),!r){e.next=7;break}return e.next=5,this.loadAvatar(r);case 5:e.next=8;break;case 7:this.userAvatar.spriteFrame=this.defaultAvatar;case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),u.preloadDecorationPrefabs=function(){var e=r(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){D.loadDir("decorations",d,(function(t,n){!t&&n?n.forEach((function(e){return Nt.decorations.set(e.name,e)})):console.warn("[Decor] Ê≤íËºâÂà∞ decorationsÔºö",t),e()}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u.preloadBackgroundSpriteFrames=function(){var e=r(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){D.loadDir("backgrounds",f,(function(t,n){!t&&n?n.forEach((function(e){return Nt.backgrounds.set(e.name,e)})):console.warn("[BG] Ê≤íËºâÂà∞ backgroundsÔºö",t),e()}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u.initCapsAndRules=function(){var e=r(a().mark((function e(){var t,n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.playerData){e.next=2;break}return e.abrupt("return");case 2:for(t=i(this.playerData.tankList);!(n=t()).done;)null==(r=n.value).capacity&&(r.capacity=1===r.id?3:6);return e.next=5,this.checkAndUnlockCapacityForFirstTank();case 5:return e.next=7,this.checkAndUnlockNextTankIfEligible(1);case 7:return e.next=9,this.checkAndUnlockNextTankIfEligible(2);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.initButtons=function(){var e,t,n,i,s,o,u=this;this.tankButtons.forEach((function(e,t){e.node.on(h.EventType.TOUCH_END,(function(){return u.onClickTankButton(t)}))})),this.tombTankBtn.node.on(h.EventType.TOUCH_END,(function(){return u.switchToTombTank()})),null==(e=this.heaterBtn)||e.node.on(h.EventType.TOUCH_END,(function(){return u.onClickHeater()})),null==(t=this.fanBtn)||t.node.on(h.EventType.TOUCH_END,(function(){return u.onClickFan()})),null==(n=this.brushBtn)||n.node.on(h.EventType.TOUCH_END,(function(){return u.onClickBrush()})),null==(i=this.decorEditBtn)||i.node.on(h.EventType.TOUCH_END,r(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(u.isViewingFriend||null!=(t=u.tombTankNode)&&t.active)){e.next=3;break}return I(u.floatingNode,"Ê≠§ÁãÄÊÖã‰∏çÂèØÁ∑®ËºØË£ùÈ£æ"),e.abrupt("return");case 3:null==(n=u.decorEditor)||null==n.enter||n.enter(u,u.currentTankId);case 4:case"end":return e.stop()}}),e)})))),null==(s=this.backToMyTankBtn)||s.node.on(h.EventType.TOUCH_END,(function(){return u.backToMyTank()})),this.addFishBtn.node.on(h.EventType.TOUCH_END,r(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.onClickAddFish();case 2:case"end":return e.stop()}}),e)})))),null==(o=this.rechargeBtn)||o.node.on(h.EventType.TOUCH_END,(function(){return u.onClickRecharge()}))},u.initPanels=function(){var e=this;this.signInPanel&&(this.signInPanel.active=!0),this.noticeCloseBtn.node.on(h.EventType.TOUCH_END,(function(){e.noticePanel.active=!1,"death"===e.lastNoticeType&&(e.tombHintPanel.active=!0),e.lastNoticeType="none"})),this.tombHintCloseBtn.node.on(h.EventType.TOUCH_END,(function(){e.tombHintPanel.active=!1})),this.backToMyTankBtn&&(this.backToMyTankBtn.node.active=!1)},u.refreshMailboxBadge=function(){var e=r(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F.getInbox();case 3:t=e.sent,n=t.filter((function(e){return"unread"===e.status})).length,this.applyMailboxBadge(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.applyMailboxBadge(0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),u.applyMailboxBadge=function(e){this.mailboxRedDot&&(this.mailboxRedDot.active=e>0)},u.getActiveViewport=function(){var e;return null!=(e=this.activeTankViewport)?e:this.node},u.renderTankView=function(e){var t,n=this,r=e.container,a=e.tank,s=e.fishList,o=e.malePrefabs,u=e.femalePrefabs,l=e.envForEmotion,c=e.readOnly,h=r.getChildByName("Background"),f=r.getChildByName("DecoLayer"),d=r.getChildByName("FishArea")||this.fishArea;if(h){var p=h.getComponent(z),m=h.getComponent(b);if(p){var v=a.backgroundId;p.setBackground(v),!v&&m&&0===p.frames.length&&this.defaultBackgroundSpriteFrame&&(m.spriteFrame=this.defaultBackgroundSpriteFrame)}else if(m){var k=a.backgroundId&&Nt.backgrounds.get(a.backgroundId)||this.defaultBackgroundSpriteFrame;k&&(m.spriteFrame=k)}}if(f){f.removeAllChildren();for(var w,x=i(null!=(D=a.decorations)?D:[]);!(w=x()).done;){var D,F,C,B,L,I,P=w.value,N=Nt.decorations.get(P.id);if(N){var E=g(N);E.name="Deco_"+P.id,E.setPosition(null!=(F=P.x)?F:0,null!=(C=P.y)?C:0,0);var S=(P.flipX?-1:1)*(null!=(B=P.scale)?B:1),M=null!=(L=P.scale)?L:1;E.setScale(S,M,1),E.setRotationFromEuler(0,0,null!=(I=P.rotation)?I:0),"number"==typeof P.zIndex&&E.setSiblingIndex(P.zIndex),f.addChild(E)}}}d.removeAllChildren();var A=d.getComponent(y);if(A)for(var O=A.width,U=A.height,_=Array.from(new Set(null!=(t=a.fishIds)?t:[])),R=function(){var e=H[V],t=s.find((function(t){return t.id===e}));if(!t||t.isDead)return 0;var r,a=Math.max(0,(t.stage||1)-1);if(6===t.stage&&t.adultForm){var i,h=n.formToIndex(t.adultForm),f="female"===t.gender?n.femaleStage6FormPrefabs:n.maleStage6FormPrefabs;r=null!=(i=f[h])?i:f[0]}else r="female"===t.gender?u[a]:o[a];if(!r)return 0;var p=g(r);p.name="Fish_"+t.id;var m=p.getComponent(T);null==m||m.setFishData(t,{readOnly:c,env:l}),null==m||m.refreshOutfit();var b=Math.random()>.5?1:-1;p.setPosition(Math.random()*(O-100)-(O/2-50),Math.random()*(U-100)-(U/2-50),0),p.setScale(b,1,1),p.initialDirection=b,d.addChild(p)},V=0,H=_;V<H.length;V++)R()},u.switchTank=function(){var e=r(a().mark((function e(t){var n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isViewingFriend=!1,e.next=3,F.getPlayerDataCached();case 3:if(this.playerData=e.sent,r=null==(n=this.playerData)?void 0:n.tankList.find((function(e){return e.id===t}))){e.next=7;break}return e.abrupt("return");case 7:return this.activeTankViewport.active=!0,this.tombTankNode.active=!1,this.updateTombStar(),e.next=12,this.setHeaderUser(this.playerData.displayName,this.playerData.gameId||this.playerData.userId,this.playerData.picture);case 12:return this.backToMyTankBtn&&(this.backToMyTankBtn.node.active=!1),this.currentTankId=t,this.renderTankView({container:this.activeTankViewport,tank:r,fishList:this.playerData.fishList,malePrefabs:this.maleFishPrefabsByStage,femalePrefabs:this.femaleFishPrefabsByStage,envForEmotion:this.playerData.tankEnvironment,readOnly:!1}),this.applyFriendViewUI(!1),this.updateTankFishCountLabel(),this.updateAddFishBtnState(),e.next=20,this.refreshEnvironmentUI();case 20:this.updateTankButtons();case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),u.showFriendTank=function(e){var t;this.isViewingFriend=!0,this.viewingFriend=e,this.activeTankViewport.active=!0,this.tombTankNode.active=!1;var n=null==(t=e.tankList)?void 0:t[0];if(n){this.setHeaderUser(e.displayName||e.gameId||e.userId,e.gameId||e.userId,e.picture),this.backToMyTankBtn&&(this.backToMyTankBtn.node.active=!0),this.friendCurrentTankIndex=0,this.applyFriendViewUI(!0),this.updateTankButtons();var r=this.getActiveViewport();this.renderTankView({container:r,tank:n,fishList:e.fishList,malePrefabs:this.maleFishPrefabsByStage,femalePrefabs:this.femaleFishPrefabsByStage,envForEmotion:e.tankEnvironment,readOnly:!0});var a=e.tankEnvironment;this.updateEnvironmentOverlays(a),this.temperatureLabel&&(this.temperatureLabel.string=a.temperature.toFixed(1)+"¬∞C",a.temperature<this.minComfortTemp?this.temperatureLabel.color=Pt:a.temperature>this.maxComfortTemp?this.temperatureLabel.color=Lt:this.temperatureLabel.color=It),this.waterQualityLabel&&(this.waterQualityLabel.string="clean"===a.waterQualityStatus?"Clean":"Dirty",this.waterQualityLabel.color="clean"===a.waterQualityStatus?It:Lt),I(this.floatingNode,(e.displayName||e.gameId||e.userId)+" ÁöÑÈ≠öÁº∏")}else I(this.floatingNode,"ÈÄô‰ΩçÂ•ΩÂèãÈÇÑÊ≤íÊúâÈ≠öÁº∏")},u.renderFriendTankByIndex=function(e){var t;if(this.viewingFriend){var n=this.viewingFriend,r=null==(t=n.tankList)?void 0:t[e];if(r){var a=this.getActiveViewport();this.renderTankView({container:a,tank:r,fishList:n.fishList,malePrefabs:this.maleFishPrefabsByStage,femalePrefabs:this.femaleFishPrefabsByStage,envForEmotion:n.tankEnvironment,readOnly:!0});var i=n.tankEnvironment;this.updateEnvironmentOverlays(i),this.temperatureLabel&&(this.temperatureLabel.string=i.temperature.toFixed(1)+"¬∞C",this.temperatureLabel.color=i.temperature<this.minComfortTemp?Pt:i.temperature>this.maxComfortTemp?Lt:It),this.waterQualityLabel&&(this.waterQualityLabel.string="clean"===i.waterQualityStatus?"Clean":"Dirty",this.waterQualityLabel.color="clean"===i.waterQualityStatus?It:Lt),this.dragonboneLabel&&(this.dragonboneLabel.string="‰øùÂØÜ"),this.friendCurrentTankIndex=e,this.updateTankButtons()}else I(this.floatingNode,"ÊúãÂèãÁöÑÈÄôÂÄãÈ≠öÁº∏ÈÇÑÊ≤íËß£ÈéñÂñîÔΩû")}},u.switchToTombTank=function(){var e=r(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.activeTankViewport.active=!1,this.tombTankNode.active=!0,this.dirtyWaterOverlay&&(this.dirtyWaterOverlay.active=!1),this.coldOverlay&&(this.coldOverlay.active=!1),this.hotOverlay&&(this.hotOverlay.active=!1),this.updateAddFishBtnState(),e.next=8,null==(t=this.tombManager)?void 0:t.refreshTombs();case 8:this.updateTombStar(),this.updateTankButtons();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.updateTombStar=function(){var e;if(this.tombTankBtn){var t=this.tombTankBtn.node.getChildByName("Star");t&&(t.active=!(null==(e=this.tombTankNode)||!e.active))}},u.backToMyTank=function(){var e=r(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isViewingFriend=!1,this.viewingFriend=null,e.next=4,this.switchTank(1);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.updateTankButtons=function(){var e,t,n,r,a,i=this,s=this.isViewingFriend?null!=(e=null==(t=this.viewingFriend)||null==(t=t.tankList)?void 0:t.length)?e:0:null!=(n=null==(r=this.playerData)||null==(r=r.tankList)?void 0:r.length)?n:0,o=!(null==(a=this.tombTankNode)||!a.active),u=this.isViewingFriend&&!o,l=!this.isViewingFriend&&!o;this.tankButtons.forEach((function(e,t){var n,r=e.node,a=null==(n=r.getChildByName("Label"))?void 0:n.getComponent(m);a&&(a.string=String(t+1));var o=t<s,c=r.getChildByName("Padlock");c&&(c.active=!o);var h=r.getChildByName("Star");if(h){var f=!1;f=l?o&&t+1===i.currentTankId:!!u&&(o&&t===i.friendCurrentTankIndex),h.active=f}e.interactable=o}))},u.applyFriendViewUI=function(e){var t,n;(this.tombTankBtn&&(this.tombTankBtn.node.active=!e),this.backToMyTankBtn&&(this.backToMyTankBtn.node.active=e),this.decorEditBtn&&(this.decorEditBtn.node.active=!e),this.singInBtn&&(this.singInBtn.node.active=!e),this.addFishBtn&&(this.addFishBtn.node.active=!e),this.mailBoxBtn&&(this.mailBoxBtn.node.active=!e),this.dragonboneLabel)&&(this.dragonboneLabel.string=e?"‰øùÂØÜ":null!=(t=null==(n=this.playerData)||null==(n=n.dragonBones)?void 0:n.toString())?t:"0")},u.spawnFishInTank=function(){var e=r(a().mark((function e(t){var n,r,s,o,u,l,c,h=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.fishArea.removeAllChildren(),n=this.playerData.tankList.find((function(e){return e.id===t}))){e.next=5;break}return console.warn("Êâæ‰∏çÂà∞È≠öÁº∏ "+t),e.abrupt("return");case 5:r=this.fishArea.getComponent(y),s=r.width,o=r.height,50,u=a().mark((function e(){var t,n,r,i,u,l,f,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.value,(n=h.playerData.fishList.find((function(e){return e.id===t})))&&!n.isDead){e.next=4;break}return e.abrupt("return",0);case 4:if(r="female"===n.gender?h.femaleFishPrefabsByStage[n.stage-1]:h.maleFishPrefabsByStage[n.stage-1]){e.next=7;break}return e.abrupt("return",0);case 7:(i=g(r)).name="Fish_"+n.id,u=Math.random()*(s-100)-(s/2-50),l=Math.random()*(o-100)-(o/2-50),f=Math.random()>.5?1:-1,i.setPosition(u,l,0),i.setScale(new v(f,1,1)),i.initialDirection=f,null==(d=i.getComponent(T))||d.setFishData(n),h.fishArea.addChild(i);case 18:case"end":return e.stop()}}),e)})),l=i(n.fishIds);case 11:if((c=l()).done){e.next=18;break}return e.delegateYield(u(),"t0",13);case 13:if(0!==e.t0){e.next=16;break}return e.abrupt("continue",16);case 16:e.next=11;break;case 18:this.currentTankId=t;case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),u.replaceFishNode=function(e){var t,n=this.fishArea.getChildByName("Fish_"+e.id);if(!n)return console.warn("Êâæ‰∏çÂà∞ÂéüÈ≠öÁØÄÈªû Fish_"+e.id),null;var r=n.getPosition(),a=null!=(t=n.initialDirection)?t:1;n.destroy();var i,s=e.stage-1;if(6===e.stage&&e.adultForm){var o=this.formToIndex(e.adultForm);i="female"===e.gender?this.femaleStage6FormPrefabs[o]:this.maleStage6FormPrefabs[o]}else i="male"===e.gender?this.maleFishPrefabsByStage[s]:this.femaleFishPrefabsByStage[s];if(!i)return console.warn("Êâæ‰∏çÂà∞Â∞çÊáâÈ≠ö prefabÔºöstage="+e.stage+", gender="+e.gender),null;var u=g(i);u.name="Fish_"+e.id,u.setPosition(r),u.initialDirection=a,u.setScale(new v(a,1,1)),this.fishArea.addChild(u);var l=u.getComponent(T);return l&&(l.setFishData(e),null==l.onClickFish||l.onClickFish()),u},u.processDailyUpdate=function(){var e=r(a().mark((function e(){var t,n,r,s,o,u,l,c,h,f,d,p,m,b,g,y,v,k,w,x,D,T,B,I;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new Date,n=t.toISOString().split("T")[0],r=this.playerData.lastLoginDate||n,s=new Date(this.playerData.lastLoginTime||t),o=this.playerData.tankEnvironment,u=(t.getTime()-s.getTime())/36e5,l=Math.floor((Date.parse(n)-Date.parse(r))/864e5),c=100/72,h=2,f=[],null==o.badEnvLoginDays&&(o.badEnvLoginDays=0),d=i(this.playerData.fishList);case 12:if((p=d()).done){e.next=36;break}if(!(g=p.value).isDead){e.next=16;break}return e.abrupt("continue",34);case 16:if(y=null!=(m=g.hungerRateMultiplier)?m:1,v=null!=(b=g.status)&&b.sick?1.5:1,k=c*y*v,g.hunger+=u*k,g.hunger=Math.min(g.hunger,100),!(g.hunger>=100)){e.next=32;break}return g.isDead=!0,g.deathDate=n,g.emotion="dead",f.push(g.name),console.log(g.name+" Âõ†È£¢È§ìÈÅé‰πÖËÄåÊ≠ª‰∫°"),w=g,this.family.dissolveOnDeath(w),e.next=31,F.savePlayerDataWithCache(this.playerData);case 31:return e.abrupt("continue",34);case 32:l>0&&(g.growthDaysPassed+=l,C.tryStageUpgradeByGrowthDays(g)&&(console.log(g.name+" ÂçáÁ¥öÁÇ∫Á¨¨ "+g.stage+" ÈöéÔºÅÔºàËá™ÁÑ∂Èï∑Â§ßÔºâ"),6!==g.stage||g.adultForm||(g.adultForm=this.pickAdultForm(g,this.playerData),x=this.getAdultFormDisplayName(g.adultForm),this.showNotice(g.name+" Â∑≤ÊàêÁÇ∫Á¨¨ÂÖ≠ÈöéÔºåÂ±¨Êñº„Äå"+x+"„ÄçÂûãÊÖãÔºÅ","env")))),g.hunger>=80&&(g.emotion="hungry");case 34:e.next=12;break;case 36:return null==o.loginDaysSinceClean&&(o.loginDaysSinceClean=0),l>0&&(o.loginDaysSinceClean+=1),L.shouldUpdateTemperature(this.playerData)&&L.updateTemperature(this.playerData),L.checkWaterDirty(this.playerData),l>0&&(L.isEnvBad(this.playerData)?o.badEnvLoginDays+=1:o.badEnvLoginDays=0,o.badEnvLoginDays>=h&&(D=this.playerData.fishList.filter((function(e){return!e.isDead&&!e.status.sick}))).length>0&&(T=Math.floor(Math.random()*D.length),D[T].status.sick=!0,console.log("Áí∞Â¢É‰∏çËâØÂ∑≤ÊåÅÁ∫å "+o.badEnvLoginDays+" Â§©Ôºå"+D[T].name+" ÁîüÁóÖ‰∫Ü"),o.badEnvLoginDays=0)),f.length>0&&(B=f.join("„ÄÅ"),I=B+"\nÂõ†ÁÇ∫Â§™È§ìÔºåÊ≤íËÉΩÊíê‰∏ãÂéª...\n‰ΩÜÁâ†ÁöÑË®òÊÜ∂ÈÇÑÂú®ÊüêÂÄãÂú∞ÊñπÁ≠â‰Ω†",this.showNotice(I,"death")),this.playerData.lastLoginDate=n,this.playerData.lastLoginTime=t.toISOString(),e.next=46,this.checkAndUnlockCapacityForFirstTank();case 46:return e.next=48,this.checkAndUnlockNextTankIfEligible(1);case 48:return e.next=50,this.checkAndUnlockNextTankIfEligible(2);case 50:return e.next=52,F.savePlayerDataWithCache(this.playerData);case 52:return e.next=54,this.refreshEnvironmentUI();case 54:this.updateTankFishCountLabel(),this.updateAddFishBtnState(),console.log("Êõ¥Êñ∞ÂÆåÊàêÔºöÁ∂ìÈÅé "+u.toFixed(2)+" Â∞èÊôÇÔºåÈ£¢È§ìËàáÊàêÈï∑Ë≥áÊñôÂ∑≤Êõ¥Êñ∞");case 57:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.handlePlayerDataChange=function(){var e=r(a().mark((function e(t,n){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._handlingDMChange){e.next=3;break}return e.abrupt("return");case 3:return this._handlingDMChange=!0,e.prev=4,t&&(this.playerData=t),e.next=8,this.checkAndUnlockCapacityForFirstTank();case 8:return e.next=10,this.checkAndUnlockNextTankIfEligible(1);case 10:return e.next=12,this.checkAndUnlockNextTankIfEligible(2);case 12:return e.next=14,this.refreshEnvironmentUI();case 14:return this.updateTankFishCountLabel(),this.updateAddFishBtnState(),e.next=18,null==(r=this.tombManager)||null==r.refreshTombs?void 0:r.refreshTombs();case 18:return e.prev=18,this._handlingDMChange=!1,e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[4,,18,21]])})));return function(t,n){return e.apply(this,arguments)}}(),u.refreshEnvironmentUI=function(){var e=r(a().mark((function e(){var t,n,r,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.playerData){e.next=2;break}return e.abrupt("return");case 2:t=this.playerData.tankEnvironment,n=this.playerData.inventory.items,this.temperatureLabel&&(this.temperatureLabel.string=t.temperature.toFixed(1)+"¬∞C"),t.temperature<this.minComfortTemp?this.temperatureLabel.color=Pt:t.temperature>this.maxComfortTemp?this.temperatureLabel.color=Lt:this.temperatureLabel.color=It,this.waterQualityLabel&&(this.waterQualityLabel.string="clean"===t.waterQualityStatus?"Clean":"Dirty"),this.waterQualityLabel&&(this.waterQualityLabel.color="clean"===t.waterQualityStatus?It:Lt),this.dirtyWaterOverlay&&(this.dirtyWaterOverlay.active="clean"!==t.waterQualityStatus),this.dragonboneLabel&&(this.dragonboneLabel.string=this.playerData.dragonBones.toString()),this.fishCountLabel&&(this.fishCountLabel.string=this.playerData.fishList.length.toString()),this.heaterCountLabel&&(this.heaterCountLabel.string=""+n.heater),this.fanCountLabel&&(this.fanCountLabel.string=""+n.fan),this.brushCountLabel&&(this.brushCountLabel.string=""+n.brush),r=t.temperature<this.minComfortTemp,i=t.temperature>this.maxComfortTemp,this.heaterBtn&&(this.heaterBtn.interactable=n.heater>0&&r),this.fanBtn&&(this.fanBtn.interactable=n.fan>0&&i),this.brushBtn&&(this.brushBtn.interactable=n.brush>0),this.updateEnvironmentOverlays(t);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.updateEnvironmentOverlays=function(e){if(this.tombTankNode&&this.tombTankNode.active)return this.dirtyWaterOverlay&&(this.dirtyWaterOverlay.active=!1),this.coldOverlay&&(this.coldOverlay.active=!1),void(this.hotOverlay&&(this.hotOverlay.active=!1));var t="clean"!==e.waterQualityStatus,n=e.temperature<this.minComfortTemp,r=e.temperature>this.maxComfortTemp;this.dirtyWaterOverlay&&(this.dirtyWaterOverlay.active=t),this.coldOverlay&&(this.coldOverlay.active=!t&&n),this.hotOverlay&&(this.hotOverlay.active=!t&&r)},u.maybeShowEnvNoticeOnEnter=function(){var e,t;if(this.playerData&&!this.isViewingFriend&&!(null!=(e=this.tombTankNode)&&e.active||null!=(t=this.noticePanel)&&t.active&&"death"===this.lastNoticeType)){var n=this.playerData.tankEnvironment,r=n.temperature<this.minComfortTemp,a=n.temperature>this.maxComfortTemp;"clean"!==n.waterQualityStatus?this.showNotice("È≠öÁº∏È´íÈ´íÁöÑÔΩûÂø´Áî®È≠öÁº∏Âà∑Ê∏ÖÊΩîÈ≠öÁº∏","env"):r?this.showNotice("È≠öÁº∏Â•ΩÂÜ∑ÂëÄÔΩûÂø´Áî®Âä†ÁÜ±Âô®ÂçáÊ∫´","env"):a&&this.showNotice("È≠öÁº∏Âø´ÁÖÆÊ≤∏Âï¶ÔΩûÂø´Áî®È¢®ÊâáÈôçÊ∫´ÊïëÊïëÂ∞èÈ≠ö","env")}},u.showNotice=function(e,t){void 0===t&&(t="env"),this.lastNoticeType=t,this.noticeLabel.string=e,this.noticePanel.active=!0},u.onClickHeater=function(){var e=r(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.playerData.inventory.items,n=this.playerData.tankEnvironment,!(t.heater<=0)){e.next=5;break}return I(this.floatingNode,"Âä†ÁÜ±Âô®Â∫´Â≠ò‰∏çË∂≥"),e.abrupt("return");case 5:if(!(n.temperature>=this.minComfortTemp&&n.temperature<=this.maxComfortTemp)){e.next=8;break}return I(this.floatingNode,"ÁõÆÂâçÊ∞¥Ê∫´Ê≠£Â∏∏ÔºåÁÑ°ÈúÄ‰ΩøÁî®Âä†ÁÜ±Âô®"),e.abrupt("return");case 8:if(!(n.temperature>this.maxComfortTemp)){e.next=11;break}return I(this.floatingNode,"ÁõÆÂâçÁÇ∫È´òÊ∫´ÁãÄÊÖãÔºåË´ã‰ΩøÁî®È¢®Êâá"),e.abrupt("return");case 11:return e.next=13,this.confirmDialogManager.ask("Á¢∫ÂÆöË¶Å‰ΩøÁî®Âä†ÁÜ±Âô®ÂóéÔºü");case 13:if(e.sent){e.next=16;break}return e.abrupt("return");case 16:return e.next=18,this.useHeater();case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.useHeater=function(){var e=r(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.playerData.inventory.items,n=this.playerData.tankEnvironment,!(t.heater<=0)){e.next=5;break}return I(this.floatingNode,"Âä†ÁÜ±Âô®Â∫´Â≠ò‰∏çË∂≥"),e.abrupt("return");case 5:if(!(n.temperature>=this.minComfortTemp)){e.next=8;break}return I(this.floatingNode,"ÁõÆÂâçÊ∞¥Ê∫´‰∏ç‰ΩéÔºå‰∏çÈúÄ‰ΩøÁî®Âä†ÁÜ±Âô®"),e.abrupt("return");case 8:return t.heater-=1,L.adjustTemperature(this.playerData),e.next=12,F.savePlayerDataWithCache(this.playerData);case 12:return e.next=14,this.refreshEnvironmentUI();case 14:I(this.floatingNode,"Â∑≤‰ΩøÁî®Âä†ÁÜ±Âô®");case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.onClickFan=function(){var e=r(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.playerData.inventory.items,n=this.playerData.tankEnvironment,!(t.fan<=0)){e.next=5;break}return I(this.floatingNode,"È¢®ÊâáÂ∫´Â≠ò‰∏çË∂≥"),e.abrupt("return");case 5:if(!(n.temperature>=this.minComfortTemp&&n.temperature<=this.maxComfortTemp)){e.next=8;break}return I(this.floatingNode,"ÁõÆÂâçÊ∞¥Ê∫´Ê≠£Â∏∏ÔºåÁÑ°ÈúÄ‰ΩøÁî®È¢®Êâá"),e.abrupt("return");case 8:if(!(n.temperature<this.minComfortTemp)){e.next=11;break}return I(this.floatingNode,"ÁõÆÂâçÁÇ∫‰ΩéÊ∫´ÁãÄÊÖãÔºåË´ã‰ΩøÁî®Âä†ÁÜ±Âô®"),e.abrupt("return");case 11:return e.next=13,this.confirmDialogManager.ask("Á¢∫ÂÆöË¶Å‰ΩøÁî®È¢®ÊâáÂóéÔºü");case 13:if(e.sent){e.next=16;break}return e.abrupt("return");case 16:return e.next=18,this.useFan();case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.useFan=function(){var e=r(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.playerData.inventory.items,n=this.playerData.tankEnvironment,!(t.fan<=0)){e.next=5;break}return I(this.floatingNode,"È¢®ÊâáÂ∫´Â≠ò‰∏çË∂≥"),e.abrupt("return");case 5:if(!(n.temperature<=this.maxComfortTemp)){e.next=8;break}return I(this.floatingNode,"ÁõÆÂâçÊ∞¥Ê∫´‰∏çÈ´òÔºå‰∏çÈúÄ‰ΩøÁî®È¢®Êâá"),e.abrupt("return");case 8:return t.fan-=1,L.adjustTemperature(this.playerData),e.next=12,F.savePlayerDataWithCache(this.playerData);case 12:return e.next=14,this.refreshEnvironmentUI();case 14:I(this.floatingNode,"Â∑≤‰ΩøÁî®È¢®Êâá");case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.onClickBrush=function(){var e=r(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.playerData.inventory.items,n=this.playerData.tankEnvironment,!(t.brush<=0)){e.next=5;break}return I(this.floatingNode,"È≠öÁº∏Âà∑Â∫´Â≠ò‰∏çË∂≥"),e.abrupt("return");case 5:if("clean"!==n.waterQualityStatus){e.next=8;break}return I(this.floatingNode,"ÁõÆÂâçÈ≠öÁº∏Âæà‰πæÊ∑®ÔºåÁÑ°ÈúÄ‰ΩøÁî®È≠öÁº∏Âà∑"),e.abrupt("return");case 8:return e.next=10,this.confirmDialogManager.ask("Á¢∫ÂÆöË¶Å‰ΩøÁî®È≠öÁº∏Âà∑ÂóéÔºü");case 10:if(e.sent){e.next=13;break}return e.abrupt("return");case 13:return e.next=15,this.useBrush();case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.useBrush=function(){var e=r(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=this.playerData.inventory.items).brush<=0)){e.next=4;break}return I(this.floatingNode,"È≠öÁº∏Âà∑Â∫´Â≠ò‰∏çË∂≥"),e.abrupt("return");case 4:return t.brush-=1,L.cleanWater(this.playerData),e.next=8,F.savePlayerDataWithCache(this.playerData);case 8:return e.next=10,this.refreshEnvironmentUI();case 10:I(this.floatingNode,"Â∑≤Ê∏ÖÊΩîÈ≠öÁº∏");case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.getAliveFishInTank=function(e){var t,n=this,r=null==(t=this.playerData)?void 0:t.tankList.find((function(t){return t.id===e}));return r&&this.playerData?r.fishIds.map((function(e){return n.playerData.fishList.find((function(t){return t.id===e}))})).filter((function(e){return e&&!e.isDead})):[]},u.hasDeadFish=function(){var e;return!(null==(e=this.playerData)||!e.fishList.some((function(e){return e.isDead})))},u.checkAndUnlockCapacityForFirstTank=function(){var e=r(a().mark((function e(){var t,n,r,i,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.playerData){e.next=2;break}return e.abrupt("return");case 2:if(1===this.playerData.tankList.length){e.next=4;break}return e.abrupt("return");case 4:if(r=this.playerData.tankList.find((function(e){return 1===e.id}))){e.next=7;break}return e.abrupt("return");case 7:if(!((null!=(t=r.capacity)?t:3)>=6)){e.next=9;break}return e.abrupt("return");case 9:if(i=this.getAliveFishInTank(1),s=i.length>0&&i.every((function(e){var t;return(null!=(t=e.stage)?t:1)>=3})),!((null!=(n=r.capacity)?n:3)<6&&s)){e.next=16;break}return r.capacity=6,e.next=15,F.savePlayerDataWithCache(this.playerData);case 15:I(this.floatingNode,"Á¨¨‰∏ÄÁº∏ÂÆπÈáèËß£ÈéñÔºö3 ‚Üí 6ÔºÅ");case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.checkAndUnlockNextTankIfEligible=function(){var e=r(a().mark((function e(t){var n,r,i,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.playerData){e.next=2;break}return e.abrupt("return");case 2:if(!(this.playerData.tankList.length>=3)){e.next=4;break}return e.abrupt("return");case 4:if(r=this.playerData.tankList.find((function(e){return e.id===t}))){e.next=7;break}return e.abrupt("return");case 7:if(i=this.getAliveFishInTank(t),!((null!=(n=r.capacity)?n:1===t?3:6)<6)){e.next=10;break}return e.abrupt("return");case 10:if(!(i.length<6)){e.next=12;break}return e.abrupt("return");case 12:if(i.every((function(e){var t;return(null!=(t=e.stage)?t:1)>=6}))){e.next=14;break}return e.abrupt("return");case 14:return s=this.playerData.tankList.length+1,this.playerData.tankList.push({id:s,name:"È≠öÁº∏ "+s,comfort:100,fishIds:[],capacity:6}),e.next=18,F.savePlayerDataWithCache(this.playerData);case 18:I(this.floatingNode,"ÊàêÂäüÈñãÂïüÁ¨¨ "+s+" Áº∏ÔºÅ");case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),u.createFish=function(e){var t=this.playerData,n=(t.fishList.reduce((function(e,t){return Math.max(e,t.id)}),0)||0)+1,r=["male","female"],a={id:n,name:"È±òÈæç"+n+"Ëôü",gender:r[Math.floor(Math.random()*r.length)],stage:1,growthDaysPassed:0,lastFedDate:(new Date).toISOString(),hunger:50,hungerRateMultiplier:1,appearance:"beautiful",outfit:{head:null,accessories:[]},isMarried:!1,spouseId:null,status:{hungry:!1,hot:!1,cold:!1,sick:!1},emotion:"happy",isDead:!1,tankId:e};t.fishList.push(a),t.tankList.find((function(t){return t.id===e})).fishIds.push(a.id)},u.getDirectAddCost=function(){return 1===this.playerData.tankList.length?0:80},u.canAddFish=function(e){var t,n;if(!this.playerData)return{ok:!1,msg:"Ë≥áÊñôÂ∞öÊú™Â∞±Á∑í"};if(this.isViewingFriend||null!=(t=this.tombTankNode)&&t.active)return{ok:!1,msg:"Ê≠§Áï´Èù¢‰∏çÂèØÂä†È≠ö"};if(this.hasDeadFish())return{ok:!1,msg:"ÊúâÂ∞èÈ≠öÂú®Â¢ìÂú∞Á≠â‰Ω†ÔºåÂÖàÂéªÊääÁâ†Êä±ÂõûÂÆ∂ÂêßÔΩû"};var r=this.playerData.tankList.find((function(t){return t.id===e}));if(!r)return{ok:!1,msg:"Êâæ‰∏çÂà∞Ê≠§È≠öÁº∏"};var a=null!=(n=r.capacity)?n:1===r.id?3:6;return this.getAliveFishInTank(e).length>=a?{ok:!1,msg:"Â∑≤ÈÅîÈ≠öÁº∏‰∏äÈôê"}:{ok:!0}},u.commitAddFish=function(){var e=r(a().mark((function e(t,n,r){var i,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.playerData,!(n>0)){e.next=6;break}if(!((null!=(s=i.dragonBones)?s:0)<n)){e.next=5;break}return I(this.floatingNode,"ÈæçÈ™®‰∏çÂ§†‚Ä¶ÂÜçÂä™ÂäõÂ≠ò‰∏Ä‰∏ãÂêßÔºÅ"),e.abrupt("return");case 5:i.dragonBones-=n;case 6:return this.createFish(t),e.next=9,F.savePlayerDataWithCache(i);case 9:return e.next=11,this.switchTank(t);case 11:this.updateTankFishCountLabel(),this.updateAddFishBtnState(),I(this.floatingNode,r);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),u.onClickAddFish=function(){var e=r(a().mark((function e(){var t,n,r,i,s,o,u,l,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.currentTankId,(i=this.canAddFish(r)).ok){e.next=8;break}if(i.msg&&I(this.floatingNode,i.msg),!this.hasDeadFish()){e.next=7;break}return e.next=7,this.switchToTombTank();case 7:return e.abrupt("return");case 8:return s=this.playerData.tankList.find((function(e){return e.id===r})),o=null!=(t=s.capacity)?t:1===s.id?3:6,u=this.getAliveFishInTank(r).length,l=this.getDirectAddCost(),c=null!=(n=this.playerData.dragonBones)?n:0,h=0===l?"Ë¶ÅÂ§öÈÇÄË´ã‰∏ÄÈöªÂ∞èÈ≠öÂõûÂÆ∂ÂóéÔºüÔºàÂÖçË≤ªÔºâ\nÁõÆÂâçÔºö"+u+" / "+o:"Ë¶ÅËä± "+l+" ÈæçÈ™®Êî∂Á∑®‰∏ÄÈöªÂ∞èÈ≠öÂóéÔºü\nÁõÆÂâçÔºö"+u+" / "+o+"\n‰Ω†ÊúâÔºö"+c+" ÈæçÈ™®",e.next=16,this.confirmDialogManager.ask(h);case 16:if(e.sent){e.next=19;break}return e.abrupt("return");case 19:return e.next=21,this.commitAddFish(r,l,0===l?"ÊÅ≠ÂñúÔΩûÈ≠öÂØ∂ÂØ∂Ë™ïÁîüÂï¶ÔºÅ":"Â∑≤Ëä±Ë≤ª "+l+" ÈæçÈ™®");case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.updateTankFishCountLabel=function(){var e,t=this;if(this.playerData){var n=this.playerData.tankList.find((function(e){return e.id===t.currentTankId}));if(n){var r=this.getAliveFishInTank(this.currentTankId).length,a=null!=(e=n.capacity)?e:1===n.id?3:6;this.tankFishCountLabel&&(this.tankFishCountLabel.string="Êú¨Áº∏Ôºö"+r+" / "+a)}}},u.updateAddFishBtnState=function(){var e,t,n=this;if(this.playerData&&this.addFishBtn)if(this.isViewingFriend||null!=(e=this.tombTankNode)&&e.active)this.addFishBtn.interactable=!1;else if(this.hasDeadFish())this.addFishBtn.interactable=!1;else{var r=this.playerData.tankList.find((function(e){return e.id===n.currentTankId}));if(r){var a=null!=(t=r.capacity)?t:1===r.id?3:6,i=this.getAliveFishInTank(this.currentTankId).length;this.addFishBtn.interactable=i<a}}},u.onClickTankButton=function(e){var t,n;if(!this.isViewingFriend&&e>=(null!=(t=null==(n=this.playerData)||null==(n=n.tankList)?void 0:n.length)?t:0))return void I(this.floatingNode,"ÈÄôÂÄãÈ≠öÁº∏Â∞öÊú™ÈñãÂïü");this.isViewingFriend&&this.viewingFriend?this.renderFriendTankByIndex(e):this.switchTank(e+1)},u.marryFish=function(){var e=r(a().mark((function e(t,n,r){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[GM] marryFish",{myFishId:t,partnerFishId:n,partnerOwnerGameId:r}),e.next=3,this.family.marry(t,this.playerData.gameId,n,r);case 3:e.sent&&this.node.emit("marriage-updated",{fishId:t,spouseId:n});case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),u.breedFish=function(){var e=r(a().mark((function e(t){var n,r,i,s,o,u,l,c,h,f,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._breedingInProgress){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,F.getPlayerDataCached({refresh:!0});case 4:if(i=e.sent,s=i.fishList.find((function(e){return e.id===t}))){e.next=8;break}return e.abrupt("return");case 8:if(!s.isMarried||null==s.spouseId||s.spouseOwnerGameId){e.next=17;break}if(l=this.node.scene.getComponentInChildren(U),c=null!=(o=null!=(u=null==l||null==l.getAllFriendPlayerData?void 0:l.getAllFriendPlayerData())?u:this.friendSnapshot)?o:[],!(h=c.find((function(e){return e.fishList.some((function(e){return e.id===s.spouseId}))})))){e.next=17;break}return s.spouseOwnerGameId=h.gameId,e.next=16,F.savePlayerDataWithCache(i);case 16:this.playerData=i;case 17:return f=null!=(n=null==(r=this.playerData)?void 0:r.dragonBones)?n:0,d="Á¢∫ÂÆöË¶ÅËä±Ë≤ª 50 ÈæçÈ™®ÁîüÈ≠öÂØ∂ÂØ∂ÂóéÔºü\n‰Ω†ÊúâÔºö"+f+" ÈæçÈ™®",e.next=21,this.confirmDialogManager.ask(d);case 21:if(e.sent){e.next=24;break}return e.abrupt("return");case 24:return this._breedingInProgress=!0,e.prev=25,e.next=28,this.family.breed(t);case 28:return e.prev=28,this._breedingInProgress=!1,e.finish(28);case 31:case"end":return e.stop()}}),e,this,[[25,,28,31]])})));return function(t){return e.apply(this,arguments)}}(),u.onClickRecharge=function(){var e=r(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.playerData){e.next=4;break}return I(this.floatingNode,"Áé©ÂÆ∂Ë≥áÊñôÂ∞öÊú™ËºâÂÖ•"),e.abrupt("return");case 4:return"small",e.next=7,S(this.playerData.userId,"small");case 7:t=e.sent,n=t.paymentUrl,window.location.href=n,e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("[Recharge] error:",e.t0),I(this.floatingNode,"Âª∫Á´ã‰ªòÊ¨æÂ§±ÊïóÔºåË´ãÁ®çÂæåÂÜçË©¶");case 16:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(){return e.apply(this,arguments)}}(),t}(k)).prototype,"floatingNode",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Me=t(Ee.prototype,"confirmDialogManager",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ae=t(Ee.prototype,"tombManager",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Oe=t(Ee.prototype,"activeTankViewport",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ue=t(Ee.prototype,"fishArea",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ze=t(Ee.prototype,"defaultBackgroundSpriteFrame",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_e=t(Ee.prototype,"maleFishPrefabsByStage",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Re=t(Ee.prototype,"femaleFishPrefabsByStage",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ve=t(Ee.prototype,"maleStage6FormPrefabs",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),He=t(Ee.prototype,"femaleStage6FormPrefabs",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Qe=t(Ee.prototype,"tankButtons",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),We=t(Ee.prototype,"tombTankBtn",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ge=t(Ee.prototype,"tombTankNode",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),je=t(Ee.prototype,"userNameLabel",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Je=t(Ee.prototype,"gameIdLabel",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ye=t(Ee.prototype,"userAvatar",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),qe=t(Ee.prototype,"defaultAvatar",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xe=t(Ee.prototype,"dragonboneLabel",[re],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ze=t(Ee.prototype,"fishCountLabel",[ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ke=t(Ee.prototype,"temperatureLabel",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$e=t(Ee.prototype,"waterQualityLabel",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),et=t(Ee.prototype,"minComfortTemp",[Bt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 18}}),tt=t(Ee.prototype,"maxComfortTemp",[Bt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 23}}),nt=t(Ee.prototype,"heaterBtn",[oe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rt=t(Ee.prototype,"fanBtn",[ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),at=t(Ee.prototype,"brushBtn",[le],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),it=t(Ee.prototype,"heaterCountLabel",[ce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),st=t(Ee.prototype,"fanCountLabel",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ot=t(Ee.prototype,"brushCountLabel",[fe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ut=t(Ee.prototype,"dirtyWaterOverlay",[de],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),lt=t(Ee.prototype,"coldOverlay",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ct=t(Ee.prototype,"hotOverlay",[me],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ht=t(Ee.prototype,"singInBtn",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ft=t(Ee.prototype,"signInPanel",[ge],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),dt=t(Ee.prototype,"noticePanel",[ye],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pt=t(Ee.prototype,"noticeLabel",[ve],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mt=t(Ee.prototype,"noticeCloseBtn",[ke],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),bt=t(Ee.prototype,"tombHintPanel",[we],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),gt=t(Ee.prototype,"tombHintCloseBtn",[xe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),yt=t(Ee.prototype,"backToMyTankBtn",[De],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),vt=t(Ee.prototype,"mailBoxBtn",[Te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),kt=t(Ee.prototype,"mailboxRedDot",[Fe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),wt=t(Ee.prototype,"addFishBtn",[Ce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xt=t(Ee.prototype,"tankFishCountLabel",[Be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Dt=t(Ee.prototype,"decorEditBtn",[Le],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Tt=t(Ee.prototype,"decorEditor",[Ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ft=t(Ee.prototype,"rechargeBtn",[Pe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ne=Ee))||Ne));u._RF.pop()}}}));

System.register("chunks:///_virtual/ItemCard.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,i,t,r,o,a,u,l,c,s,p,b,f;return{setters:[function(e){n=e.applyDecoratedDescriptor,i=e.inheritsLoose,t=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,u=e.Sprite,l=e.Label,c=e.Button,s=e.Node,p=e.resources,b=e.SpriteFrame,f=e.Component}],execute:function(){var d,m,y,h,g,B,w,v,L,F,I,z,C;o._RF.push({},"964e4fd2+5E9YvHGIkCH3vw","ItemCard",void 0);var k=a.ccclass,S=a.property;e("ItemCard",(d=k("ItemCard"),m=S(u),y=S(l),h=S(l),g=S(c),B=S(s),d((L=n((v=function(e){function n(){for(var n,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o))||this,t(n,"icon",L,r(n)),t(n,"nameLabel",F,r(n)),t(n,"priceLabel",I,r(n)),t(n,"buyBtn",z,r(n)),t(n,"ownedBadge",C,r(n)),n.item=void 0,n.onBuy=function(){},n}i(n,e);var o=n.prototype;return o.init=function(e,n){var i,t,r=this;this.item=e,this.onBuy=n.onBuy,this.nameLabel&&(this.nameLabel.string=null!=(i=e.name)?i:""),this.priceLabel&&(this.priceLabel.string=null!=(t=n.priceText)?t:""),this.ownedBadge&&(this.ownedBadge.active=n.owned),this.buyBtn&&(this.buyBtn.interactable=!n.owned&&n.canBuy),e.iconKey&&this.icon&&this.loadIconSpriteFrame(e.iconKey,(function(e){e&&(r.icon.spriteFrame=e)}))},o.loadIconSpriteFrame=function(e,n){p.load("icons/"+e+"/spriteFrame",b,(function(i,t){if(!i&&t)return n(t);p.load("icons/"+e,b,(function(i,t){if(!i&&t)return n(t);p.load("backgrounds/"+e+"/spriteFrame",b,(function(i,t){if(!i&&t)return n(t);p.load("backgrounds/"+e,b,(function(e,i){n(e?null:i)}))}))}))}))},o.onClickBuy=function(){this.onBuy(this.item)},n}(f)).prototype,"icon",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=n(v.prototype,"nameLabel",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=n(v.prototype,"priceLabel",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=n(v.prototype,"buyBtn",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=n(v.prototype,"ownedBadge",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=v))||w));o._RF.pop()}}}));

System.register("chunks:///_virtual/LiffBridge.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,n,t,i;return{setters:[function(e){r=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){t=e.cclegacy,i=e.sys}],execute:function(){function f(){return(f=r(n().mark((function e(r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.isBrowser){e.next=2;break}return e.abrupt("return");case 2:if(void 0!==window.liff){e.next=4;break}throw new Error("LIFF SDK not loaded");case 4:return e.next=6,liff.init({liffId:r});case 6:liff.isLoggedIn()||liff.login();case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function o(){return(o=r(n().mark((function e(){var r,t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.isBrowser&&void 0!==window.liff){e.next=2;break}return e.abrupt("return",{idToken:null,profile:null});case 2:return e.next=4,liff.getProfile();case 4:return r=e.sent,t=liff.getIDToken(),e.abrupt("return",{idToken:t,profile:r});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e({getIdentity:function(){return o.apply(this,arguments)},initLiff:function(e){return f.apply(this,arguments)}}),t._RF.push({},"dcf75MsRwZLDZnYvsEwcanH","LiffBridge",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/MailboxPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts","./UIUtils.ts"],(function(e){var t,n,r,i,a,o,l,s,c,u,d,f,p,h,m,g,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.asyncToGenerator,i=e.regeneratorRuntime,a=e.initializerDefineProperty,o=e.assertThisInitialized,l=e.createForOfIteratorHelperLoose},function(e){s=e.cclegacy,c=e._decorator,u=e.Node,d=e.Prefab,f=e.instantiate,p=e.Label,h=e.Button,m=e.Component},function(e){g=e.DataManager},function(e){v=e.showFloatingTextCenter}],execute:function(){var b,y,C,w,x,R,N,P,k,L,F,I,B;s._RF.push({},"fed52Lhe5RFf4oUcYGkxMjL","MailboxPanel",void 0);var M=c.ccclass,_=c.property;e("MailboxPanel",(b=M("MailboxPanel"),y=_(u),C=_(d),w=_(d),x=_(u),R=_(u),b((k=t((P=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=e.call.apply(e,[this].concat(r))||this,a(t,"listContent",k,o(t)),a(t,"friendReqRowPrefab",L,o(t)),a(t,"genericRowPrefab",F,o(t)),a(t,"emptyStateNode",I,o(t)),a(t,"floatingNode",B,o(t)),t}n(t,e);var s=t.prototype;return s.onEnable=function(){this.refresh()},s.start=function(){this.refresh()},s.refresh=function(){var e=r(i().mark((function e(){var t,n,r,a,o,s,c,u,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.getInbox();case 3:if(n=e.sent,this.listContent.removeAllChildren(),r=n.filter((function(e){return"unread"===e.status})).length,this.node.emit("mailbox-refreshed",{unread:r}),null==(t=this.node.scene)||t.emit("mailbox-refreshed",{unread:r}),(a=n.filter((function(e){return"unread"===e.status}))).length){e.next=14;break}return this.emptyStateNode&&(this.emptyStateNode.active=!0),e.abrupt("return");case 14:this.emptyStateNode&&(this.emptyStateNode.active=!1);case 15:for(o=l(a);!(s=o()).done;)"FRIEND_REQUEST"===(d=s.value).type&&null!=(c=d.payload)&&c.requestId&&null!=(u=d.payload)&&u.fromUserId?this.renderFriendRequestRow(d):this.renderGenericRow(d);e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),console.warn("[MailboxPanel] refresh failed:",e.t0),v(this.floatingNode,"ËºâÂÖ•‰ø°ÁÆ±Â§±Êïó");case 22:case"end":return e.stop()}}),e,this,[[0,18]])})));return function(){return e.apply(this,arguments)}}(),s.renderFriendRequestRow=function(e){var t,n,a,o,l=this,s=f(this.friendReqRowPrefab),c=null==(t=s.getChildByName("TitleLabel"))?void 0:t.getComponent(p),u=null==(n=s.getChildByName("DetailLabel"))?void 0:n.getComponent(p);if(c&&(c.string=e.title||"Â•ΩÂèãÈÇÄË´ã"),u){var d,m,g=(null==(d=e.fromUser)?void 0:d.displayName)||"(Êú™Ë®≠ÂÆöÊö±Á®±)";null==(m=e.payload)||m.fromUserId;u.string=g+" ÊÉ≥Âä†‰Ω†ÁÇ∫Â•ΩÂèã"}var v=null==(a=s.getChildByName("AcceptBtn"))?void 0:a.getComponent(h),b=null==(o=s.getChildByName("DeclineBtn"))?void 0:o.getComponent(h);v&&v.node.on(h.EventType.CLICK,r(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.handleFriendRespond(e,"accept");case 2:case"end":return t.stop()}}),t)}))),this),b&&b.node.on(h.EventType.CLICK,r(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.handleFriendRespond(e,"decline");case 2:case"end":return t.stop()}}),t)}))),this),s.parent=this.listContent},s.renderGenericRow=function(e){var t,n,a,o=this,l=f(this.genericRowPrefab),s=null==(t=l.getChildByName("TitleLabel"))?void 0:t.getComponent(p),c=null==(n=l.getChildByName("DetailLabel"))?void 0:n.getComponent(p);s&&(s.string=e.title||"Ë®äÊÅØ"),c&&(c.string=e.body||"");var u=null==(a=l.getChildByName("AckBtn"))?void 0:a.getComponent(h);u&&u.node.on(h.EventType.CLICK,r(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g.markMailRead(e.mailId);case 3:o.refresh(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),v(o.floatingNode,"Êìç‰ΩúÂ§±Êïó");case 9:case"end":return t.stop()}}),t,null,[[0,6]])}))),this),l.parent=this.listContent},s.handleFriendRespond=function(){var e=r(i().mark((function e(t,n){var r,a,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.respondFriendRequest(t.payload.requestId,n);case 3:return"accept"===n&&v(this.floatingNode,"Â∑≤ÊàêÁÇ∫Â•ΩÂèãÔºÅ"),"decline"===n&&v(this.floatingNode,"Â∑≤ÊãíÁµïÈÇÄË´ã"),e.prev=5,e.next=8,g.markMailRead(t.mailId);case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(5);case 12:return e.next=14,this.refresh();case 14:r=this.node.scene.getChildByName("FriendPanel"),null==(a=null==r?void 0:r.getComponent("FriendPanel"))||null==a.refreshList||a.refreshList(),e.next=23;break;case 19:e.prev=19,e.t1=e.catch(0),o=null==e.t1?void 0:e.t1.code,v(this.floatingNode,"friend_limit_reached_other"===o?"‰Ω†Â§™ÊÖ¢‰∫ÜÔºåÂ∞çÊñπÂ•ΩÂèãÂ∑≤Êªø":"friend_limit_reached_self"===o?"‰Ω†ÁöÑÂ•ΩÂèãÂ∑≤Êªø":"Êìç‰ΩúÂ§±ÊïóÔºåË´ãÁ®çÂæåÂÜçË©¶");case 23:case"end":return e.stop()}}),e,this,[[0,19],[5,10]])})));return function(t,n){return e.apply(this,arguments)}}(),t}(m)).prototype,"listContent",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(P.prototype,"friendReqRowPrefab",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(P.prototype,"genericRowPrefab",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(P.prototype,"emptyStateNode",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(P.prototype,"floatingNode",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=P))||N));s._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./ButtomPanelToggle.ts","./ConfirmDialogManager.ts","./DataManager.ts","./ExpandMenu.ts","./FashionManager.ts","./FishAnimate.ts","./FishDetailManager.ts","./FishLogic.ts","./FriendPanel.ts","./GameManager.ts","./MailboxPanel.ts","./RenamePanel.ts","./RewardItem.ts","./RewardPopup.ts","./SwimmingFish.ts","./TankEnvironmentManager.ts","./TombManager.ts","./Api.ts","./LiffBridge.ts","./BackgroundAnimator.ts","./DecorationEditor.ts","./DecorationItem.ts","./ChoosePartnerDialog.ts","./FishFamilyService.ts","./QuizData.ts","./QuizPanel.ts","./MonthlySignInManager.ts","./SignInPanel.ts","./WeeklySignInManager.ts","./CategoryTab.ts","./ItemCard.ts","./PurchaseModal.ts","./StoreState.ts","./StoreUI.ts","./Toast.ts","./mockCatalog.ts","./types.ts","./DevTest.ts","./UIUtils.ts","./utils.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/mockCatalog.ts",["cc"],(function(e){var c;return{setters:[function(e){c=e.cclegacy}],execute:function(){c._RF.push({},"0d7c0rymbNFRZEj9rv43AOK","mockCatalog",void 0);e("CATEGORIES",["ÂÖ®ÈÉ®","Ëó•ÂìÅ","ÊúçÈ£æ","È£ºÊñô","Áí∞Â¢É","Ë£ùÈ£æ"]),e("MOCK_CATALOG",[{id:"1",sku:"med_trans",name:"ËÆäÊÄßËó•",type:"CONSUMABLE",category:"Ëó•ÂìÅ",iconKey:"trans_medicine",priceSoft:{currency:"DRAGONBONE",amount:20}},{id:"2",sku:"med_change",name:"Êï¥ÂΩ¢Ëó•",type:"CONSUMABLE",category:"Ëó•ÂìÅ",iconKey:"change",priceSoft:{currency:"DRAGONBONE",amount:100}},{id:"3",sku:"med_cold",name:"ÊÑüÂÜíËó•",type:"CONSUMABLE",category:"Ëó•ÂìÅ",iconKey:"cold_medicine",priceSoft:{currency:"DRAGONBONE",amount:5}},{id:"4",sku:"med_lvup",name:"ÂçáÁ¥öËó•",type:"CONSUMABLE",category:"Ëó•ÂìÅ",iconKey:"lv_up",priceSoft:{currency:"DRAGONBONE",amount:50}},{id:"5",sku:"med_revive",name:"Âæ©Ê¥ªËó•",type:"CONSUMABLE",category:"Ëó•ÂìÅ",iconKey:"revive",priceSoft:{currency:"DRAGONBONE",amount:50}},{id:"6",sku:"feed_normal",name:"ÊôÆÈÄöÈ£ºÊñô",type:"CONSUMABLE",category:"È£ºÊñô",iconKey:"normal_food",priceSoft:{currency:"DRAGONBONE",amount:1}},{id:"7",sku:"feed_high",name:"È´òÁ¥öÈ£ºÊñô",type:"CONSUMABLE",category:"È£ºÊñô",iconKey:"high_level_food",priceSoft:{currency:"DRAGONBONE",amount:5}},{id:"8",sku:"env_brush",name:"È≠öÁº∏Âà∑",type:"CONSUMABLE",category:"Áí∞Â¢É",iconKey:"brush",priceSoft:{currency:"DRAGONBONE",amount:10}},{id:"9",sku:"env_fan",name:"È¢®Êâá",type:"CONSUMABLE",category:"Áí∞Â¢É",iconKey:"fan",priceSoft:{currency:"DRAGONBONE",amount:10}},{id:"10",sku:"heater",name:"Âä†ÁÜ±Ê£í",type:"CONSUMABLE",category:"Áí∞Â¢É",iconKey:"hot_bar",priceSoft:{currency:"DRAGONBONE",amount:10}},{id:"11",sku:"acc_bowtie",name:"Ëù¥Ëù∂Áµê",type:"NON_CONSUMABLE",category:"ÊúçÈ£æ",iconKey:"bowtie",priceSoft:{currency:"DRAGONBONE",amount:10}},{id:"12",sku:"hat_chef",name:"ÂªöÂ∏´Â∏Ω",type:"NON_CONSUMABLE",category:"ÊúçÈ£æ",iconKey:"chefhat",priceSoft:{currency:"DRAGONBONE",amount:15}},{id:"13",sku:"hat_crown",name:"ÁöáÂÜ†",type:"NON_CONSUMABLE",category:"ÊúçÈ£æ",iconKey:"crown",priceSoft:{currency:"DRAGONBONE",amount:30}},{id:"14",sku:"acc_flower",name:"Ëä±Áí∞",type:"NON_CONSUMABLE",category:"ÊúçÈ£æ",iconKey:"flower",priceSoft:{currency:"DRAGONBONE",amount:12}},{id:"15",sku:"acc_heart_glass",name:"ÊÑõÂøÉÁúºÈè°",type:"NON_CONSUMABLE",category:"ÊúçÈ£æ",iconKey:"heart_glass",priceSoft:{currency:"DRAGONBONE",amount:15}},{id:"16",sku:"hat_magic",name:"È≠îÊ≥ïÂ∏Ω",type:"NON_CONSUMABLE",category:"ÊúçÈ£æ",iconKey:"magic_hat",priceSoft:{currency:"DRAGONBONE",amount:20}},{id:"17",sku:"hat_beret",name:"Áï´ÂÆ∂Â∏Ω",type:"NON_CONSUMABLE",category:"ÊúçÈ£æ",iconKey:"paint_hat",priceSoft:{currency:"DRAGONBONE",amount:15}},{id:"18",sku:"hat_party",name:"Ê¥æÂ∞çÂ∏Ω",type:"NON_CONSUMABLE",category:"ÊúçÈ£æ",iconKey:"party_hat",priceSoft:{currency:"DRAGONBONE",amount:12}},{id:"19",sku:"acc_sunglass",name:"Â¢®Èè°",type:"NON_CONSUMABLE",category:"ÊúçÈ£æ",iconKey:"sunglass",priceSoft:{currency:"DRAGONBONE",amount:15}},{id:"20",sku:"hat_fedora",name:"Á¥≥Â£´Â∏Ω",type:"NON_CONSUMABLE",category:"ÊúçÈ£æ",iconKey:"hat",priceSoft:{currency:"DRAGONBONE",amount:18}},{id:"201",sku:"deco_rockHouse",name:"Â≤©Â±ã",type:"NON_CONSUMABLE",category:"Ë£ùÈ£æ",iconKey:"deco_rockHouse",priceSoft:{currency:"DRAGONBONE",amount:30}},{id:"202",sku:"deco_seaweed",name:"Êµ∑Ëçâ",type:"NON_CONSUMABLE",category:"Ë£ùÈ£æ",iconKey:"deco_seaweed",priceSoft:{currency:"DRAGONBONE",amount:20}},{id:"203",sku:"deco_shark",name:"ÈØäÈ≠ö",type:"NON_CONSUMABLE",category:"Ë£ùÈ£æ",iconKey:"deco_shark",priceSoft:{currency:"DRAGONBONE",amount:45}},{id:"204",sku:"deco_shell",name:"Ë≤ùÊÆº",type:"NON_CONSUMABLE",category:"Ë£ùÈ£æ",iconKey:"deco_shell",priceSoft:{currency:"DRAGONBONE",amount:25}},{id:"205",sku:"deco_slide",name:"Ê∫úÊªëÊ¢Ø",type:"NON_CONSUMABLE",category:"Ë£ùÈ£æ",iconKey:"deco_slide",priceSoft:{currency:"DRAGONBONE",amount:40}},{id:"206",sku:"deco_light_blue",name:"ËóçÂÖâ",type:"NON_CONSUMABLE",category:"Ë£ùÈ£æ",iconKey:"light_blue_icon",priceSoft:{currency:"DRAGONBONE",amount:15}},{id:"207",sku:"deco_light_pink",name:"Á≤âÂÖâ",type:"NON_CONSUMABLE",category:"Ë£ùÈ£æ",iconKey:"light_pink_icon",priceSoft:{currency:"DRAGONBONE",amount:15}},{id:"208",sku:"deco_light_yellow",name:"ÈªÉÂÖâ",type:"NON_CONSUMABLE",category:"Ë£ùÈ£æ",iconKey:"light_yellow_icon",priceSoft:{currency:"DRAGONBONE",amount:15}},{id:"304",sku:"bg_azure",name:"Êô¥ËóçÊµ∑ÂüüËÉåÊôØ",type:"NON_CONSUMABLE",category:"Ë£ùÈ£æ",iconKey:"bg_azure",priceSoft:{currency:"DRAGONBONE",amount:70}},{id:"305",sku:"bg_dream",name:"Â§¢ÂπªÊµ∑Ê¥ãËÉåÊôØ",type:"NON_CONSUMABLE",category:"Ë£ùÈ£æ",iconKey:"bg_dream",priceSoft:{currency:"DRAGONBONE",amount:80}}]);c._RF.pop()}}}));

System.register("chunks:///_virtual/MonthlySignInManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts","./RewardPopup.ts","./utils.ts"],(function(e){var t,n,a,r,i,o,l,u,s,p,c,m,h,d,y,g,f,b,S,w,F;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,a=e.initializerDefineProperty,r=e.assertThisInitialized,i=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){l=e.cclegacy,u=e._decorator,s=e.Node,p=e.Label,c=e.Button,m=e.Prefab,h=e.SpriteFrame,d=e.Component,y=e.UITransform,g=e.Vec3,f=e.tween,b=e.instantiate},function(e){S=e.DataManager},function(e){w=e.RewardPopup},function(e){F=e.getRandomItem}],execute:function(){var D,I,v,C,N,k,z,L,B,P,M,x,R,T,G,H,U,_,O,j,A,W,q,E,J,V,Y;l._RF.push({},"8f2972wm8JN0q4CufjSwzBR","MonthlySignInManager",void 0);var K=u.ccclass,Q=u.property;e("MonthlySignInManager",(D=K("MonthlySignInManager"),I=Q(s),v=Q(p),C=Q(c),N=Q(p),k=Q(m),z=Q(s),L=Q(h),B=Q(h),P=Q(h),M=Q(h),x=Q(h),R=Q(h),D((H=t((G=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i))||this,a(t,"daysGrid",H,r(t)),a(t,"monthlyCountLabel",U,r(t)),a(t,"claimButton",_,r(t)),a(t,"signInHintLabel",O,r(t)),a(t,"rewardPopupPrefab",j,r(t)),a(t,"flyingStampNode",A,r(t)),a(t,"normalFeedSpriteFrame",W,r(t)),a(t,"premiumFeedSpriteFrame",q,r(t)),a(t,"fanSpriteFrame",E,r(t)),a(t,"heaterSpriteFrame",J,r(t)),a(t,"brushSpriteFrame",V,r(t)),a(t,"defaultSpriteFrame",Y,r(t)),t.dayLabels=[],t.dayStampNodes=[],t.playerData=void 0,t}n(t,e);var l=t.prototype;return l.start=function(){var e=i(o().mark((function e(){var t,n,a,r,i,l,u,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(t=S.ready)?void 0:t.catch((function(){}));case 2:return e.next=4,S.getPlayerDataCached();case 4:if(this.playerData=e.sent,this.playerData&&this.playerData.signInData){e.next=8;break}return console.warn("[MonthlySignIn] Â∞öÊú™ÂèñÂæóÁé©ÂÆ∂Ë≥áÊñôÔºåÂÅúÁî®Êú¨ÂÖÉ‰ª∂ÂàùÂßãÂåñ"),e.abrupt("return");case 8:this.initDayNodes(),n=new Date,a=n.getMonth()+1,r=n.getFullYear(),i=n.toISOString().split("T")[0],(l=this.playerData.signInData.monthly).month===a&&l.year===r||(l.month=a,l.year=r,l.signedDaysCount=0,l.lastSignDate=""),this.updateSignInUI(),u=l.lastSignDate===i,s=l.signedDaysCount>=this.dayStampNodes.length,this.claimButton.interactable=!u&&!s,this.signInHintLabel.string=s?"Êú¨ÊúàÂ∑≤ÂÆåÊàêÁ∞ΩÂà∞":u?"‰ªäÊó•Â∑≤Á∞ΩÂà∞":"ÈªûÊìäÁ∞ΩÂà∞",this.claimButton.node.on("click",this.onClaimButtonClick,this);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.initDayNodes=function(){this.dayLabels=[],this.dayStampNodes=[];for(var e=0;e<this.daysGrid.children.length;e++){var t=this.daysGrid.children[e],n=t.getChildByName("Status"),a=t.getChildByName("Stamp");if(n&&a){var r=n.getComponent(p);r&&(this.dayLabels.push(r),this.dayStampNodes.push(a))}}},l.updateSignInUI=function(){var e=this.playerData.signInData.monthly;this.monthlyCountLabel.string="Êú¨ÊúàÁ¥ØË®àÁ∞ΩÂà∞Á¨¨ "+e.signedDaysCount+" Â§©";for(var t=0;t<this.dayLabels.length;t++){var n=this.dayLabels[t],a=this.dayStampNodes[t];n.string=""+(t+1),t<e.signedDaysCount?a.active=!0:a.active=!1}},l.addInventoryItem=function(e,t){var n=this.playerData.inventory;"normalFeed"===e?n.feeds.normal+=t:"premiumFeed"===e?n.feeds.premium+=t:e in n.items?n.items[e]+=t:console.warn("Êú™Áü•ÁöÑÁâ©ÂìÅ key: "+e)},l.onClaimButtonClick=function(){var e=i(o().mark((function e(){var t,n,a,r,i,l,u,s,p,c,m,h,d,D,I,v=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new Date,n=t.toISOString().split("T")[0],!((a=this.playerData.signInData.monthly).lastSignDate===n||a.signedDaysCount>=this.dayStampNodes.length)){e.next=5;break}return e.abrupt("return");case 5:if(!((r=a.signedDaysCount)>=this.dayStampNodes.length)){e.next=9;break}return console.warn("Á∞ΩÂà∞Ê†ºÂ≠êÊï∏Èáè‰∏çË∂≥"),e.abrupt("return");case 9:return i=this.dayStampNodes[r],a.signedDaysCount++,a.lastSignDate=n,l=t.getDay(),u=[],0===l||6===l?(s=F([{key:"premiumFeed",name:"È´òÁ¥öÈ£ºÊñô",count:1},{key:"fan",name:"È¢®Êâá",count:1},{key:"heater",name:"Âä†ÁÜ±Âô®",count:1},{key:"brush",name:"È≠öÁº∏Âà∑",count:1}]),this.addInventoryItem(s.key,s.count),u.push({icon:this.getIconSpriteFrame(s.key),name:s.name,count:s.count})):(this.addInventoryItem("normalFeed",1),u.push({icon:this.getIconSpriteFrame("normalFeed"),name:"ÊôÆÈÄöÈ£ºÊñô",count:1})),u.forEach((function(e){console.log("ÊúàÁ∞ΩÂà∞ÁçéÂãµÔºö"+e.name+" x"+e.count)})),e.next=18,S.savePlayerDataWithCache(this.playerData);case 18:this.claimButton.interactable=!1,this.signInHintLabel.string="‰ªäÊó•Â∑≤Á∞ΩÂà∞",p=i.getComponent(y).getBoundingBoxToWorld(),c=new g(p.x+p.width/2,p.y+p.height/2,0),m=this.flyingStampNode.parent.getComponent(y),h=m.convertToNodeSpaceAR(c),d=p.width/this.flyingStampNode.getComponent(y).width,D=p.height/this.flyingStampNode.getComponent(y).height,I=new g(d,D,1),this.flyingStampNode.active=!0,this.flyingStampNode.setScale(new g(3,3,1)),this.flyingStampNode.setPosition(new g(0,0,0)),f(this.flyingStampNode).to(1,{position:h,scale:I},{easing:"backOut"}).call((function(){v.updateSignInUI()})).delay(1).call((function(){var e=b(v.rewardPopupPrefab);e.getComponent(w).showRewards(u),v.node.getComponent(y).node.parent.addChild(e)})).start();case 31:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.getIconSpriteFrame=function(e){switch(e){case"normalFeed":return this.normalFeedSpriteFrame;case"premiumFeed":return this.premiumFeedSpriteFrame;case"fan":return this.fanSpriteFrame;case"heater":return this.heaterSpriteFrame;case"brush":return this.brushSpriteFrame;default:return this.defaultSpriteFrame}},t}(d)).prototype,"daysGrid",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(G.prototype,"monthlyCountLabel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(G.prototype,"claimButton",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(G.prototype,"signInHintLabel",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(G.prototype,"rewardPopupPrefab",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(G.prototype,"flyingStampNode",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(G.prototype,"normalFeedSpriteFrame",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(G.prototype,"premiumFeedSpriteFrame",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(G.prototype,"fanSpriteFrame",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(G.prototype,"heaterSpriteFrame",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(G.prototype,"brushSpriteFrame",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(G.prototype,"defaultSpriteFrame",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=G))||T));l._RF.pop()}}}));

System.register("chunks:///_virtual/PurchaseModal.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,r,a,o,l,s,u,c,h,f,p,b,m,d,y,g,B,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){a=t.cclegacy,o=t._decorator,l=t.Node,s=t.Sprite,u=t.Label,c=t.Button,h=t.Widget,f=t.UITransform,p=t.Size,b=t.UIOpacity,m=t.tween,d=t.easing,y=t.v3,g=t.resources,B=t.SpriteFrame,v=t.Component}],execute:function(){var L,w,C,q,M,z,S,A,x,k,O,P,F,N,R,D,I,E,U,T,_,G,K,W,j,H,V,X,J,Q,Y;a._RF.push({},"b4398mfrPhCVrFSe/Dkh1Xb","PurchaseModal",void 0);var Z=o.ccclass,$=o.property;t("PurchaseModal",(L=Z("PurchaseModal"),w=$(l),C=$(s),q=$(u),M=$(u),z=$(u),S=$(u),A=$(u),x=$(c),k=$(c),O=$(c),P=$(c),F=$(c),N=$(c),R=$(c),L((E=e((I=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a))||this,i(e,"panel",E,r(e)),i(e,"icon",U,r(e)),i(e,"nameLabel",T,r(e)),i(e,"ownedLabel",_,r(e)),i(e,"qtyLabel",G,r(e)),i(e,"haveLabel",K,r(e)),i(e,"needLabel",W,r(e)),i(e,"minBtn",j,r(e)),i(e,"minusBtn",H,r(e)),i(e,"plusBtn",V,r(e)),i(e,"maxBtn",X,r(e)),i(e,"confirmBtn",J,r(e)),i(e,"cancelBtn",Q,r(e)),i(e,"closeBtn",Y,r(e)),e.state=void 0,e.item=void 0,e.qty=1,e.onConfirm=null,e}n(e,t);var a=e.prototype;return a.open=function(t,e,n){var i,r,a=this;this.state=t,this.item=e,this.onConfirm=n,this.nameLabel&&(this.nameLabel.string=null!=(i=e.name)?i:"");var o="CONSUMABLE"===e.type?t.getCount(e.sku):t.isOwned(e.sku)?1:0;this.ownedLabel&&(this.ownedLabel.string="ÊåÅÊúâÊï∏Èáè "+o),this.icon&&e.iconKey&&this.loadIconSpriteFrame(e.iconKey,(function(t){if(t){a.icon.spriteFrame=t,a.icon.type=s.Type.SIMPLE,a.icon.sizeMode=s.SizeMode.RAW;var e=a.icon.getComponent(h);e&&(e.isAlignLeft=e.isAlignRight=!1,e.isAlignTop=e.isAlignBottom=!1);var n=a.icon.getComponent(f),i=t.getRect().width,r=t.getRect().height,o=Math.min(120/i,120/r,1);n.setContentSize(new p(Math.round(i*o),Math.round(r*o)))}})),this.qty=1,this.refresh();var l=null!=(r=this.panel.getComponent(b))?r:this.panel.addComponent(b);l.opacity=0,this.panel.setScale(.95,.95,1),this.node.active=!0,m(l).to(.14,{opacity:255},{easing:d.quadOut}).start(),m(this.panel).to(.14,{scale:y(1,1,1)},{easing:d.quadOut}).start()},a.unitPrice=function(){var t,e;return null!=(t=null==(e=this.item.priceSoft)?void 0:e.amount)?t:0},a.maxAffordable=function(){if("CONSUMABLE"!==this.item.type)return 1;var t=Math.max(1,this.unitPrice()),e=this.state.wallet.DRAGONBONE;return Math.max(0,Math.min(999,Math.floor(e/t)))},a.refresh=function(){var t=this.state.wallet.DRAGONBONE,e=this.unitPrice()*this.qty;this.qtyLabel&&(this.qtyLabel.string=String(this.qty)),this.haveLabel&&(this.haveLabel.string=t.toString()),this.needLabel&&(this.needLabel.string=e.toString());var n="CONSUMABLE"!==this.item.type&&this.state.isOwned(this.item.sku),i=this.maxAffordable()||1;this.minBtn&&(this.minBtn.interactable=this.qty>1),this.minusBtn&&(this.minusBtn.interactable=this.qty>1),this.plusBtn&&(this.plusBtn.interactable=this.qty<i),this.maxBtn&&(this.maxBtn.interactable=this.qty<i);var r=!n&&t>=e&&this.qty>=1;this.confirmBtn&&(this.confirmBtn.interactable=r)},a.loadIconSpriteFrame=function(t,e){g.load("icons/"+t+"/spriteFrame",B,(function(n,i){if(!n&&i)return e(i);g.load("icons/"+t,B,(function(n,i){if(!n&&i)return e(i);g.load("backgrounds/"+t+"/spriteFrame",B,(function(n,i){if(!n&&i)return e(i);g.load("backgrounds/"+t,B,(function(t,n){e(t?null:n)}))}))}))}))},a.onMin=function(){this.qty=1,this.refresh()},a.onDec=function(){this.qty>1&&(this.qty--,this.refresh())},a.onInc=function(){var t=this.maxAffordable()||1;this.qty<t&&(this.qty++,this.refresh())},a.onMax=function(){var t=this.maxAffordable()||1;this.qty=Math.max(1,t),this.refresh()},a.onClickConfirm=function(){var t;null==(t=this.onConfirm)||t.call(this,this.qty),this.hide()},a.onClickCancel=function(){this.hide()},a.onClickClose=function(){this.hide()},a.onClickBackdrop=function(){this.hide()},a.hide=function(){var t,e=this,n=null!=(t=this.panel.getComponent(b))?t:this.panel.addComponent(b);m(n).to(.1,{opacity:0}).start(),m(this.panel).to(.1,{scale:y(.96,.96,1)}).call((function(){e.node.active=!1})).start()},e}(v)).prototype,"panel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(I.prototype,"icon",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(I.prototype,"nameLabel",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(I.prototype,"ownedLabel",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(I.prototype,"qtyLabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(I.prototype,"haveLabel",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(I.prototype,"needLabel",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(I.prototype,"minBtn",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(I.prototype,"minusBtn",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(I.prototype,"plusBtn",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=e(I.prototype,"maxBtn",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(I.prototype,"confirmBtn",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=e(I.prototype,"cancelBtn",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=e(I.prototype,"closeBtn",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=I))||D));a._RF.pop()}}}));

System.register("chunks:///_virtual/QuizData.ts",["cc"],(function(n){var e;return{setters:[function(n){e=n.cclegacy}],execute:function(){e._RF.push({},"95eccu4GlZFCYdCTI3L8OmB","QuizData",void 0);n("quizQuestions",[{question:"‰ª•‰∏ãÂú®Âú∞ÁêÉ‰∏äÂ≠òÂú®ÊôÇÈñìÊúÄ‰πÖÁöÑÊòØ?",options:["È±òÈæçÈ≠ö","È¥®Âò¥Áç∏","Ê∞¥Êùâ"],answerIndex:0},{question:"È±òÈæçÈ≠öÈ†àË¶ÅÈ§äÂ§ö‰πÖÁÆóÊòØÊàêÈ≠ö?",options:["800Â§©‰ª•‰∏ä","100‰ª•‰∏ä","‰∏ÄÂπ¥‰ª•‰∏ä"],answerIndex:0},{question:"È±òÈæçÈ≠öÁöÑ Omega-3 ËÑÇËÇ™ÈÖ∏Âê´ÈáèÂ§ßÁ¥ÑÊòØÂÖ∂‰ªñÂ∏∏Ë¶ãÊ∑°Ê∞¥È≠öÈ°ûÁöÑÂπæÂÄç?",options:["4-5ÂÄç","Â∑Æ‰∏çÂ§ö","8ÂÄç‰ª•‰∏ä"],answerIndex:0},{question:"ÊúÄÂ§ßÁöÑÈ±òÈæçÈ≠öÈ´îÈï∑ÂèØÈÅî?",options:["‰∏ÉÂÖ¨Â∞∫","‰∏âÂÖ¨Â∞∫","‰∫îÂÖ¨Â∞∫"],answerIndex:0},{question:"È±òÈæçÈ≠öÁöÑ‰∏≠È™®ËÑäÈ´ì‰∏≠ÔºåÂ§©ÁÑ∂ÂØåÂê´‰∏ãÂàóÂì™‰∏ÄÁ®ÆÁáüÈ§äÁ¥†?",options:["ËÜ†ÂéüËõãÁôΩ","Èà£Ë≥™","Á∂≠ÁîüÁ¥†C"],answerIndex:0},{question:"ÁõÆÂâçÂ∑≤Áü•‰∏ñÁïå‰∏äÊúâÂπæÁ®ÆÈ±òÈæçÈ≠ö?",options:["28Á®Æ","10Á®Æ","18Á®Æ"],answerIndex:0},{question:"ÁõÆÂâçÊ≠∑Âè≤Ë®òÈåÑ‰∏≠ÔºåÈ±òÈæçÈ≠öÊúÄÈï∑Â£ΩÂèØÈÅîÂπæÊ≠≤Ôºü",options:["Ë∂ÖÈÅé100Ê≠≤","40Ê≠≤","70Ê≠≤"],answerIndex:0},{question:"ÁõÆÂâçÊ≠∑Âè≤Á¥ÄÈåÑ‰∏≠ÔºåÊúÄÈáçÁöÑÈ±òÈæçÈ≠öÈ´îÈáçÂèØÈÅî?",options:["1500ÂÖ¨Êñ§","500ÂÖ¨Êñ§","1000ÂÖ¨Êñ§"],answerIndex:0},{question:"È±òÈæçÈ≠öÁöÑÈºªÂ≠î‰∏ªË¶ÅÁî®‰æÜ?",options:["ÊÑüÁü•ÂóÖË¶∫Ë®äËôü","ÂëºÂê∏","ÊéíÊ∞¥"],answerIndex:0},{question:"‰∏ãÂàóÂì™ÂÄãÂúãÂÆ∂ÊòØË•ø‰ºØÂà©‰∫ûÈ±òÊúÄÂ§ßÁöÑ‰∫∫Â∑•È§äÊÆñËº∏Âá∫Âúã?",options:["‰∏≠Âúã","‰øÑÁæÖÊñØ","‰ºäÊúó"],answerIndex:0},{question:"‰∏ãÂàóÂì™Á®ÆÁÉπË™øÊñπÂºèÂèØ‰øùÁïôÊúÄÂ§ö Omega-3?",options:["Ê∏ÖËí∏","È´òÊ∫´Ê≤πÁÇ∏","‰ΩéÊ∫´ÁÉòÁÉ§"],answerIndex:0},{question:"Âì™‰∏ÄÁ®ÆÈ±òÈæçÈ≠öÁöÑÈ≠öÂ≠êÈÜ¨Ë¢´Ë≠ΩÁÇ∫ÂÖ®ÁêÉÊúÄÊòÇË≤¥?",options:["ÁôΩÈ±òÔºàBelugaÔºâ","Ë•ø‰ºØÂà©‰∫ûÈ±ò","‰∏≠ËèØÈ±ò"],answerIndex:0},{question:"Ë•ø‰ºØÂà©‰∫ûÈ±ò‰∏ªË¶ÅÊ£≤ÊÅØÂú®Âì™È°ûÂûãÊ∞¥Âüü?",options:["Ê∑°Ê∞¥Ê≤≥ÊµÅ","È´òÈπΩÂ∫¶Êµ∑Ê¥ã","Ê∑°Èππ‰∫§ÁïåÁöÑÁ¥ÖÊ®πÊûó"],answerIndex:0},{question:"Â§ßÂ§öÊï∏È±òÈæçÈ≠öÂ±¨Êñº‰ªÄÈ∫ºÁîüÊ¥ªÂûãÊÖã?",options:["Ê∫ØÊ≤≥Ê¥ÑÊ∏∏È≠ö","ÂÆöÂ±ÖÈ≠ö","ÊΩÆÈñìÂ∏∂Áü≠Êö´È≠ö"],answerIndex:0},{question:"‰∏ãÂàóÂì™ÂÄãÂõ†Á¥†Â∞çÈ±òÈæçÈ≠öÊóèÁæ§Êï∏ÈáèÂΩ±ÈüøÊúÄÂ§ß?",options:["Ê∞¥Â£©ÈòªÊñ∑Ê¥ÑÊ∏∏ÈÄöÈÅì","Ê∞£Ê∫´ÂçáÈ´ò3Â∫¶","ÊçïÈ£üËÄÖËÆäÂ§ö"],answerIndex:0},{question:"È±òÈæçÈ≠öÂñúÊ≠°‰ªÄÈ∫ºÊ®£ÁöÑÂ∫ïÂ±§Áí∞Â¢É?",options:["Ê≤ôË≥™ÊàñÊ≥•Ë≥™Ê≤≥Â∫ä","ÁèäÁëöÁ§ÅÁæ§ËêΩ","ÈæçËàåËò≠Ê∞¥ËçâÁπÅËåÇÂçÄ"],answerIndex:0},{question:"Âú®‰∫∫Â∑•È§äÊÆñÊ¢ù‰ª∂‰∏ãÔºåË•ø‰ºØÂà©‰∫ûÈ±òÊúÄÈÅ©Ê∞¥Ê∫´ÁØÑÂúçÁÇ∫?",options:["15ÔΩû20¬∞C ","5ÔΩû10¬∞C","25ÔΩû30¬∞C"],answerIndex:0},{question:"È±òÈæçÈ≠öÂú®ÈáéÂ§ñÂ§öÂú®Âì™‰∫õÊ¥≤Âá∫Áèæ?",options:["Ê≠ê‰∫ûËàáÂåóÁæé","‰∫ûÊ¥≤ËàáÈùûÊ¥≤","ÂçóÁæéËàáÊæ≥Ê¥≤"],answerIndex:0}]);e._RF.pop()}}}));

System.register("chunks:///_virtual/QuizPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./utils.ts"],(function(e){var n,t,o,r,i,c,a,s,l,u,p,f,d,h,v,b;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){i=e.cclegacy,c=e._decorator,a=e.Label,s=e.Button,l=e.SpriteFrame,u=e.Sprite,p=e.Color,f=e.tween,d=e.Vec3,h=e.Node,v=e.Component},function(e){b=e.shuffleArray}],execute:function(){var w,m,g,y,E,C,S,I,z,F,A;i._RF.push({},"7c2cdvU+QlDcIa5MfAPFQc5","QuizPanel",void 0);var B=c.ccclass,L=c.property;e("QuizPanel",(w=B("QuizPanel"),m=L(a),g=L([s]),y=L(l),E=L(l),w((I=n((S=function(e){function n(){for(var n,t=arguments.length,i=new Array(t),c=0;c<t;c++)i[c]=arguments[c];return n=e.call.apply(e,[this].concat(i))||this,o(n,"questionLabel",I,r(n)),o(n,"optionButtons",z,r(n)),o(n,"correctIconSpriteFrame",F,r(n)),o(n,"wrongIconSpriteFrame",A,r(n)),n.resolveAnswer=void 0,n.correctIndex=0,n.isCorrect=!1,n}t(n,e);var i=n.prototype;return i.setup=function(e){var n=this;this.questionLabel.string=e.question;var t=b([].concat(e.options.slice(0,3)));this.correctIndex=t.indexOf(e.options[e.answerIndex]);for(var o=["A. ","B. ","C. "],r=function(e){var r=n.optionButtons[e],i=r.getComponentInChildren(a);e<3?(r.node.active=!0,i.string=o[e]+t[e],r.interactable=!0,r.node.off(h.EventType.MOUSE_ENTER),r.node.off(h.EventType.MOUSE_LEAVE),r.node.off("click"),r.node.on(h.EventType.MOUSE_ENTER,(function(){r.interactable&&(r.node.getComponent(u).color=new p(213,239,255))})),r.node.on(h.EventType.MOUSE_LEAVE,(function(){r.interactable&&(r.node.getComponent(u).color=new p(226,244,255))})),r.node.once("click",(function(){return n.onSelect(e)}))):r.node.active=!1},i=0;i<this.optionButtons.length;i++)r(i);return new Promise((function(e){n.resolveAnswer=e}))},i.onSelect=function(e){var n=this;this.isCorrect=e===this.correctIndex;var t=this.optionButtons[e];if(t.node.getComponent(u).color=this.isCorrect?new p(102,204,154):new p(255,50,51),this.isCorrect)f(t.node).to(.1,{scale:new d(1.05,1.05,1)}).to(.1,{scale:new d(1,1,1)}).start();else{for(var o=t.node.position.clone(),r=f(t.node),i=0;i<3;i++)r=r.to(.05,{position:new d(o.x+(i%2==0?10:-10),o.y,o.z)}).to(.05,{position:o});r.start()}var c=t.getComponentsInChildren(u).find((function(e){return e.node!==t.node}));c&&(c.spriteFrame=this.isCorrect?this.correctIconSpriteFrame:this.wrongIconSpriteFrame,c.node.active=!0),this.optionButtons.forEach((function(e){return e.interactable=!1})),this.scheduleOnce((function(){n.resolveAnswer(n.isCorrect),n.node.destroy()}),1.5)},n}(v)).prototype,"questionLabel",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=n(S.prototype,"optionButtons",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=n(S.prototype,"correctIconSpriteFrame",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=n(S.prototype,"wrongIconSpriteFrame",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=S))||C));i._RF.pop()}}}));

System.register("chunks:///_virtual/RenamePanel.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t,i,r,a,o,l,s,c;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,l=e.Node,s=e.EditBox,c=e.Component}],execute:function(){var u,p,f,h,m,d,g;a._RF.push({},"a1028v47H5K07nzlDR15RQK","RenamePanel",void 0);var y=o.ccclass,v=o.property;e("RenamePanel",(u=y("RenamePanel"),p=v(l),f=v(s),u((d=n((m=function(e){function n(){for(var n,t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return n=e.call.apply(e,[this].concat(a))||this,i(n,"panel",d,r(n)),i(n,"input",g,r(n)),n.fishId=-1,n}t(n,e);var a=n.prototype;return a.show=function(e){e&&(this.fishId=e.id,this.input.string=e.name,this.panel.active=!0)},a.hide=function(){this.panel.active=!1},a.renameFish=function(e,n){return!(!n||n.length>12)&&(e.name=n,!0)},a.confirmRename=function(){var e=this,n=this.input.string.trim();if(n){var t=JSON.parse(localStorage.getItem("playerData")),i=t.fishList.find((function(n){return n.id===e.fishId}));if(i)this.renameFish(i,n)?(localStorage.setItem("playerData",JSON.stringify(t)),this.hide()):console.warn("ÂêçÂ≠óÁÑ°Êïà")}else console.warn("ÂêçÂ≠ó‰∏çËÉΩÁÇ∫Á©∫ÔºÅ")},n}(c)).prototype,"panel",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=n(m.prototype,"input",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=m))||h));a._RF.pop()}}}));

System.register("chunks:///_virtual/RewardItem.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,r,i,n,a,l,o,c,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,i=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){a=e.cclegacy,l=e._decorator,o=e.Sprite,c=e.Label,u=e.Component}],execute:function(){var p,s,b,m,f,y,d,g,h;a._RF.push({},"5933cdguJ5I4LXe+Iv+wspf","RewardItem",void 0);var L=l.ccclass,w=l.property;e("RewardItem",(p=L("RewardItem"),s=w(o),b=w(c),m=w(c),p((d=t((y=function(e){function t(){for(var t,r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return t=e.call.apply(e,[this].concat(a))||this,i(t,"itemSprite",d,n(t)),i(t,"nameLabel",g,n(t)),i(t,"countLabel",h,n(t)),t}return r(t,e),t.prototype.init=function(e,t,r){this.itemSprite.spriteFrame=e,this.nameLabel.string=t,this.countLabel.string="x"+r},t}(u)).prototype,"itemSprite",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=t(y.prototype,"nameLabel",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=t(y.prototype,"countLabel",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=y))||f));a._RF.pop()}}}));

System.register("chunks:///_virtual/RewardPopup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RewardItem.ts"],(function(e){var t,r,i,a,n,o,c,l,f,u,s,p,d,h,g;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,i=e.createForOfIteratorHelperLoose,a=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){o=e.cclegacy,c=e._decorator,l=e.Node,f=e.Prefab,u=e.instantiate,s=e.Vec3,p=e.UIOpacity,d=e.tween,h=e.Component},function(e){g=e.RewardItem}],execute:function(){var b,w,y,m,C,R,L,v,P,I,W,z,E;o._RF.push({},"bfdf9YEfL9KSqEJa2k66Zxa","RewardPopup",void 0);var F=c.ccclass,A=c.property;e("RewardPopup",(b=F("RewardPopup"),w=A(l),y=A(f),m=A(l),C=A(l),R=A(l),b((P=t((v=function(e){function t(){for(var t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i))||this,a(t,"rewardGrid",P,n(t)),a(t,"rewardItemPrefab",I,n(t)),a(t,"effectLightBase",W,n(t)),a(t,"effectLightRotateCW",z,n(t)),a(t,"effectLightRotateCCW",E,n(t)),t}r(t,e);var o=t.prototype;return o.showRewards=function(e){this.rewardGrid.removeAllChildren();for(var t,r=i(e);!(t=r()).done;){var a=t.value,n=u(this.rewardItemPrefab);n.getComponent(g).init(a.icon,a.name,a.count),this.rewardGrid.addChild(n)}this.playEnterAnimation(),this.playEffectLight()},o.playEnterAnimation=function(){this.node.scale=new s(.5,.5,1);var e=this.node.getComponent(p);e&&(e.opacity=0,d(e).to(.6,{opacity:255},{easing:"quadOut"}).start()),d(this.node).to(.6,{scale:new s(1,1,1)},{easing:"backOut"}).start()},o.playEffectLight=function(){this.effectLightRotateCW&&d(this.effectLightRotateCW).by(5,{angle:360}).repeatForever().start(),this.effectLightRotateCCW&&d(this.effectLightRotateCCW).by(5,{angle:-360}).repeatForever().start()},o.onConfirm=function(){this.node.destroy()},t}(h)).prototype,"rewardGrid",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(v.prototype,"rewardItemPrefab",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(v.prototype,"effectLightBase",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(v.prototype,"effectLightRotateCW",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(v.prototype,"effectLightRotateCCW",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=v))||L));o._RF.pop()}}}));

System.register("chunks:///_virtual/SignInPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts"],(function(e){var n,t,o,i,a,r,l,s,c,u,h,p,y,f;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized,a=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){l=e.cclegacy,s=e._decorator,c=e.Node,u=e.Button,h=e.Sprite,p=e.Color,y=e.Component},function(e){f=e.DataManager}],execute:function(){var w,v,d,g,b,m,k,P,T,S,I,B,D;l._RF.push({},"41118NYzBlDtoozrSfsrMdm","SignInPanel",void 0);var C=s.ccclass,z=s.property;e("SignInPanel",(w=C("SignInPanel"),v=z(c),d=z(c),g=z(u),b=z(u),m=z(u),w((T=n((P=function(e){function n(){for(var n,t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=e.call.apply(e,[this].concat(a))||this,o(n,"weeklyPanel",T,i(n)),o(n,"monthlyPanel",S,i(n)),o(n,"weeklyTabBtn",I,i(n)),o(n,"monthlyTabBtn",B,i(n)),o(n,"closeBtn",D,i(n)),n}t(n,e);var l=n.prototype;return l.start=function(){var e=a(r().mark((function e(){var n,t,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(n=this.weeklyTabBtn)||n.node.on(u.EventType.CLICK,this.showWeekly,this),null==(t=this.monthlyTabBtn)||t.node.on(u.EventType.CLICK,this.showMonthly,this),null==(o=this.closeBtn)||o.node.on(u.EventType.CLICK,this.closePanel,this),this.showWeekly(),e.next=6,this.checkIfShouldShow();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.checkIfShouldShow=function(){var e=a(r().mark((function e(){var n,t,o,i,a,l,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(n=f.ready)?void 0:n.catch((function(){}));case 2:return e.next=4,f.getPlayerDataCached();case 4:if((i=e.sent)&&i.signInData){e.next=9;break}return console.warn("[Á∞ΩÂà∞Èù¢Êùø] Â∞öÊú™ÂèñÂæóÁé©ÂÆ∂Ë≥áÊñôÔºåÂÖàÈö±ËóèÈù¢Êùø"),this.node.active=!1,e.abrupt("return");case 9:a=(new Date).toISOString().split("T")[0],l=(null==(t=i.signInData.weekly)?void 0:t.lastSignDate)===a,s=(null==(o=i.signInData.monthly)?void 0:o.lastSignDate)===a,l?s?(this.node.active=!1,console.log("[Á∞ΩÂà∞Èù¢Êùø] ÈÄ±ËàáÊúàÁöÜÂ∑≤Á∞ΩÂà∞ -> ÈóúÈñâÈù¢Êùø")):(this.node.active=!0,this.showMonthly(),console.log("[Á∞ΩÂà∞Èù¢Êùø] ‰ªäÊó•ÈÄ±Â∑≤Á∞ΩÂà∞‰ΩÜÊúàÊú™Á∞ΩÂà∞ -> Ëá™ÂãïÂàáÂà∞ÊúàÁ∞ΩÂà∞")):(this.node.active=!0,this.showWeekly(),console.log("[Á∞ΩÂà∞Èù¢Êùø] ‰ªäÊó•ÈÄ±Â∞öÊú™Á∞ΩÂà∞ -> È°ØÁ§∫ÈÄ±Á∞ΩÂà∞"));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.showWeekly=function(){this.weeklyPanel.active=!0,this.monthlyPanel.active=!1,this.updateTabVisual()},l.showMonthly=function(){this.weeklyPanel.active=!1,this.monthlyPanel.active=!0,this.updateTabVisual()},l.updateTabVisual=function(){var e=this.weeklyTabBtn.node.getComponent(h),n=this.monthlyTabBtn.node.getComponent(h);e&&n&&(e.color=this.weeklyPanel.active?new p(255,255,255):new p(180,180,180),n.color=this.monthlyPanel.active?new p(255,255,255):new p(180,180,180))},l.closePanel=function(){this.node.active=!1},l.openPanel=function(){this.node.active=!0,this.showWeekly(),console.log("[Á∞ΩÂà∞Èù¢Êùø] ÊâãÂãïÈñãÂïü")},l.onWeeklySignInDone=function(){var e=a(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.showMonthly(),console.log("[Á∞ΩÂà∞Èù¢Êùø] ÈÄ±Á∞ΩÂà∞ÂÆåÊàê -> Ëá™ÂãïÂàáÊèõÂà∞ÊúàÁ∞ΩÂà∞")}catch(e){console.warn("[Á∞ΩÂà∞Èù¢Êùø] ÈÄ±Á∞ΩÂà∞ÂÆåÊàêÂæåÂàáÊèõÊúàÁ∞ΩÂà∞Â§±ÊïóÔºö",e)}case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n}(y)).prototype,"weeklyPanel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=n(P.prototype,"monthlyPanel",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=n(P.prototype,"weeklyTabBtn",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=n(P.prototype,"monthlyTabBtn",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=n(P.prototype,"closeBtn",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=P))||k));l._RF.pop()}}}));

System.register("chunks:///_virtual/StoreState.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts"],(function(e){var t,n,r,a,i;return{setters:[function(e){t=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){r=e.cclegacy,a=e.EventTarget},function(e){i=e.DataManager}],execute:function(){r._RF.push({},"3f6d8uH5ehPQLCO+fr44WzD","StoreState",void 0);e("StoreState",function(){function e(){var e=this;this.events=new a,this.wallet={DRAGONBONE:1200},this.owned=new Set,this.inventory=new Map,this.currentCategory="ÂÖ®ÈÉ®",this.catalog=[],i.onChange((function(t){return e.hydrateFromPlayer(t)})),i.getPlayerDataCached().then((function(t){t&&e.hydrateFromPlayer(t)}))}var r=e.prototype;return r.hydrateFromPlayer=function(e){var t,n,r,a,i,o,s,u,c,l,h,v,f,d,p,m,y,g,w,k,b,O,_,x;this.wallet.DRAGONBONE=null!=(t=e.dragonBones)?t:0,this.events.emit("wallet:change"),this.owned=new Set([].concat(null!=(n=null==(r=e.fashion)?void 0:r.owned)?n:[],null!=(a=e.decorationsOwned)?a:[])),this.events.emit("owned:change"),this.inventory.clear();var N=e.inventory||{feeds:{normal:0,premium:0},items:{}};this.inventory.set("feed_normal",null!=(i=null==(o=N.feeds)?void 0:o.normal)?i:0),this.inventory.set("feed_high",null!=(s=null==(u=N.feeds)?void 0:u.premium)?s:0),this.inventory.set("med_trans",null!=(c=null==(l=N.items)?void 0:l.genderPotion)?c:0),this.inventory.set("med_change",null!=(h=null==(v=N.items)?void 0:v.changePotion)?h:0),this.inventory.set("med_cold",null!=(f=null==(d=N.items)?void 0:d.coldMedicine)?f:0),this.inventory.set("med_lvup",null!=(p=null==(m=N.items)?void 0:m.upgradePotion)?p:0),this.inventory.set("med_revive",null!=(y=null==(g=N.items)?void 0:g.revivePotion)?y:0),this.inventory.set("env_brush",null!=(w=null==(k=N.items)?void 0:k.brush)?w:0),this.inventory.set("env_fan",null!=(b=null==(O=N.items)?void 0:O.fan)?b:0),this.inventory.set("heater",null!=(_=null==(x=N.items)?void 0:x.heater)?_:0),this.events.emit("inventory:change")},r.setCatalog=function(e){this.catalog=e.slice(),this.events.emit("catalog:change")},r.setCategory=function(e){this.currentCategory=e,this.events.emit("category:change")},r.canAfford=function(e){var t=e.priceSoft;return!!t&&this.wallet[t.currency]>=t.amount},r.isOwned=function(e){return this.owned.has(e)},r.getCount=function(e){var t;return null!=(t=this.inventory.get(e))?t:0},r.canAffordQty=function(e,t){var n=e.priceSoft;return!!n&&this.wallet[n.currency]>=n.amount*Math.max(1,t)},r.purchaseMany=function(){var e=t(n().mark((function e(t,r){var a,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Math.max(1,Math.floor(r)),"CONSUMABLE"===t.type){e.next=3;break}return e.abrupt("return",this.purchase(t));case 3:if(a=t.priceSoft){e.next=6;break}return e.abrupt("return",{ok:!1,reason:"NO_PRICE"});case 6:return e.next=8,i.purchase(t.sku,r,a.amount);case 8:if(!("error"in(o=e.sent))){e.next=11;break}return e.abrupt("return",{ok:!1,reason:o.error||"FAILED"});case 11:return e.abrupt("return",{ok:!0});case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),r.purchase=function(){var e=t(n().mark((function e(t){var r,a,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.priceSoft){e.next=3;break}return e.abrupt("return",{ok:!1,reason:"NO_PRICE"});case 3:if("NON_CONSUMABLE"!==t.type||!this.isOwned(t.sku)){e.next=5;break}return e.abrupt("return",{ok:!1,reason:"ALREADY_OWNED"});case 5:return e.next=7,i.purchase(t.sku,1,r.amount);case 7:if(!("error"in(a=e.sent))){e.next=11;break}return o="NOT_ENOUGH"===a.error?"NOT_ENOUGH":"FAILED",e.abrupt("return",{ok:!1,reason:o});case 11:return e.abrupt("return",{ok:!0});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.resetDemo=function(){var e=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.getPlayerDataCached({refresh:!0});case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:return t.dragonBones=1200,e.next=8,i.savePlayerDataWithCache(t);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}());r._RF.pop()}}}));

System.register("chunks:///_virtual/StoreUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./StoreState.ts","./mockCatalog.ts","./ItemCard.ts","./CategoryTab.ts","./PurchaseModal.ts","./Toast.ts"],(function(t){var e,n,r,a,o,i,s,l,u,c,f,p,h,g,y,b,m,d,C,v,T,w,S,I,O,B;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,r=t.createForOfIteratorHelperLoose,a=t.asyncToGenerator,o=t.regeneratorRuntime,i=t.initializerDefineProperty,s=t.assertThisInitialized},function(t){l=t.cclegacy,u=t._decorator,c=t.Node,f=t.Label,p=t.Prefab,h=t.ScrollView,g=t.Sprite,y=t.Color,b=t.instantiate,m=t.UIOpacity,d=t.tween,C=t.Component},function(t){v=t.StoreState},function(t){T=t.MOCK_CATALOG,w=t.CATEGORIES},function(t){S=t.ItemCard},function(t){I=t.CategoryTab},function(t){O=t.PurchaseModal},function(t){B=t.Toast}],execute:function(){var E,P,A,L,z,N,U,x,D,_,M,k,R,V,H,W,G,F,j,J,K;l._RF.push({},"16182Tt8BtOJJPVO5+AIjrx","StoreUI",void 0);var Y=u.ccclass,q=u.property;t("StoreUI",(E=Y("StoreUI"),P=q([c]),A=q(f),L=q(c),z=q(p),N=q(h),U=q(c),x=q(p),D=q(O),_=q(B),E((R=e((k=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,i(e,"categoryButtons",R,s(e)),i(e,"boneLabel",V,s(e)),i(e,"categoryTabs",H,s(e)),i(e,"categoryTabPrefab",W,s(e)),i(e,"itemScroll",G,s(e)),i(e,"itemContent",F,s(e)),i(e,"itemCardPrefab",j,s(e)),i(e,"modal",J,s(e)),i(e,"toast",K,s(e)),e.state=new v,e.renderWallet=function(){var t=e.state.wallet.DRAGONBONE;e.boneLabel.string=t.toString()},e.renderItems=function(){var t;e.itemContent.removeAllChildren(),e.filteredCatalog().forEach((function(t){var n=b(e.itemCardPrefab);n.setParent(e.itemContent),n.getComponent(S).init(t,{priceText:e.priceText(t),owned:"CONSUMABLE"!==t.type&&e.state.isOwned(t.sku),canBuy:e.state.canAfford(t),onBuy:function(t){return e.openPurchase(t)}})}));var n=null!=(t=e.itemContent.getComponent(m))?t:e.itemContent.addComponent(m);n.opacity=0,d(n).to(.15,{opacity:255}).start()},e}n(e,t);var l=e.prototype;return l.onLoad=function(){var t=this;this.state.setCatalog(T),this.modal&&this.modal.node&&(this.modal.node.active=!1),this.state.events.on("wallet:change",this.renderWallet,this),this.state.events.on("owned:change",this.renderItems,this),this.state.events.on("inventory:change",this.renderItems,this),this.state.events.on("category:change",(function(){t.updateCategoryVisuals(),t.renderItems()}),this),this.renderWallet(),this.setupCategoryButtons(),this.updateCategoryVisuals()},l.onEnable=function(){this.updateCategoryVisuals(),this.renderItems()},l.priceText=function(t){var e,n;return(null!=(e=null==(n=t.priceSoft)?void 0:n.amount)?e:0).toLocaleString("zh-TW")+" "},l.setupCategoryButtons=function(){for(var t=this,e=function(){var e,r=t.categoryButtons[n],a=null!=(e=w[n])?e:"ÂàÜÈ°û"+(n+1),o=r.getComponent(f);o&&(o.string=a),r.off(c.EventType.TOUCH_END),r.on(c.EventType.TOUCH_END,(function(){t.state.setCategory(a)}),t)},n=0;n<this.categoryButtons.length;n++)e();this.updateCategoryVisuals()},l.updateCategoryVisuals=function(){for(var t=this.state.currentCategory,e=0;e<this.categoryButtons.length;e++){var n,r=this.categoryButtons[e],a=null!=(n=w[e])?n:"",o=r.getChildByName("Frame");if(o){var i=o.getComponent(g);i&&(i.color=a===t?y.WHITE:new y(220,220,220,255))}}},l.renderCategories=function(){var t=this;this.categoryTabs.removeAllChildren();for(var e,n=r(w);!(e=n()).done;){var a=e.value,o=b(this.categoryTabPrefab);o.setParent(this.categoryTabs),o.getComponent(I).init(a,(function(e){return t.state.setCategory(e)}))}},l.filteredCatalog=function(){var t=this.state.currentCategory;return"ÂÖ®ÈÉ®"===t?this.state.catalog:this.state.catalog.filter((function(e){return e.category===t}))},l.openPurchase=function(t){var e=this;this.modal.open(this.state,t,a(o().mark((function n(r){var a,i,s,l,u;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("CONSUMABLE"!==t.type){n.next=6;break}return n.next=3,e.state.purchaseMany(t,r);case 3:n.t0=n.sent,n.next=9;break;case 6:return n.next=8,e.state.purchase(t);case 8:n.t0=n.sent;case 9:(a=n.t0).ok?(s="CONSUMABLE"===t.type?" √ó"+r:"",null==(i=e.toast)||i.show("Ë≥ºË≤∑ÊàêÂäüÔºö\n"+t.name+s)):(u="NOT_ENOUGH"===a.reason?"ÈæçÈ™®‰∏çË∂≥":"ALREADY_OWNED"===a.reason?"Â∑≤ÊìÅÊúâ":"Â§±Êïó",null==(l=e.toast)||l.show("Ë≥ºË≤∑Â§±ÊïóÔºö"+u));case 11:case"end":return n.stop()}}),n)}))))},l.onDevReset=function(){this.state.resetDemo(),this.renderItems()},e}(C)).prototype,"categoryButtons",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),V=e(k.prototype,"boneLabel",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(k.prototype,"categoryTabs",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(k.prototype,"categoryTabPrefab",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(k.prototype,"itemScroll",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(k.prototype,"itemContent",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(k.prototype,"itemCardPrefab",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(k.prototype,"modal",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(k.prototype,"toast",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=k))||M));l._RF.pop()}}}));

System.register("chunks:///_virtual/SwimmingFish.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FishDetailManager.ts","./DataManager.ts","./FashionManager.ts"],(function(t){var e,i,n,r,o,a,s,h,l,u,c,d,m,f,p,v,g,b;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized,o=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){s=t.cclegacy,h=t._decorator,l=t.Node,u=t.UITransform,c=t.Vec3,d=t.Sprite,m=t.Component,f=t.tween,p=t.find},function(t){v=t.FishDetailManager},function(t){g=t.DataManager},function(t){b=t.FashionManager}],execute:function(){var S,F,y,w,B,C,E,N,D;s._RF.push({},"ff87csflAtIoZduCCeP/Ybx","SwimmingFish",void 0);var M=h.ccclass,x=h.property;t("SwimmingFish",(S=M("SwimmingFish"),F=x(l),y=x(l),S(((D=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,n(e,"hatAnchor",C,r(e)),n(e,"glassAnchor",E,r(e)),e.hatNode=null,e.fishData=null,n(e,"interactive",N,r(e)),e._envForEmotion=null,e.isMovingRight=!1,e.speed=80,e.fishAreaWorldLeft=0,e.fishAreaWorldRight=0,e.emotionBubble=null,e.emotionSprite=null,e._lastEmotion=null,e._lastEmotionSprite=null,e}i(e,t),e.setEmotionFrames=function(t){this._emotionFrames=t||{}},e.getEmotionSpriteByKey=function(t){var e,i;return null!=(e=null!=(i=this._emotionFrames[t])?i:this._emotionFrames.happy)?e:null};var s=e.prototype;return s.start=function(){var t,e,i,n=this.node.parent,r=null==n?void 0:n.getComponent(u);if(r){var o=n.getWorldPosition(),a=r.width/2;this.fishAreaWorldLeft=o.x-a+50,this.fishAreaWorldRight=o.x+a-50;var s=this.node.initialDirection;this.isMovingRight=1===s,this.node.setScale(this.isMovingRight?new c(-1,1,1):new c(1,1,1)),this.emotionBubble=this.node.getChildByName("EmotionBubble")||null;var h=(null==(t=this.emotionBubble)?void 0:t.getChildByName("EmotionIcon"))||null;this.emotionSprite=(null==h||null==(e=h.getChildByName("Sprite"))?void 0:e.getComponent(d))||null,this.emotionSprite||console.warn("[SwimmingFish] Êâæ‰∏çÂà∞ EmotionBubble/EmotionIcon/Sprite(Sprite)");var m=(null==(i=this.emotionBubble)?void 0:i.getChildByName("MagnifierBtn"))||null;null==m||m.on(l.EventType.TOUCH_END,this.onClickMagnifier,this),this.node.on(l.EventType.TOUCH_END,this.onClickFish,this)}else console.warn("[SwimmingFish] FishArea Áº∫Â∞ë UITransformÔºåÁÑ°Ê≥ïË®àÁÆóÁßªÂãïÁØÑÂúç")},s.update=function(t){var i,n;if(this!==e.currentSelectedFish&&null!=(i=this.emotionBubble)&&i.active&&(this.emotionBubble.active=!1),null==(n=this.emotionBubble)||!n.active){var r=this.speed*t*(this.isMovingRight?1:-1),o=this.node.position.x+r;this.node.setPosition(o,this.node.position.y,0);var a=this.node.getWorldPosition().x;a>this.fishAreaWorldRight&&this.isMovingRight?(this.isMovingRight=!1,this.node.setScale(new c(1,1,1))):a<this.fishAreaWorldLeft&&!this.isMovingRight&&(this.isMovingRight=!0,this.node.setScale(new c(-1,1,1)))}},s.setFishData=function(t,e){this.fishData=t,e&&"readOnly"in e&&(this.interactive=!e.readOnly),null!=e&&e.env&&(this._envForEmotion=e.env),this.refreshOutfit()},s.onClickFish=function(){var t=o(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.emotionBubble){t.next=2;break}return t.abrupt("return");case 2:if(e.currentSelectedFish!==this){t.next=6;break}return this.emotionBubble.active=!1,e.currentSelectedFish=null,t.abrupt("return");case 6:return e.currentSelectedFish&&(e.currentSelectedFish.emotionBubble.active=!1),e.currentSelectedFish=this,this.emotionBubble.active=!0,this.emotionBubble.setScale(new c(.3,.3,1)),t.next=12,this.updateBubbleEmotionIcon();case 12:f(this.emotionBubble).to(.25,{scale:new c(1,1,1)},{easing:"backOut"}).start();case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.clearSelection=function(){if(e.currentSelectedFish){var t=e.currentSelectedFish.emotionBubble;t&&t.isValid&&(t.active=!1),e.currentSelectedFish=null}},s.onClickMagnifier=function(){var t=o(a().mark((function t(){var e,i,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.fishData){t.next=2;break}return t.abrupt("return");case 2:if(i=null==(e=p("/GameManager"))?void 0:e.getComponent(v)){t.next=5;break}return t.abrupt("return");case 5:if(this._lastEmotionSprite){t.next=8;break}return t.next=8,this.updateBubbleEmotionIcon();case 8:n=!this.interactive,i.showFishDetail(this.fishData,this._lastEmotionSprite||null,{readOnly:n});case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),s.updateBubbleEmotionIcon=function(){var t=o(a().mark((function t(){var i,n,r,o,s,h=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.emotionSprite&&this.fishData){t.next=2;break}return t.abrupt("return");case 2:if(i=this._envForEmotion||null,n=e.computeEmotion(this.fishData,i),t.prev=4,!this.interactive){t.next=14;break}return t.next=8,g.getPlayerDataCached();case 8:if(r=t.sent,!(o=null==r?void 0:r.fishList.find((function(t){return t.id===h.fishData.id})))){t.next=14;break}return o.emotion=n,t.next=14,g.savePlayerDataWithCache(r);case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(4),console.warn("[SwimmingFish] save emotion failed",t.t0);case 19:(s=e.getEmotionSpriteByKey(n))&&(this.emotionSprite.spriteFrame=s,this._lastEmotion=n,this._lastEmotionSprite=s);case 21:case"end":return t.stop()}}),t,this,[[4,16]])})));return function(){return t.apply(this,arguments)}}(),e.computeEmotion=function(t,e){var i,n;if(null!=(i=t.status)&&i.sick)return"sick";if((null==e?void 0:e.temperature)<18)return"cold";if((null==e?void 0:e.temperature)>23)return"hot";var r=null!=(n=t.hunger)?n:0;if(r>=80)return"hungry";if(r<=20)return"happy";var o=["happy","sad","angry"];return o[Math.floor(Math.random()*o.length)]},s.refreshOutfit=function(){var t,e,i;if(this.fishData){var n=(null!=(t=this.fishData.stage)?t:1)>=6&&null!=(e=null==(i=this.fishData.outfit)?void 0:i.head)?e:null;if(n){var r=n.startsWith("acc_sunglass")||n.startsWith("acc_heart_glass"),o=r?this.glassAnchor:this.hatAnchor;if(o){this.hatNode&&this.hatNode.isValid?this.hatNode.parent!==o&&(this.hatNode.removeFromParent(),o.addChild(this.hatNode)):(this.hatNode=new l("FashionSprite"),this.hatNode.addComponent(d),o.addChild(this.hatNode));var a=b.get(n),s=this.hatNode.getComponent(d);if(a){s.spriteFrame=a;var h=o.getComponent(u);if(h){var m=this.hatNode.getComponent(u);m||(m=this.hatNode.addComponent(u)),m.setContentSize(h.contentSize),s.sizeMode=d.SizeMode.CUSTOM}this.hatNode.active=!0,this.hatNode.setPosition(c.ZERO),this.hatNode.setScale(1,1,1)}else this.hatNode.active=!1}else console.warn("[SwimmingFish] Áº∫Â∞ëÂ∞çÊáâÁöÑ Anchor",{itemId:n,isGlass:r})}else this.hatNode&&(this.hatNode.active=!1)}},e}(m)).currentSelectedFish=null,D._emotionFrames={},C=e((B=D).prototype,"hatAnchor",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(B.prototype,"glassAnchor",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=e(B.prototype,"interactive",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),w=B))||w));s._RF.pop()}}}));

System.register("chunks:///_virtual/TankEnvironmentManager.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"fc7c8V4VSlJdJjnDRnHVYya","TankEnvironmentManager",void 0);e("TankEnvironmentManager",function(){function e(){}return e.adjustTemperature=function(e){var t=e.tankEnvironment;t.temperature=21,t.isTemperatureDanger=!1,t.lastTempUpdateTime=(new Date).toISOString(),console.log("Ê∞¥Ê∫´Â∑≤Ë™øÊï¥ÁÇ∫ 21¬∞CÔºàÊ≠£Â∏∏ÁØÑÂúçÔºâ")},e.cleanWater=function(e){var t=e.tankEnvironment;t.waterQualityStatus="clean",t.lastCleanTime=(new Date).toISOString(),t.loginDaysSinceClean=0,console.log("È≠öÁº∏Â∑≤Ê∏ÖÁêÜÔºåÁãÄÊÖãËÆäÁÇ∫‰πæÊ∑®")},e.shouldUpdateTemperature=function(e){var t=e.tankEnvironment,n=new Date(t.lastTempUpdateTime||new Date);return((new Date).getTime()-n.getTime())/36e5>=12},e.updateTemperature=function(e){var t=e.tankEnvironment,n=4*Math.random()-2;t.temperature=Math.round(10*(t.temperature+n))/10,t.lastTempUpdateTime=(new Date).toISOString(),t.isTemperatureDanger=t.temperature<18||t.temperature>23,console.log("Ê∞¥Ê∫´Êõ¥Êñ∞ÁÇ∫ "+t.temperature+"¬∞CÔºåÊòØÂê¶Áï∞Â∏∏Ôºö"+t.isTemperatureDanger)},e.checkWaterDirty=function(e){var t,n=e.tankEnvironment;(null!=(t=n.loginDaysSinceClean)?t:0)>=2&&(n.waterQualityStatus="dirty",console.log("È≠öÁº∏Â∑≤ËÆäÈ´íÔºÅÔºà‰ª•ÁôªÂÖ•Êó•Á¥ØÁ©çÈÅî 2 Â§©Ôºâ"))},e.isEnvBad=function(e){var t=e.tankEnvironment;return t.isTemperatureDanger||"dirty"===t.waterQualityStatus},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/Toast.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,n,e,i,a,r,s,l,c,p,u;return{setters:[function(t){o=t.applyDecoratedDescriptor,n=t.inheritsLoose,e=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){a=t.cclegacy,r=t._decorator,s=t.Label,l=t.UIOpacity,c=t.tween,p=t.v3,u=t.Component}],execute:function(){var d,h,y,v,f;a._RF.push({},"09162BhNslDQIyD976srByq","Toast",void 0);var b=r.ccclass,g=r.property;t("Toast",(d=b("Toast"),h=g(s),d((f=o((v=function(t){function o(){for(var o,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return o=t.call.apply(t,[this].concat(a))||this,e(o,"label",f,i(o)),o}n(o,t);var a=o.prototype;return a.onLoad=function(){var t;(null!=(t=this.getComponent(l))?t:this.addComponent(l)).opacity=0,this.node.active=!1},a.show=function(t,o){var n,e,i=this;void 0===o&&(o=1.6);var a=null!=(n=this.getComponent(l))?n:this.addComponent(l),r=null!=(e=this.label)?e:this.getComponentInChildren(s);r?(r.string=t,this.node.active=!0,this.node.setSiblingIndex(9999),a.opacity=0,this.node.setPosition(0,-20,0),c(a).to(.15,{opacity:255}).delay(o).to(.15,{opacity:0}).call((function(){return i.node.active=!1})).start(),c(this.node).to(.15,{position:p(0,0,0)}).delay(o).to(.15,{position:p(0,10,0)}).start()):console.warn("Toast: label not bound")},o}(u)).prototype,"label",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=v))||y));a._RF.pop()}}}));

System.register("chunks:///_virtual/TombManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts","./UIUtils.ts","./ConfirmDialogManager.ts"],(function(e){var t,n,r,i,a,s,o,u,l,c,f,h,d,b,p,v,g,m,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.createForOfIteratorHelperLoose,i=e.initializerDefineProperty,a=e.assertThisInitialized,s=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){u=e.cclegacy,l=e._decorator,c=e.Node,f=e.Prefab,h=e.Label,d=e.Component,b=e.instantiate,p=e.Button},function(e){v=e.DataManager},function(e){g=e.playOpenPanelAnim,m=e.showFloatingTextCenter},function(e){y=e.ConfirmDialogManager}],execute:function(){var L,D,k,w,x,C,F,T,P,z,I,B,E,N,_,H,M,O,U,R,A,W,j,G,S,V,Y,q,J,K,Q,X,Z;u._RF.push({},"ed3f6FtoxFFlLalg/eFzCms","TombManager",void 0);var $=l.ccclass,ee=l.property;e("TombManager",(L=$("TombManager"),D=ee(y),k=ee(c),w=ee(c),x=ee(f),C=ee(c),F=ee(h),T=ee(h),P=ee(h),z=ee(h),I=ee(h),B=ee(h),E=ee(c),N=ee(h),_=ee(c),H=ee(c),L((U=t((O=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t=e.call.apply(e,[this].concat(r))||this,i(t,"confirm",U,a(t)),i(t,"floatingNode",R,a(t)),i(t,"tombContainer",A,a(t)),i(t,"tombstonePrefab",W,a(t)),i(t,"deadFishDetailPanel",j,a(t)),i(t,"titleLabel",G,a(t)),i(t,"nameLabel",S,a(t)),i(t,"genderLabel",V,a(t)),i(t,"daysLabel",Y,a(t)),i(t,"stageLabel",q,a(t)),i(t,"deathDateLabel",J,a(t)),i(t,"reviveBtn",K,a(t)),i(t,"reviveCountLabel",Q,a(t)),i(t,"resetBtn",X,a(t)),i(t,"closeBtn",Z,a(t)),t.deadFishList=[],t}n(t,e);var u=t.prototype;return u.init=function(){var e=s(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getPlayerDataCached();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:this.deadFishList=t.fishList.filter((function(e){return e.isDead})),this.refreshTombs();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.refreshTombs=function(){var e=s(o().mark((function e(){var t,n,i,a,s=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getPlayerDataCached();case 2:if(t=e.sent,this.deadFishList=t.fishList.filter((function(e){return e.isDead})),this.tombContainer.removeAllChildren(),0!==this.deadFishList.length){e.next=7;break}return e.abrupt("return");case 7:n=o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a.value,(n=b(s.tombstonePrefab)).getComponentInChildren(h).string=t.name,n.on(c.EventType.TOUCH_END,(function(){return s.showDeadFishDetail(t)})),s.tombContainer.addChild(n);case 5:case"end":return e.stop()}}),e)})),i=r(this.deadFishList);case 9:if((a=i()).done){e.next=13;break}return e.delegateYield(n(),"t0",11);case 11:e.next=9;break;case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.showDeadFishDetail=function(){var e=s(o().mark((function e(t){var n,r,i,a=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(this.deadFishDetailPanel),e.next=3,v.getPlayerDataCached();case 3:r=e.sent,i=r.inventory.items.revivePotion,this.reviveCountLabel.string=""+i,this.reviveBtn.getComponent(p).interactable=i>0,this.titleLabel.string=t.name+" ÁöÑÈ≠öÁîüÂõûÊÜ∂",this.nameLabel.string="ÂêçÂ≠óÔºö"+t.name,this.genderLabel.string="ÊÄßÂà•Ôºö"+("male"===t.gender?"ÂÖ¨È≠ö":"ÊØçÈ≠ö"),this.daysLabel.string="ÊàêÈï∑Â§©Êï∏ÔºöÁâ†Âä™ÂäõÁîüÊ¥ª‰∫Ü "+t.growthDaysPassed+" Â§©",this.stageLabel.string="ÈöéÊÆµÔºöLV "+t.stage,this.deathDateLabel.string="Èõ¢ÈñãÁöÑÊó•Â≠êÔºöÂú® "+(null!=(n=t.deathDate)?n:"Êú™Áü•")+"ÔºåÁâ†ÊÇÑÊÇÑÂú∞Èõ¢Èñã‰∫ÜÈ≠öÁº∏",this.reviveBtn.off(c.EventType.TOUCH_END),this.resetBtn.off(c.EventType.TOUCH_END),this.closeBtn.off(c.EventType.TOUCH_END),i>0&&this.reviveBtn.on(c.EventType.TOUCH_END,s(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.confirm.ask("Á¢∫ÂÆöË¶ÅÂæ©Ê¥ª "+t.name+" ÂóéÔºü");case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,a.reviveFish(t);case 7:case"end":return e.stop()}}),e)})))),this.resetBtn.on(c.EventType.TOUCH_END,s(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.confirm.ask("Á¢∫ÂÆöË¶ÅËÆì "+t.name+" ÈáçÊñ∞ÈñãÂßãÂóéÔºü");case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,a.resetFish(t);case 7:case"end":return e.stop()}}),e)})))),this.closeBtn.on(c.EventType.TOUCH_END,(function(){a.deadFishDetailPanel.active=!1}));case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),u.reviveFish=function(){var e=s(o().mark((function e(t){var n,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getPlayerDataCached();case 2:if(!((n=e.sent).inventory.items.revivePotion<=0)){e.next=6;break}return console.warn("Ê≤íÊúâÂæ©Ê¥ªËó•"),e.abrupt("return");case 6:if(-1!==(r=n.fishList.findIndex((function(e){return e.id===t.id})))){e.next=9;break}return e.abrupt("return");case 9:if((i=this.ensureTankForRevive(n,n.fishList[r])).ok){e.next=13;break}return i.msg&&m(this.floatingNode,i.msg),e.abrupt("return");case 13:return n.inventory.items.revivePotion--,n.fishList[r].isDead=!1,n.fishList[r].emotion="happy",n.fishList[r].hunger=50,e.next=19,v.savePlayerDataWithCache(n);case 19:m(this.floatingNode,n.fishList[r].name+" Â∑≤Âæ©Ê¥ªÔºåÂø´Âéª "+n.fishList[r].tankId+" ËôüÈ≠öÁº∏ÁúãÁúãÁâ†ÂêßÔºÅ"),this.deadFishDetailPanel.active=!1,this.refreshTombs();case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),u.resetFish=function(){var e=s(o().mark((function e(t){var n,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getPlayerDataCached();case 2:if(n=e.sent,-1!==(r=n.fishList.findIndex((function(e){return e.id===t.id})))){e.next=6;break}return e.abrupt("return");case 6:if((i=this.ensureTankForRevive(n,n.fishList[r])).ok){e.next=10;break}return i.msg&&m(this.floatingNode,i.msg),e.abrupt("return");case 10:return n.fishList[r].isDead=!1,n.fishList[r].emotion="happy",n.fishList[r].stage=1,n.fishList[r].growthDaysPassed=0,n.fishList[r].hunger=50,e.next=17,v.savePlayerDataWithCache(n);case 17:m(this.floatingNode,n.fishList[r].name+" Â∑≤ÈáçÊñ∞ÈñãÂßãÔºåÂø´Âéª "+n.fishList[r].tankId+" ËôüÈ≠öÁº∏ÁúãÁúãÁâ†ÂêßÔºÅ"),this.deadFishDetailPanel.active=!1,this.refreshTombs();case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),u.ensureTankForRevive=function(e,t){var n=e.tankList.find((function(e){return e.id===t.tankId}));if(!n)return{ok:!1,msg:"Êâæ‰∏çÂà∞ÂéüÊú¨ÁöÑÈ≠öÁº∏"};var i=function(t){var n=e.tankList.find((function(e){return e.id===t}));return n?n.fishIds.map((function(t){return e.fishList.find((function(e){return e.id===t}))})).filter((function(e){return e&&!e.isDead})).length:0},a=function(t){var n,r=e.tankList.find((function(e){return e.id===t}));return r?null!=(n=r.capacity)?n:1===r.id?3:6:0},s=a(t.tankId);if(i(t.tankId)<s)return{ok:!0};for(var o,u=r(e.tankList);!(o=u()).done;){var l=o.value,c=a(l.id);if(i(l.id)<c){var f=n;return f.fishIds=f.fishIds.filter((function(e){return e!==t.id})),l.fishIds.push(t.id),t.tankId=l.id,{ok:!0}}}return{ok:!1,msg:"ÊâÄÊúâÈ≠öÁº∏ÈÉΩÊªø‰∫ÜÔºåË´ãÂÖàÈ®∞Âá∫Á©∫‰ΩçÂÜçÂæ©Ê¥ª"}},t}(d)).prototype,"confirm",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(O.prototype,"floatingNode",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(O.prototype,"tombContainer",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(O.prototype,"tombstonePrefab",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(O.prototype,"deadFishDetailPanel",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(O.prototype,"titleLabel",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(O.prototype,"nameLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(O.prototype,"genderLabel",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(O.prototype,"daysLabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(O.prototype,"stageLabel",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(O.prototype,"deathDateLabel",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(O.prototype,"reviveBtn",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(O.prototype,"reviveCountLabel",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=t(O.prototype,"resetBtn",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(O.prototype,"closeBtn",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=O))||M));u._RF.pop()}}}));

System.register("chunks:///_virtual/types.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"0b98bsmhVdK7ryL5Aeza7mf","types",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/UIUtils.ts",["cc"],(function(t){var e,n,i,o,a;return{setters:[function(t){e=t.cclegacy,n=t.Label,i=t.UIOpacity,o=t.tween,a=t.Vec3}],execute:function(){t({playOpenPanelAnim:function(t,e){void 0===e&&(e=.3);if(!t)return;t.active||(t.active=!0,t.scale=new a(.3,.3,1));o(t).to(e,{scale:new a(1,1,1)},{easing:"backOut"}).start()},showFloatingTextCenter:function(t,e){var c=null==t?void 0:t.getComponentInChildren(n),s=null==t?void 0:t.getComponent(i);if(!t||!c||!s)return void console.warn("[UIUtils] floatingNode Áº∫Â∞ë Node / Label / UIOpacity ÂÖÉ‰ª∂");o(t).stop(),o(s).stop(),c.string=e,t.active=!0,s.opacity=0;var l=new a(0,0,0),r=new a(0,30,0);t.setPosition(l),o(s).to(.3,{opacity:255}).delay(1.2).to(.4,{opacity:0}).call((function(){return t.active=!1})).start(),o(t).to(1.2,{position:r},{easing:"quadOut"}).start()}}),e._RF.push({},"ce412tpvfFOL74Vyn/N7XEX","UIUtils",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/utils.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){t({getRandomItem:function(t){return t[Math.floor(Math.random()*t.length)]},getTodayIndex:function(){return((new Date).getDay()+6)%7},getWeekStartKey:function(t,e){void 0===t&&(t=new Date);void 0===e&&(e=480);var n=new Date(t.getTime()+6e4*e),r=new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate())),a=(r.getUTCDay()+6)%7;return r.setUTCDate(r.getUTCDate()-a),r.toISOString().slice(0,10)},shuffleArray:function(t){for(var e=[].concat(t),n=e.length-1;n>0;n--){var r=Math.floor(Math.random()*(n+1)),a=[e[r],e[n]];e[n]=a[0],e[r]=a[1]}return e}}),e._RF.push({},"2d2fbgjcXBLH5Tr8Xztdvcm","utils",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/WeeklySignInManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts","./RewardPopup.ts","./QuizPanel.ts","./SignInPanel.ts","./utils.ts"],(function(e){var t,n,a,r,i,o,s,l,u,c,p,g,d,y,h,f,b,m,S,I,w,D,k,P;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,a=e.initializerDefineProperty,r=e.assertThisInitialized,i=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){s=e.cclegacy,l=e._decorator,u=e.Sprite,c=e.Label,p=e.Button,g=e.Prefab,d=e.SpriteFrame,y=e.Color,h=e.Component,f=e.instantiate,b=e.UITransform},function(e){m=e.DataManager},function(e){S=e.RewardPopup},function(e){I=e.QuizPanel},function(e){w=e.SignInPanel},function(e){D=e.getTodayIndex,k=e.getWeekStartKey,P=e.getRandomItem}],execute:function(){var v,F,x,z,B,C,M,T,W,L,R,_,H,K,q,Q,U,O,j,A,G,V,E;s._RF.push({},"4236cmKkvVCsocbSypDKfTI","WeeklySignInManager",void 0);var J=l.ccclass,N=l.property,X=function(e){return e[e.Missed=0]="Missed",e[e.Today=1]="Today",e[e.Future=2]="Future",e[e.Signed=3]="Signed",e}(X||{});e("WeeklySignInManager",(v=J("WeeklySignInManager"),F=N(w),x=N(u),z=N(c),B=N(p),C=N(c),M=N(g),T=N(g),W=N(d),L=N(d),R=N(d),v((K=t((H=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i))||this,a(t,"signInPanel",K,r(t)),a(t,"dayBgSprites",q,r(t)),a(t,"dayLabels",Q,r(t)),a(t,"claimButton",U,r(t)),a(t,"signInHintLabel",O,r(t)),a(t,"rewardPopupPrefab",j,r(t)),a(t,"quizPanelPrefab",A,r(t)),a(t,"dragonBoneSpriteFrame",G,r(t)),a(t,"premiumFeedSpriteFrame",V,r(t)),a(t,"defaultSpriteFrame",E,r(t)),t.todayIndex=0,t.playerData=void 0,t}n(t,e);var s=t.prototype;return s.start=function(){var e=i(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(t=m.ready)?void 0:t.catch((function(){}));case 2:return e.next=4,m.getPlayerDataCached();case 4:if(this.playerData=e.sent,this.playerData&&this.playerData.signInData){e.next=8;break}return console.warn("[WeeklySignIn] Â∞öÊú™ÂèñÂæóÁé©ÂÆ∂Ë≥áÊñôÔºåÂÅúÁî®Êú¨ÂÖÉ‰ª∂ÂàùÂßãÂåñ"),e.abrupt("return");case 8:this.handleWeekReset(),this.todayIndex=D(),this.updateSignInUI(),this.claimButton.node.on("click",this.onClaimButtonClick,this),n=(new Date).toISOString().split("T")[0],this.playerData.signInData.weekly.lastSignDate===n?(this.claimButton.interactable=!1,this.signInHintLabel.string="‰ªäÊó•Â∑≤Á∞ΩÂà∞"):(this.claimButton.interactable=!0,this.signInHintLabel.string="Á≠îÈ°åÁ∞ΩÂà∞");case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.handleWeekReset=function(){var e=i(o().mark((function e(){var t,n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=k(),n=this.playerData.signInData.weekly||{},a=n.weekKey,console.log("Êú¨ÈÄ±ÈÄ±Èçµ =",t),console.log("Áé©ÂÆ∂Ë≥áÊñôÈÄ±Èçµ =",a),a===t){e.next=10;break}return console.log("Êñ∞ÁöÑ‰∏ÄÈÄ±ÈñãÂßãÔºåÈáçÁΩÆÈÄ±Á∞ΩÂà∞Ë≥áÊñô"),this.playerData.signInData.weekly={weekKey:t,daysSigned:[!1,!1,!1,!1,!1,!1,!1],questionsCorrect:[!1,!1,!1,!1,!1,!1,!1],lastSignDate:""},e.next=10,m.savePlayerDataWithCache(this.playerData);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.updateSignInUI=function(){for(var e=0;e<this.dayBgSprites.length;e++){var t=this.dayBgSprites[e],n=this.dayLabels[e],a=void 0;a=this.playerData.signInData.weekly.daysSigned[e]?X.Signed:e===this.todayIndex?X.Today:e<this.todayIndex?X.Missed:X.Future,this.applyStyle(t,n,a)}},s.applyStyle=function(e,t,n){switch(n){case X.Signed:e.color=new y(180,255,180),t.string="‚úî Â∑≤Á∞Ω";break;case X.Today:e.color=new y(255,241,150),t.string="‰ªäÂ§©";break;case X.Missed:e.color=new y(255,143,143),t.string="Êú™Á∞Ω";break;case X.Future:e.color=new y(224,221,222),t.string="Êú™‰æÜ"}},s.getIconSpriteFrame=function(e){switch(e){case"dragonbone":return this.dragonBoneSpriteFrame;case"premium_feed":return this.premiumFeedSpriteFrame;default:return this.defaultSpriteFrame}},s.onClaimButtonClick=function(){var e=i(o().mark((function e(){var t,n,a,r,i,s,l,u,c,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(new Date).toISOString().split("T")[0],this.playerData.signInData.weekly.lastSignDate!==n){e.next=5;break}return console.log("‰ªäÂ§©Â∑≤Á∞ΩÂà∞"),e.abrupt("return");case 5:return e.next=7,m.getQuizQuestions();case 7:return a=e.sent,r=P(a),i=f(this.quizPanelPrefab),this.node.parent.addChild(i),s=i.getComponent(I),e.next=14,s.setup(r);case 14:return l=e.sent,this.playerData.signInData.weekly.lastSignDate=n,this.playerData.signInData.weekly.daysSigned[this.todayIndex]=!0,10,u=l?20:10,this.playerData.dragonBones+=u,6===this.todayIndex&&(this.playerData.inventory.feeds.premium+=1,console.log("‰ªäÊó•ÁÇ∫Á¨¨‰∏ÉÂ§©ÔºåÁôºÈÄÅ‰∏ÄÂåÖÈ´òÁ¥öÈ£ºÊñôÔºÅ")),c=[{icon:this.getIconSpriteFrame("dragonbone"),name:"ÈæçÈ™®",count:u}],6===this.todayIndex&&c.push({icon:this.getIconSpriteFrame("premium_feed"),name:"È´òÁ¥öÈ£ºÊñô",count:1}),(p=f(this.rewardPopupPrefab)).getComponent(S).showRewards(c),this.node.getComponent(b).node.parent.addChild(p),e.next=28,m.savePlayerDataWithCache(this.playerData);case 28:this.updateSignInUI(),this.claimButton.interactable=!1,null==(t=this.signInPanel)||t.onWeeklySignInDone();case 31:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(h)).prototype,"signInPanel",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(H.prototype,"dayBgSprites",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Q=t(H.prototype,"dayLabels",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),U=t(H.prototype,"claimButton",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(H.prototype,"signInHintLabel",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(H.prototype,"rewardPopupPrefab",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(H.prototype,"quizPanelPrefab",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(H.prototype,"dragonBoneSpriteFrame",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(H.prototype,"premiumFeedSpriteFrame",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(H.prototype,"defaultSpriteFrame",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=H))||_));s._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});